source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/botocore/docs/method.py</b><br>


file stats: <b>137 lines, 15 executed: 10.9% covered</b>
<pre>
<font color="black">   1. # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. import inspect</font>
<font color="black">  14. </font>
<font color="green">  15. from botocore.docs.params import RequestParamsDocumenter</font>
<font color="green">  16. from botocore.docs.params import ResponseParamsDocumenter</font>
<font color="green">  17. from botocore.docs.example import ResponseExampleDocumenter</font>
<font color="green">  18. from botocore.docs.example import RequestExampleDocumenter</font>
<font color="black">  19. </font>
<font color="black">  20. </font>
<font color="green">  21. AWS_DOC_BASE = 'https://docs.aws.amazon.com/goto/WebAPI'</font>
<font color="black">  22. </font>
<font color="black">  23. </font>
<font color="green">  24. def get_instance_public_methods(instance):</font>
<font color="black">  25.     &quot;&quot;&quot;Retrieves an objects public methods</font>
<font color="black">  26. </font>
<font color="black">  27.     :param instance: The instance of the class to inspect</font>
<font color="black">  28.     :rtype: dict</font>
<font color="black">  29.     :returns: A dictionary that represents an instance's methods where</font>
<font color="black">  30.         the keys are the name of the methods and the</font>
<font color="black">  31.         values are the handler to the method.</font>
<font color="black">  32.     &quot;&quot;&quot;</font>
<font color="red">  33.     instance_members = inspect.getmembers(instance)</font>
<font color="red">  34.     instance_methods = {}</font>
<font color="red">  35.     for name, member in instance_members:</font>
<font color="red">  36.         if not name.startswith('_'):</font>
<font color="red">  37.             if inspect.ismethod(member):</font>
<font color="red">  38.                 instance_methods[name] = member</font>
<font color="red">  39.     return instance_methods</font>
<font color="black">  40. </font>
<font color="black">  41. </font>
<font color="black">  42. def document_model_driven_signature(section, name, operation_model,</font>
<font color="green">  43.                                     include=None, exclude=None):</font>
<font color="black">  44.     &quot;&quot;&quot;Documents the signature of a model-driven method</font>
<font color="black">  45. </font>
<font color="black">  46.     :param section: The section to write the documentation to.</font>
<font color="black">  47. </font>
<font color="black">  48.     :param name: The name of the method</font>
<font color="black">  49. </font>
<font color="black">  50.     :param operation_model: The operation model for the method</font>
<font color="black">  51. </font>
<font color="black">  52.     :type include: Dictionary where keys are parameter names and</font>
<font color="black">  53.         values are the shapes of the parameter names.</font>
<font color="black">  54.     :param include: The parameter shapes to include in the documentation.</font>
<font color="black">  55. </font>
<font color="black">  56.     :type exclude: List of the names of the parameters to exclude.</font>
<font color="black">  57.     :param exclude: The names of the parameters to exclude from</font>
<font color="black">  58.         documentation.</font>
<font color="black">  59.     &quot;&quot;&quot;</font>
<font color="red">  60.     params = {}</font>
<font color="red">  61.     if operation_model.input_shape:</font>
<font color="red">  62.         params = operation_model.input_shape.members</font>
<font color="black">  63. </font>
<font color="red">  64.     parameter_names = list(params.keys())</font>
<font color="black">  65. </font>
<font color="red">  66.     if include is not None:</font>
<font color="red">  67.         for member in include:</font>
<font color="red">  68.             parameter_names.append(member.name)</font>
<font color="black">  69. </font>
<font color="red">  70.     if exclude is not None:</font>
<font color="red">  71.         for member in exclude:</font>
<font color="red">  72.             if member in parameter_names:</font>
<font color="red">  73.                 parameter_names.remove(member)</font>
<font color="black">  74. </font>
<font color="red">  75.     signature_params = ''</font>
<font color="red">  76.     if parameter_names:</font>
<font color="red">  77.         signature_params = '**kwargs'</font>
<font color="red">  78.     section.style.start_sphinx_py_method(name, signature_params)</font>
<font color="black">  79. </font>
<font color="black">  80. </font>
<font color="black">  81. def document_custom_signature(section, name, method,</font>
<font color="green">  82.                               include=None, exclude=None):</font>
<font color="black">  83.     &quot;&quot;&quot;Documents the signature of a custom method</font>
<font color="black">  84. </font>
<font color="black">  85.     :param section: The section to write the documentation to.</font>
<font color="black">  86. </font>
<font color="black">  87.     :param name: The name of the method</font>
<font color="black">  88. </font>
<font color="black">  89.     :param method: The handle to the method being documented</font>
<font color="black">  90. </font>
<font color="black">  91.     :type include: Dictionary where keys are parameter names and</font>
<font color="black">  92.         values are the shapes of the parameter names.</font>
<font color="black">  93.     :param include: The parameter shapes to include in the documentation.</font>
<font color="black">  94. </font>
<font color="black">  95.     :type exclude: List of the names of the parameters to exclude.</font>
<font color="black">  96.     :param exclude: The names of the parameters to exclude from</font>
<font color="black">  97.         documentation.</font>
<font color="black">  98.     &quot;&quot;&quot;</font>
<font color="red">  99.     args, varargs, keywords, defaults = inspect.getargspec(method)</font>
<font color="red"> 100.     args = args[1:]</font>
<font color="red"> 101.     signature_params = inspect.formatargspec(</font>
<font color="red"> 102.         args, varargs, keywords, defaults)</font>
<font color="red"> 103.     signature_params = signature_params.lstrip('(')</font>
<font color="red"> 104.     signature_params = signature_params.rstrip(')')</font>
<font color="red"> 105.     section.style.start_sphinx_py_method(name, signature_params)</font>
<font color="black"> 106. </font>
<font color="black"> 107. </font>
<font color="green"> 108. def document_custom_method(section, method_name, method):</font>
<font color="black"> 109.     &quot;&quot;&quot;Documents a non-data driven method</font>
<font color="black"> 110. </font>
<font color="black"> 111.     :param section: The section to write the documentation to.</font>
<font color="black"> 112. </font>
<font color="black"> 113.     :param method_name: The name of the method</font>
<font color="black"> 114. </font>
<font color="black"> 115.     :param method: The handle to the method being documented</font>
<font color="black"> 116.     &quot;&quot;&quot;</font>
<font color="red"> 117.     document_custom_signature(</font>
<font color="red"> 118.         section, method_name, method)</font>
<font color="red"> 119.     method_intro_section = section.add_new_section('method-intro')</font>
<font color="red"> 120.     method_intro_section.writeln('')</font>
<font color="red"> 121.     doc_string = inspect.getdoc(method)</font>
<font color="red"> 122.     if doc_string is not None:</font>
<font color="red"> 123.         method_intro_section.style.write_py_doc_string(doc_string)</font>
<font color="black"> 124. </font>
<font color="black"> 125. </font>
<font color="black"> 126. def document_model_driven_method(section, method_name, operation_model,</font>
<font color="green"> 127.                                  event_emitter, method_description=None,</font>
<font color="green"> 128.                                  example_prefix=None, include_input=None,</font>
<font color="green"> 129.                                  include_output=None, exclude_input=None,</font>
<font color="green"> 130.                                  exclude_output=None, document_output=True,</font>
<font color="green"> 131.                                  include_signature=True):</font>
<font color="black"> 132.     &quot;&quot;&quot;Documents an individual method</font>
<font color="black"> 133. </font>
<font color="black"> 134.     :param section: The section to write to</font>
<font color="black"> 135. </font>
<font color="black"> 136.     :param method_name: The name of the method</font>
<font color="black"> 137. </font>
<font color="black"> 138.     :param operation_model: The model of the operation</font>
<font color="black"> 139. </font>
<font color="black"> 140.     :param event_emitter: The event emitter to use to emit events</font>
<font color="black"> 141. </font>
<font color="black"> 142.     :param example_prefix: The prefix to use in the method example.</font>
<font color="black"> 143. </font>
<font color="black"> 144.     :type include_input: Dictionary where keys are parameter names and</font>
<font color="black"> 145.         values are the shapes of the parameter names.</font>
<font color="black"> 146.     :param include_input: The parameter shapes to include in the</font>
<font color="black"> 147.         input documentation.</font>
<font color="black"> 148. </font>
<font color="black"> 149.     :type include_output: Dictionary where keys are parameter names and</font>
<font color="black"> 150.         values are the shapes of the parameter names.</font>
<font color="black"> 151.     :param include_input: The parameter shapes to include in the</font>
<font color="black"> 152.         output documentation.</font>
<font color="black"> 153. </font>
<font color="black"> 154.     :type exclude_input: List of the names of the parameters to exclude.</font>
<font color="black"> 155.     :param exclude_input: The names of the parameters to exclude from</font>
<font color="black"> 156.         input documentation.</font>
<font color="black"> 157. </font>
<font color="black"> 158.     :type exclude_output: List of the names of the parameters to exclude.</font>
<font color="black"> 159.     :param exclude_input: The names of the parameters to exclude from</font>
<font color="black"> 160.         output documentation.</font>
<font color="black"> 161. </font>
<font color="black"> 162.     :param document_output: A boolean flag to indicate whether to</font>
<font color="black"> 163.         document the output.</font>
<font color="black"> 164. </font>
<font color="black"> 165.     :param include_signature: Whether or not to include the signature.</font>
<font color="black"> 166.         It is useful for generating docstrings.</font>
<font color="black"> 167.     &quot;&quot;&quot;</font>
<font color="black"> 168.     # Add the signature if specified.</font>
<font color="red"> 169.     if include_signature:</font>
<font color="red"> 170.         document_model_driven_signature(</font>
<font color="red"> 171.             section, method_name, operation_model, include=include_input,</font>
<font color="red"> 172.             exclude=exclude_input)</font>
<font color="black"> 173. </font>
<font color="black"> 174.     # Add the description for the method.</font>
<font color="red"> 175.     method_intro_section = section.add_new_section('method-intro')</font>
<font color="red"> 176.     method_intro_section.include_doc_string(method_description)</font>
<font color="red"> 177.     if operation_model.deprecated:</font>
<font color="red"> 178.         method_intro_section.style.start_danger()</font>
<font color="red"> 179.         method_intro_section.writeln(</font>
<font color="red"> 180.                 'This operation is deprecated and may not function as '</font>
<font color="black"> 181.                 'expected. This operation should not be used going forward '</font>
<font color="black"> 182.                 'and is only kept for the purpose of backwards compatiblity.')</font>
<font color="red"> 183.         method_intro_section.style.end_danger()</font>
<font color="red"> 184.     service_uid = operation_model.service_model.metadata.get('uid')</font>
<font color="red"> 185.     if service_uid is not None:</font>
<font color="red"> 186.         method_intro_section.style.new_paragraph()</font>
<font color="red"> 187.         method_intro_section.write(&quot;See also: &quot;)</font>
<font color="red"> 188.         link = '%s/%s/%s' % (AWS_DOC_BASE, service_uid,</font>
<font color="red"> 189.                              operation_model.name)</font>
<font color="red"> 190.         method_intro_section.style.external_link(title=&quot;AWS API Documentation&quot;,</font>
<font color="red"> 191.                                                  link=link)</font>
<font color="red"> 192.         method_intro_section.writeln('')</font>
<font color="black"> 193. </font>
<font color="black"> 194.     # Add the example section.</font>
<font color="red"> 195.     example_section = section.add_new_section('example')</font>
<font color="red"> 196.     example_section.style.new_paragraph()</font>
<font color="red"> 197.     example_section.style.bold('Request Syntax')</font>
<font color="black"> 198. </font>
<font color="red"> 199.     context = {</font>
<font color="red"> 200.         'special_shape_types': {</font>
<font color="red"> 201.             'streaming_input_shape': operation_model.get_streaming_input(),</font>
<font color="red"> 202.             'streaming_output_shape': operation_model.get_streaming_output(),</font>
<font color="red"> 203.             'eventstream_output_shape': operation_model.get_event_stream_output(),</font>
<font color="black"> 204.         },</font>
<font color="black"> 205.     }</font>
<font color="black"> 206. </font>
<font color="red"> 207.     if operation_model.input_shape:</font>
<font color="red"> 208.         RequestExampleDocumenter(</font>
<font color="red"> 209.             service_name=operation_model.service_model.service_name,</font>
<font color="red"> 210.             operation_name=operation_model.name,</font>
<font color="red"> 211.             event_emitter=event_emitter, context=context).document_example(</font>
<font color="red"> 212.                 example_section, operation_model.input_shape,</font>
<font color="red"> 213.                 prefix=example_prefix, include=include_input,</font>
<font color="red"> 214.                 exclude=exclude_input)</font>
<font color="black"> 215.     else:</font>
<font color="red"> 216.         example_section.style.new_paragraph()</font>
<font color="red"> 217.         example_section.style.start_codeblock()</font>
<font color="red"> 218.         example_section.write(example_prefix + '()')</font>
<font color="black"> 219. </font>
<font color="black"> 220.     # Add the request parameter documentation.</font>
<font color="red"> 221.     request_params_section = section.add_new_section('request-params')</font>
<font color="red"> 222.     if operation_model.input_shape:</font>
<font color="red"> 223.         RequestParamsDocumenter(</font>
<font color="red"> 224.             service_name=operation_model.service_model.service_name,</font>
<font color="red"> 225.             operation_name=operation_model.name,</font>
<font color="red"> 226.             event_emitter=event_emitter, context=context).document_params(</font>
<font color="red"> 227.                 request_params_section, operation_model.input_shape,</font>
<font color="red"> 228.                 include=include_input, exclude=exclude_input)</font>
<font color="black"> 229. </font>
<font color="black"> 230.     # Add the return value documentation</font>
<font color="red"> 231.     return_section = section.add_new_section('return')</font>
<font color="red"> 232.     return_section.style.new_line()</font>
<font color="red"> 233.     if operation_model.output_shape is not None and document_output:</font>
<font color="red"> 234.         return_section.write(':rtype: dict')</font>
<font color="red"> 235.         return_section.style.new_line()</font>
<font color="red"> 236.         return_section.write(':returns: ')</font>
<font color="red"> 237.         return_section.style.indent()</font>
<font color="red"> 238.         return_section.style.new_line()</font>
<font color="black"> 239. </font>
<font color="black"> 240.         # If the operation is an event stream, describe the tagged union</font>
<font color="red"> 241.         event_stream_output = operation_model.get_event_stream_output()</font>
<font color="red"> 242.         if event_stream_output:</font>
<font color="red"> 243.             event_section = return_section.add_new_section('event-stream')</font>
<font color="red"> 244.             event_section.style.new_paragraph()</font>
<font color="red"> 245.             event_section.write(</font>
<font color="red"> 246.                 'The response of this operation contains an '</font>
<font color="black"> 247.                 ':class:`.EventStream` member. When iterated the '</font>
<font color="black"> 248.                 ':class:`.EventStream` will yield events based on the '</font>
<font color="black"> 249.                 'structure below, where only one of the top level keys '</font>
<font color="black"> 250.                 'will be present for any given event.'</font>
<font color="black"> 251.             )</font>
<font color="red"> 252.             event_section.style.new_line()</font>
<font color="black"> 253. </font>
<font color="black"> 254.         # Add an example return value</font>
<font color="red"> 255.         return_example_section = return_section.add_new_section('example')</font>
<font color="red"> 256.         return_example_section.style.new_line()</font>
<font color="red"> 257.         return_example_section.style.bold('Response Syntax')</font>
<font color="red"> 258.         return_example_section.style.new_paragraph()</font>
<font color="red"> 259.         ResponseExampleDocumenter(</font>
<font color="red"> 260.             service_name=operation_model.service_model.service_name,</font>
<font color="red"> 261.             operation_name=operation_model.name,</font>
<font color="red"> 262.             event_emitter=event_emitter,</font>
<font color="red"> 263.             context=context).document_example(</font>
<font color="red"> 264.                 return_example_section, operation_model.output_shape,</font>
<font color="red"> 265.                 include=include_output, exclude=exclude_output)</font>
<font color="black"> 266. </font>
<font color="black"> 267.         # Add a description for the return value</font>
<font color="red"> 268.         return_description_section = return_section.add_new_section(</font>
<font color="red"> 269.             'description')</font>
<font color="red"> 270.         return_description_section.style.new_line()</font>
<font color="red"> 271.         return_description_section.style.bold('Response Structure')</font>
<font color="red"> 272.         return_description_section.style.new_paragraph()</font>
<font color="red"> 273.         ResponseParamsDocumenter(</font>
<font color="red"> 274.             service_name=operation_model.service_model.service_name,</font>
<font color="red"> 275.             operation_name=operation_model.name,</font>
<font color="red"> 276.             event_emitter=event_emitter,</font>
<font color="red"> 277.             context=context).document_params(</font>
<font color="red"> 278.                 return_description_section, operation_model.output_shape,</font>
<font color="red"> 279.                 include=include_output, exclude=exclude_output)</font>
<font color="black"> 280.     else:</font>
<font color="red"> 281.         return_section.write(':returns: None')</font>
<font color="black"> 282. </font>
</pre>

