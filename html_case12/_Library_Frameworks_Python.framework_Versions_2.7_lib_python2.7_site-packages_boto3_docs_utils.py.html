source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/boto3/docs/utils.py</b><br>


file stats: <b>86 lines, 14 executed: 16.3% covered</b>
<pre>
<font color="black">   1. # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. import inspect</font>
<font color="black">  14. </font>
<font color="green">  15. import jmespath</font>
<font color="black">  16. </font>
<font color="green">  17. from botocore.compat import six</font>
<font color="black">  18. </font>
<font color="black">  19. </font>
<font color="green">  20. def get_resource_ignore_params(params):</font>
<font color="black">  21.     &quot;&quot;&quot;Helper method to determine which parameters to ignore for actions</font>
<font color="black">  22. </font>
<font color="black">  23.     :returns: A list of the parameter names that does not need to be</font>
<font color="black">  24.         included in a resource's method call for documentation purposes.</font>
<font color="black">  25.     &quot;&quot;&quot;</font>
<font color="red">  26.     ignore_params = []</font>
<font color="red">  27.     for param in params:</font>
<font color="red">  28.         result = jmespath.compile(param.target)</font>
<font color="red">  29.         current = result.parsed</font>
<font color="black">  30.         # Use JMESPath to find the left most element in the target expression</font>
<font color="black">  31.         # which will be the parameter to ignore in the action call.</font>
<font color="red">  32.         while current['children']:</font>
<font color="red">  33.             current = current['children'][0]</font>
<font color="black">  34.         # Make sure the parameter we are about to ignore is a field.</font>
<font color="black">  35.         # If it is not, we should ignore the result to avoid false positives.</font>
<font color="red">  36.         if current['type'] == 'field':</font>
<font color="red">  37.             ignore_params.append(current['value'])</font>
<font color="red">  38.     return ignore_params</font>
<font color="black">  39. </font>
<font color="black">  40. </font>
<font color="green">  41. def is_resource_action(action_handle):</font>
<font color="red">  42.     if six.PY3:</font>
<font color="red">  43.         return inspect.isfunction(action_handle)</font>
<font color="black">  44.     else:</font>
<font color="red">  45.         return inspect.ismethod(action_handle)</font>
<font color="black">  46. </font>
<font color="black">  47. </font>
<font color="green">  48. def get_resource_public_actions(resource_class):</font>
<font color="red">  49.     resource_class_members = inspect.getmembers(resource_class)</font>
<font color="red">  50.     resource_methods = {}</font>
<font color="red">  51.     for name, member in resource_class_members:</font>
<font color="red">  52.         if not name.startswith('_'):</font>
<font color="red">  53.             if not name[0].isupper():</font>
<font color="red">  54.                 if not name.startswith('wait_until'):</font>
<font color="red">  55.                     if is_resource_action(member):</font>
<font color="red">  56.                         resource_methods[name] = member</font>
<font color="red">  57.     return resource_methods</font>
<font color="black">  58. </font>
<font color="black">  59. </font>
<font color="green">  60. def get_identifier_values_for_example(identifier_names):</font>
<font color="red">  61.     example_values = ['\'%s\'' % identifier for identifier in identifier_names]</font>
<font color="red">  62.     return ','.join(example_values)</font>
<font color="black">  63. </font>
<font color="black">  64. </font>
<font color="green">  65. def get_identifier_args_for_signature(identifier_names):</font>
<font color="red">  66.     return ','.join(identifier_names)</font>
<font color="black">  67. </font>
<font color="black">  68. </font>
<font color="green">  69. def get_identifier_description(resource_name, identifier_name):</font>
<font color="red">  70.     return &quot;The %s's %s identifier. This **must** be set.&quot; % (</font>
<font color="red">  71.         resource_name, identifier_name)</font>
<font color="black">  72. </font>
<font color="black">  73. </font>
<font color="black">  74. def add_resource_type_overview(section, resource_type, description,</font>
<font color="green">  75.                                intro_link=None):</font>
<font color="red">  76.     section.style.new_line()</font>
<font color="red">  77.     section.write('.. rst-class:: admonition-title')</font>
<font color="red">  78.     section.style.new_line()</font>
<font color="red">  79.     section.style.new_line()</font>
<font color="red">  80.     section.write(resource_type)</font>
<font color="red">  81.     section.style.new_line()</font>
<font color="red">  82.     section.style.new_line()</font>
<font color="red">  83.     section.write(description)</font>
<font color="red">  84.     section.style.new_line()</font>
<font color="red">  85.     if intro_link is not None:</font>
<font color="red">  86.         section.write('For more information about %s refer to the '</font>
<font color="black">  87.                       ':ref:`Resources Introduction Guide&lt;%s&gt;`.' % (</font>
<font color="red">  88.                           resource_type.lower(), intro_link))</font>
<font color="red">  89.         section.style.new_line()</font>
<font color="black">  90. </font>
<font color="black">  91. </font>
<font color="green">  92. class DocumentModifiedShape(object):</font>
<font color="green">  93.     def __init__(self, shape_name, new_type, new_description,</font>
<font color="black">  94.                  new_example_value):</font>
<font color="red">  95.         self._shape_name = shape_name</font>
<font color="red">  96.         self._new_type = new_type</font>
<font color="red">  97.         self._new_description = new_description</font>
<font color="red">  98.         self._new_example_value = new_example_value</font>
<font color="black">  99. </font>
<font color="green"> 100.     def replace_documentation_for_matching_shape(self, event_name, section,</font>
<font color="black"> 101.                                                  **kwargs):</font>
<font color="red"> 102.         if self._shape_name == section.context.get('shape'):</font>
<font color="red"> 103.             self._replace_documentation(event_name, section)</font>
<font color="red"> 104.         for section_name in section.available_sections:</font>
<font color="red"> 105.             sub_section = section.get_section(section_name)</font>
<font color="red"> 106.             if self._shape_name == sub_section.context.get('shape'):</font>
<font color="red"> 107.                 self._replace_documentation(event_name, sub_section)</font>
<font color="black"> 108.             else:</font>
<font color="red"> 109.                 self.replace_documentation_for_matching_shape(</font>
<font color="red"> 110.                     event_name, sub_section)</font>
<font color="black"> 111. </font>
<font color="green"> 112.     def _replace_documentation(self, event_name, section):</font>
<font color="red"> 113.         if event_name.startswith('docs.request-example') or \</font>
<font color="red"> 114.                 event_name.startswith('docs.response-example'):</font>
<font color="red"> 115.             section.remove_all_sections()</font>
<font color="red"> 116.             section.clear_text()</font>
<font color="red"> 117.             section.write(self._new_example_value)</font>
<font color="black"> 118. </font>
<font color="red"> 119.         if event_name.startswith('docs.request-params') or \</font>
<font color="red"> 120.                 event_name.startswith('docs.response-params'):</font>
<font color="red"> 121.             for section_name in section.available_sections:</font>
<font color="black"> 122.                 # Delete any extra members as a new shape is being</font>
<font color="black"> 123.                 # used.</font>
<font color="red"> 124.                 if section_name not in ['param-name', 'param-documentation',</font>
<font color="black"> 125.                                         'end-structure', 'param-type',</font>
<font color="red"> 126.                                         'end-param']:</font>
<font color="red"> 127.                     section.delete_section(section_name)</font>
<font color="black"> 128. </font>
<font color="black"> 129.             # Update the documentation</font>
<font color="red"> 130.             description_section = section.get_section('param-documentation')</font>
<font color="red"> 131.             description_section.clear_text()</font>
<font color="red"> 132.             description_section.write(self._new_description)</font>
<font color="black"> 133. </font>
<font color="black"> 134.             # Update the param type</font>
<font color="red"> 135.             type_section = section.get_section('param-type')</font>
<font color="red"> 136.             if type_section.getvalue().decode('utf-8').startswith(':type'):</font>
<font color="red"> 137.                 type_section.clear_text()</font>
<font color="red"> 138.                 type_section.write(':type %s: %s' % (</font>
<font color="red"> 139.                     section.name, self._new_type))</font>
<font color="black"> 140.             else:</font>
<font color="red"> 141.                 type_section.clear_text()</font>
<font color="red"> 142.                 type_section.style.italics('(%s) -- ' % self._new_type)</font>
</pre>

