source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/botocore/docs/example.py</b><br>


file stats: <b>146 lines, 23 executed: 15.8% covered</b>
<pre>
<font color="black">   1. # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. from botocore.docs.shape import ShapeDocumenter</font>
<font color="green">  14. from botocore.docs.utils import py_default</font>
<font color="black">  15. </font>
<font color="black">  16. </font>
<font color="green">  17. class BaseExampleDocumenter(ShapeDocumenter):</font>
<font color="green">  18.     def document_example(self, section, shape, prefix=None, include=None,</font>
<font color="green">  19.                          exclude=None):</font>
<font color="black">  20.         &quot;&quot;&quot;Generates an example based on a shape</font>
<font color="black">  21. </font>
<font color="black">  22.         :param section: The section to write the documentation to.</font>
<font color="black">  23. </font>
<font color="black">  24.         :param shape: The shape of the operation.</font>
<font color="black">  25. </font>
<font color="black">  26.         :param prefix: Anything to be included before the example</font>
<font color="black">  27. </font>
<font color="black">  28.         :type include: Dictionary where keys are parameter names and</font>
<font color="black">  29.             values are the shapes of the parameter names.</font>
<font color="black">  30.         :param include: The parameter shapes to include in the documentation.</font>
<font color="black">  31. </font>
<font color="black">  32.         :type exclude: List of the names of the parameters to exclude.</font>
<font color="black">  33.         :param exclude: The names of the parameters to exclude from</font>
<font color="black">  34.             documentation.</font>
<font color="black">  35.         &quot;&quot;&quot;</font>
<font color="red">  36.         history = []</font>
<font color="red">  37.         section.style.new_line()</font>
<font color="red">  38.         section.style.start_codeblock()</font>
<font color="red">  39.         if prefix is not None:</font>
<font color="red">  40.             section.write(prefix)</font>
<font color="red">  41.         self.traverse_and_document_shape(</font>
<font color="red">  42.             section=section, shape=shape, history=history,</font>
<font color="red">  43.             include=include, exclude=exclude)</font>
<font color="black">  44. </font>
<font color="green">  45.     def document_recursive_shape(self, section, shape, **kwargs):</font>
<font color="red">  46.         section.write('{\'... recursive ...\'}')</font>
<font color="black">  47. </font>
<font color="green">  48.     def document_shape_default(self, section, shape, history, include=None,</font>
<font color="green">  49.                                exclude=None, **kwargs):</font>
<font color="red">  50.         py_type = self._get_special_py_default(shape)</font>
<font color="red">  51.         if py_type is None:</font>
<font color="red">  52.             py_type = py_default(shape.type_name)</font>
<font color="black">  53. </font>
<font color="red">  54.         if self._context.get('streaming_shape') == shape:</font>
<font color="red">  55.             py_type = 'StreamingBody()'</font>
<font color="red">  56.         section.write(py_type)</font>
<font color="black">  57. </font>
<font color="black">  58.     def document_shape_type_string(self, section, shape, history,</font>
<font color="green">  59.                                    include=None, exclude=None, **kwargs):</font>
<font color="red">  60.         if 'enum' in shape.metadata:</font>
<font color="red">  61.             for i, enum in enumerate(shape.metadata['enum']):</font>
<font color="red">  62.                 section.write('\'%s\'' % enum)</font>
<font color="red">  63.                 if i &lt; len(shape.metadata['enum']) - 1:</font>
<font color="red">  64.                     section.write('|')</font>
<font color="black">  65.         else:</font>
<font color="red">  66.             self.document_shape_default(section, shape, history)</font>
<font color="black">  67. </font>
<font color="green">  68.     def document_shape_type_list(self, section, shape, history, include=None,</font>
<font color="green">  69.                                  exclude=None, **kwargs):</font>
<font color="red">  70.         param_shape = shape.member</font>
<font color="red">  71.         list_section = section.add_new_section('list-value')</font>
<font color="red">  72.         self._start_nested_param(list_section, '[')</font>
<font color="red">  73.         param_section = list_section.add_new_section(</font>
<font color="red">  74.             'member', context={'shape': param_shape.name})</font>
<font color="red">  75.         self.traverse_and_document_shape(</font>
<font color="red">  76.             section=param_section, shape=param_shape, history=history)</font>
<font color="red">  77.         ending_comma_section = list_section.add_new_section('ending-comma')</font>
<font color="red">  78.         ending_comma_section.write(',')</font>
<font color="red">  79.         ending_bracket_section = list_section.add_new_section(</font>
<font color="red">  80.             'ending-bracket')</font>
<font color="red">  81.         self._end_nested_param(ending_bracket_section, ']')</font>
<font color="black">  82. </font>
<font color="black">  83.     def document_shape_type_structure(self, section, shape, history,</font>
<font color="green">  84.                                       include=None, exclude=None, **kwargs):</font>
<font color="red">  85.         if not shape.members:</font>
<font color="red">  86.             section.write('{}')</font>
<font color="red">  87.             return</font>
<font color="black">  88. </font>
<font color="red">  89.         section = section.add_new_section('structure-value')</font>
<font color="red">  90.         self._start_nested_param(section, '{')</font>
<font color="black">  91. </font>
<font color="red">  92.         input_members = self._add_members_to_shape(shape.members, include)</font>
<font color="black">  93. </font>
<font color="red">  94.         for i, param in enumerate(input_members):</font>
<font color="red">  95.             if exclude and param in exclude:</font>
<font color="red">  96.                 continue</font>
<font color="red">  97.             param_section = section.add_new_section(param)</font>
<font color="red">  98.             param_section.write('\'%s\': ' % param)</font>
<font color="red">  99.             param_shape = input_members[param]</font>
<font color="red"> 100.             param_value_section = param_section.add_new_section(</font>
<font color="red"> 101.                 'member-value', context={'shape': param_shape.name})</font>
<font color="red"> 102.             self.traverse_and_document_shape(</font>
<font color="red"> 103.                 section=param_value_section, shape=param_shape,</font>
<font color="red"> 104.                 history=history, name=param)</font>
<font color="red"> 105.             if i &lt; len(input_members) - 1:</font>
<font color="red"> 106.                 ending_comma_section = param_section.add_new_section(</font>
<font color="red"> 107.                     'ending-comma')</font>
<font color="red"> 108.                 ending_comma_section.write(',')</font>
<font color="red"> 109.                 ending_comma_section.style.new_line()</font>
<font color="red"> 110.         self._end_structure(section, '{', '}')</font>
<font color="black"> 111. </font>
<font color="black"> 112.     def document_shape_type_map(self, section, shape, history,</font>
<font color="green"> 113.                                 include=None, exclude=None, **kwargs):</font>
<font color="red"> 114.         map_section = section.add_new_section('map-value')</font>
<font color="red"> 115.         self._start_nested_param(map_section, '{')</font>
<font color="red"> 116.         value_shape = shape.value</font>
<font color="red"> 117.         key_section = map_section.add_new_section(</font>
<font color="red"> 118.             'key', context={'shape': shape.key.name})</font>
<font color="red"> 119.         key_section.write('\'string\': ')</font>
<font color="red"> 120.         value_section = map_section.add_new_section(</font>
<font color="red"> 121.             'value', context={'shape': value_shape.name})</font>
<font color="red"> 122.         self.traverse_and_document_shape(</font>
<font color="red"> 123.             section=value_section, shape=value_shape, history=history)</font>
<font color="red"> 124.         end_bracket_section = map_section.add_new_section('ending-bracket')</font>
<font color="red"> 125.         self._end_nested_param(end_bracket_section, '}')</font>
<font color="black"> 126. </font>
<font color="green"> 127.     def _add_members_to_shape(self, members, include):</font>
<font color="red"> 128.         if include:</font>
<font color="red"> 129.             members = members.copy()</font>
<font color="red"> 130.             for param in include:</font>
<font color="red"> 131.                 members[param.name] = param</font>
<font color="red"> 132.         return members</font>
<font color="black"> 133. </font>
<font color="green"> 134.     def _start_nested_param(self, section, start=None):</font>
<font color="red"> 135.         if start is not None:</font>
<font color="red"> 136.             section.write(start)</font>
<font color="red"> 137.         section.style.indent()</font>
<font color="red"> 138.         section.style.indent()</font>
<font color="red"> 139.         section.style.new_line()</font>
<font color="black"> 140. </font>
<font color="green"> 141.     def _end_nested_param(self, section, end=None):</font>
<font color="red"> 142.         section.style.dedent()</font>
<font color="red"> 143.         section.style.dedent()</font>
<font color="red"> 144.         section.style.new_line()</font>
<font color="red"> 145.         if end is not None:</font>
<font color="red"> 146.             section.write(end)</font>
<font color="black"> 147. </font>
<font color="green"> 148.     def _end_structure(self, section, start, end):</font>
<font color="black"> 149.         # If there are no members in the strucuture, then make sure the</font>
<font color="black"> 150.         # start and the end bracket are on the same line, by removing all</font>
<font color="black"> 151.         # previous text and writing the start and end.</font>
<font color="red"> 152.         if not section.available_sections:</font>
<font color="red"> 153.             section.clear_text()</font>
<font color="red"> 154.             section.write(start + end)</font>
<font color="red"> 155.             self._end_nested_param(section)</font>
<font color="black"> 156.         else:</font>
<font color="red"> 157.             end_bracket_section = section.add_new_section('ending-bracket')</font>
<font color="red"> 158.             self._end_nested_param(end_bracket_section, end)</font>
<font color="black"> 159. </font>
<font color="black"> 160. </font>
<font color="green"> 161. class ResponseExampleDocumenter(BaseExampleDocumenter):</font>
<font color="green"> 162.     EVENT_NAME = 'response-example'</font>
<font color="black"> 163. </font>
<font color="green"> 164.     def document_shape_type_event_stream(self, section, shape, history,</font>
<font color="black"> 165.                                          **kwargs):</font>
<font color="red"> 166.         section.write('EventStream(')</font>
<font color="red"> 167.         self.document_shape_type_structure(section, shape, history, **kwargs)</font>
<font color="red"> 168.         end_section = section.add_new_section('event-stream-end')</font>
<font color="red"> 169.         end_section.write(')')</font>
<font color="black"> 170. </font>
<font color="black"> 171. </font>
<font color="green"> 172. class RequestExampleDocumenter(BaseExampleDocumenter):</font>
<font color="green"> 173.     EVENT_NAME = 'request-example'</font>
<font color="black"> 174. </font>
<font color="black"> 175.     def document_shape_type_structure(self, section, shape, history,</font>
<font color="green"> 176.                                       include=None, exclude=None, **kwargs):</font>
<font color="red"> 177.         param_format = '\'%s\''</font>
<font color="red"> 178.         operator = ': '</font>
<font color="red"> 179.         start = '{'</font>
<font color="red"> 180.         end = '}'</font>
<font color="black"> 181. </font>
<font color="red"> 182.         if len(history) &lt;= 1:</font>
<font color="red"> 183.             operator = '='</font>
<font color="red"> 184.             start = '('</font>
<font color="red"> 185.             end = ')'</font>
<font color="red"> 186.             param_format = '%s'</font>
<font color="red"> 187.         section = section.add_new_section('structure-value')</font>
<font color="red"> 188.         self._start_nested_param(section, start)</font>
<font color="red"> 189.         input_members = self._add_members_to_shape(shape.members, include)</font>
<font color="black"> 190. </font>
<font color="red"> 191.         for i, param in enumerate(input_members):</font>
<font color="red"> 192.             if exclude and param in exclude:</font>
<font color="red"> 193.                 continue</font>
<font color="red"> 194.             param_section = section.add_new_section(param)</font>
<font color="red"> 195.             param_section.write(param_format % param)</font>
<font color="red"> 196.             param_section.write(operator)</font>
<font color="red"> 197.             param_shape = input_members[param]</font>
<font color="red"> 198.             param_value_section = param_section.add_new_section(</font>
<font color="red"> 199.                 'member-value', context={'shape': param_shape.name})</font>
<font color="red"> 200.             self.traverse_and_document_shape(</font>
<font color="red"> 201.                 section=param_value_section, shape=param_shape,</font>
<font color="red"> 202.                 history=history, name=param)</font>
<font color="red"> 203.             if i &lt; len(input_members) - 1:</font>
<font color="red"> 204.                 ending_comma_section = param_section.add_new_section(</font>
<font color="red"> 205.                     'ending-comma')</font>
<font color="red"> 206.                 ending_comma_section.write(',')</font>
<font color="red"> 207.                 ending_comma_section.style.new_line()</font>
<font color="red"> 208.         self._end_structure(section, start, end)</font>
</pre>

