source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pyasn1/codec/der/decoder.py</b><br>


file stats: <b>17 lines, 17 executed: 100.0% covered</b>
<pre>
<font color="black">   1. #</font>
<font color="black">   2. # This file is part of pyasn1 software.</font>
<font color="black">   3. #</font>
<font color="black">   4. # Copyright (c) 2005-2017, Ilya Etingof &lt;etingof@gmail.com&gt;</font>
<font color="black">   5. # License: http://pyasn1.sf.net/license.html</font>
<font color="black">   6. #</font>
<font color="green">   7. from pyasn1.type import univ</font>
<font color="green">   8. from pyasn1.codec.cer import decoder</font>
<font color="black">   9. </font>
<font color="green">  10. __all__ = ['decode']</font>
<font color="black">  11. </font>
<font color="black">  12. </font>
<font color="green">  13. class BitStringDecoder(decoder.BitStringDecoder):</font>
<font color="green">  14.     supportConstructedForm = False</font>
<font color="black">  15. </font>
<font color="black">  16. </font>
<font color="green">  17. class OctetStringDecoder(decoder.OctetStringDecoder):</font>
<font color="green">  18.     supportConstructedForm = False</font>
<font color="black">  19. </font>
<font color="black">  20. # TODO: prohibit non-canonical encoding</font>
<font color="green">  21. RealDecoder = decoder.RealDecoder</font>
<font color="black">  22. </font>
<font color="green">  23. tagMap = decoder.tagMap.copy()</font>
<font color="green">  24. tagMap.update(</font>
<font color="green">  25.     {univ.BitString.tagSet: BitStringDecoder(),</font>
<font color="green">  26.      univ.OctetString.tagSet: OctetStringDecoder(),</font>
<font color="green">  27.      univ.Real.tagSet: RealDecoder()}</font>
<font color="black">  28. )</font>
<font color="black">  29. </font>
<font color="green">  30. typeMap = decoder.typeMap</font>
<font color="black">  31. </font>
<font color="black">  32. </font>
<font color="green">  33. class Decoder(decoder.Decoder):</font>
<font color="green">  34.     supportIndefLength = False</font>
<font color="black">  35. </font>
<font color="black">  36. </font>
<font color="black">  37. #: Turns DER octet stream into an ASN.1 object.</font>
<font color="black">  38. #:</font>
<font color="black">  39. #: Takes DER octetstream and decode it into an ASN.1 object</font>
<font color="black">  40. #: (e.g. :py:class:`~pyasn1.type.base.PyAsn1Item` derivative) which</font>
<font color="black">  41. #: may be a scalar or an arbitrary nested structure.</font>
<font color="black">  42. #:</font>
<font color="black">  43. #: Parameters</font>
<font color="black">  44. #: ----------</font>
<font color="black">  45. #: substrate: :py:class:`bytes` (Python 3) or :py:class:`str` (Python 2)</font>
<font color="black">  46. #:     DER octetstream</font>
<font color="black">  47. #:</font>
<font color="black">  48. #: asn1Spec: any pyasn1 type object e.g. :py:class:`~pyasn1.type.base.PyAsn1Item` derivative</font>
<font color="black">  49. #:     A pyasn1 type object to act as a template guiding the decoder. Depending on the ASN.1 structure</font>
<font color="black">  50. #:     being decoded, *asn1Spec* may or may not be required. Most common reason for</font>
<font color="black">  51. #:     it to require is that ASN.1 structure is encoded in *IMPLICIT* tagging mode.</font>
<font color="black">  52. #:</font>
<font color="black">  53. #: Returns</font>
<font color="black">  54. #: -------</font>
<font color="black">  55. #: : :py:class:`tuple`</font>
<font color="black">  56. #:     A tuple of pyasn1 object recovered from DER substrate (:py:class:`~pyasn1.type.base.PyAsn1Item` derivative)</font>
<font color="black">  57. #:     and the unprocessed trailing portion of the *substrate* (may be empty)</font>
<font color="black">  58. #:</font>
<font color="black">  59. #: Raises</font>
<font color="black">  60. #: ------</font>
<font color="black">  61. #: : :py:class:`pyasn1.error.PyAsn1Error`</font>
<font color="black">  62. #:     On decoding errors</font>
<font color="green">  63. decode = Decoder(tagMap, typeMap)</font>
</pre>

