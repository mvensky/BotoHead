source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/botocore/docs/bcdoc/style.py</b><br>


file stats: <b>286 lines, 80 executed: 28.0% covered</b>
<pre>
<font color="black">   1. # Copyright 2012-2013 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. #     http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="black">  13. </font>
<font color="green">  14. import logging</font>
<font color="black">  15. </font>
<font color="green">  16. logger = logging.getLogger('bcdocs')</font>
<font color="black">  17. </font>
<font color="black">  18. </font>
<font color="green">  19. class BaseStyle(object):</font>
<font color="black">  20. </font>
<font color="green">  21.     def __init__(self, doc, indent_width=2):</font>
<font color="red">  22.         self.doc = doc</font>
<font color="red">  23.         self.indent_width = indent_width</font>
<font color="red">  24.         self._indent = 0</font>
<font color="red">  25.         self.keep_data = True</font>
<font color="black">  26. </font>
<font color="green">  27.     @property</font>
<font color="black">  28.     def indentation(self):</font>
<font color="red">  29.         return self._indent</font>
<font color="black">  30. </font>
<font color="green">  31.     @indentation.setter</font>
<font color="black">  32.     def indentation(self, value):</font>
<font color="red">  33.         self._indent = value</font>
<font color="black">  34. </font>
<font color="green">  35.     def new_paragraph(self):</font>
<font color="red">  36.         return '\n%s' % self.spaces()</font>
<font color="black">  37. </font>
<font color="green">  38.     def indent(self):</font>
<font color="red">  39.         self._indent += 1</font>
<font color="black">  40. </font>
<font color="green">  41.     def dedent(self):</font>
<font color="red">  42.         if self._indent &gt; 0:</font>
<font color="red">  43.             self._indent -= 1</font>
<font color="black">  44. </font>
<font color="green">  45.     def spaces(self):</font>
<font color="red">  46.         return ' ' * (self._indent * self.indent_width)</font>
<font color="black">  47. </font>
<font color="green">  48.     def bold(self, s):</font>
<font color="red">  49.         return s</font>
<font color="black">  50. </font>
<font color="green">  51.     def ref(self, link, title=None):</font>
<font color="red">  52.         return link</font>
<font color="black">  53. </font>
<font color="green">  54.     def h2(self, s):</font>
<font color="red">  55.         return s</font>
<font color="black">  56. </font>
<font color="green">  57.     def h3(self, s):</font>
<font color="red">  58.         return s</font>
<font color="black">  59. </font>
<font color="green">  60.     def underline(self, s):</font>
<font color="red">  61.         return s</font>
<font color="black">  62. </font>
<font color="green">  63.     def italics(self, s):</font>
<font color="red">  64.         return s</font>
<font color="black">  65. </font>
<font color="black">  66. </font>
<font color="green">  67. class ReSTStyle(BaseStyle):</font>
<font color="black">  68. </font>
<font color="green">  69.     def __init__(self, doc, indent_width=2):</font>
<font color="red">  70.         BaseStyle.__init__(self, doc, indent_width)</font>
<font color="red">  71.         self.do_p = True</font>
<font color="red">  72.         self.a_href = None</font>
<font color="red">  73.         self.list_depth = 0</font>
<font color="black">  74. </font>
<font color="green">  75.     def new_paragraph(self):</font>
<font color="red">  76.         self.doc.write('\n\n%s' % self.spaces())</font>
<font color="black">  77. </font>
<font color="green">  78.     def new_line(self):</font>
<font color="red">  79.         self.doc.write('\n%s' % self.spaces())</font>
<font color="black">  80. </font>
<font color="green">  81.     def _start_inline(self, markup):</font>
<font color="red">  82.         self.doc.write(markup)</font>
<font color="black">  83. </font>
<font color="green">  84.     def _end_inline(self, markup):</font>
<font color="black">  85.         # Sometimes the HTML markup has whitespace between the end</font>
<font color="black">  86.         # of the text inside the inline markup and the closing element</font>
<font color="black">  87.         # (e.g. &lt;b&gt;foobar &lt;/b&gt;).  This trailing space will cause</font>
<font color="black">  88.         # problems in the ReST inline markup so we remove it here</font>
<font color="black">  89.         # by popping the last item written off the stack, striping</font>
<font color="black">  90.         # the whitespace and then pushing it back on the stack.</font>
<font color="red">  91.         last_write = self.doc.pop_write().rstrip(' ')</font>
<font color="black">  92. </font>
<font color="black">  93.         # Sometimes, for whatever reason, a tag like &lt;b/&gt; is present. This</font>
<font color="black">  94.         # is problematic because if we simply translate that directly then</font>
<font color="black">  95.         # we end up with something like ****, which rst will assume is a</font>
<font color="black">  96.         # heading instead of an empty bold.</font>
<font color="red">  97.         if last_write == markup:</font>
<font color="red">  98.             return</font>
<font color="black">  99. </font>
<font color="red"> 100.         self.doc.push_write(last_write)</font>
<font color="red"> 101.         self.doc.write(markup + ' ')</font>
<font color="black"> 102. </font>
<font color="green"> 103.     def start_bold(self, attrs=None):</font>
<font color="red"> 104.         self._start_inline('**')</font>
<font color="black"> 105. </font>
<font color="green"> 106.     def end_bold(self):</font>
<font color="red"> 107.         self._end_inline('**')</font>
<font color="black"> 108. </font>
<font color="green"> 109.     def start_b(self, attrs=None):</font>
<font color="red"> 110.         self.doc.do_translation = True</font>
<font color="red"> 111.         self.start_bold(attrs)</font>
<font color="black"> 112. </font>
<font color="green"> 113.     def end_b(self):</font>
<font color="red"> 114.         self.doc.do_translation = False</font>
<font color="red"> 115.         self.end_bold()</font>
<font color="black"> 116. </font>
<font color="green"> 117.     def bold(self, s):</font>
<font color="red"> 118.         if s:</font>
<font color="red"> 119.             self.start_bold()</font>
<font color="red"> 120.             self.doc.write(s)</font>
<font color="red"> 121.             self.end_bold()</font>
<font color="black"> 122. </font>
<font color="green"> 123.     def ref(self, title, link=None):</font>
<font color="red"> 124.         if link is None:</font>
<font color="red"> 125.             link = title</font>
<font color="red"> 126.         self.doc.write(':doc:`%s &lt;%s&gt;`' % (title, link))</font>
<font color="black"> 127. </font>
<font color="green"> 128.     def _heading(self, s, border_char):</font>
<font color="red"> 129.         border = border_char * len(s)</font>
<font color="red"> 130.         self.new_paragraph()</font>
<font color="red"> 131.         self.doc.write('%s\n%s\n%s' % (border, s, border))</font>
<font color="red"> 132.         self.new_paragraph()</font>
<font color="black"> 133. </font>
<font color="green"> 134.     def h1(self, s):</font>
<font color="red"> 135.         self._heading(s, '*')</font>
<font color="black"> 136. </font>
<font color="green"> 137.     def h2(self, s):</font>
<font color="red"> 138.         self._heading(s, '=')</font>
<font color="black"> 139. </font>
<font color="green"> 140.     def h3(self, s):</font>
<font color="red"> 141.         self._heading(s, '-')</font>
<font color="black"> 142. </font>
<font color="green"> 143.     def start_italics(self, attrs=None):</font>
<font color="red"> 144.         self._start_inline('*')</font>
<font color="black"> 145. </font>
<font color="green"> 146.     def end_italics(self):</font>
<font color="red"> 147.         self._end_inline('*')</font>
<font color="black"> 148. </font>
<font color="green"> 149.     def italics(self, s):</font>
<font color="red"> 150.         if s:</font>
<font color="red"> 151.             self.start_italics()</font>
<font color="red"> 152.             self.doc.write(s)</font>
<font color="red"> 153.             self.end_italics()</font>
<font color="black"> 154. </font>
<font color="green"> 155.     def start_p(self, attrs=None):</font>
<font color="red"> 156.         if self.do_p:</font>
<font color="red"> 157.             self.doc.write('\n\n%s' % self.spaces())</font>
<font color="black"> 158. </font>
<font color="green"> 159.     def end_p(self):</font>
<font color="red"> 160.         if self.do_p:</font>
<font color="red"> 161.             self.doc.write('\n\n%s' % self.spaces())</font>
<font color="black"> 162. </font>
<font color="green"> 163.     def start_code(self, attrs=None):</font>
<font color="red"> 164.         self.doc.do_translation = True</font>
<font color="red"> 165.         self._start_inline('``')</font>
<font color="black"> 166. </font>
<font color="green"> 167.     def end_code(self):</font>
<font color="red"> 168.         self.doc.do_translation = False</font>
<font color="red"> 169.         self._end_inline('``')</font>
<font color="black"> 170. </font>
<font color="green"> 171.     def code(self, s):</font>
<font color="red"> 172.         if s:</font>
<font color="red"> 173.             self.start_code()</font>
<font color="red"> 174.             self.doc.write(s)</font>
<font color="red"> 175.             self.end_code()</font>
<font color="black"> 176. </font>
<font color="green"> 177.     def start_note(self, attrs=None):</font>
<font color="red"> 178.         self.new_paragraph()</font>
<font color="red"> 179.         self.doc.write('.. note::')</font>
<font color="red"> 180.         self.indent()</font>
<font color="red"> 181.         self.new_paragraph()</font>
<font color="black"> 182. </font>
<font color="green"> 183.     def end_note(self):</font>
<font color="red"> 184.         self.dedent()</font>
<font color="red"> 185.         self.new_paragraph()</font>
<font color="black"> 186. </font>
<font color="green"> 187.     def start_important(self, attrs=None):</font>
<font color="red"> 188.         self.new_paragraph()</font>
<font color="red"> 189.         self.doc.write('.. warning::')</font>
<font color="red"> 190.         self.indent()</font>
<font color="red"> 191.         self.new_paragraph()</font>
<font color="black"> 192. </font>
<font color="green"> 193.     def end_important(self):</font>
<font color="red"> 194.         self.dedent()</font>
<font color="red"> 195.         self.new_paragraph()</font>
<font color="black"> 196. </font>
<font color="green"> 197.     def start_danger(self, attrs=None):</font>
<font color="red"> 198.         self.new_paragraph()</font>
<font color="red"> 199.         self.doc.write('.. danger::')</font>
<font color="red"> 200.         self.indent()</font>
<font color="red"> 201.         self.new_paragraph()</font>
<font color="black"> 202. </font>
<font color="green"> 203.     def end_danger(self):</font>
<font color="red"> 204.         self.dedent()</font>
<font color="red"> 205.         self.new_paragraph()</font>
<font color="black"> 206. </font>
<font color="green"> 207.     def start_a(self, attrs=None):</font>
<font color="red"> 208.         if attrs:</font>
<font color="red"> 209.             for attr_key, attr_value in attrs:</font>
<font color="red"> 210.                 if attr_key == 'href':</font>
<font color="red"> 211.                     self.a_href = attr_value</font>
<font color="red"> 212.                     self.doc.write('`')</font>
<font color="black"> 213.         else:</font>
<font color="black"> 214.             # There are some model documentation that</font>
<font color="black"> 215.             # looks like this: &lt;a&gt;DescribeInstances&lt;/a&gt;.</font>
<font color="black"> 216.             # In this case we just write out an empty</font>
<font color="black"> 217.             # string.</font>
<font color="red"> 218.             self.doc.write(' ')</font>
<font color="red"> 219.         self.doc.do_translation = True</font>
<font color="black"> 220. </font>
<font color="green"> 221.     def link_target_definition(self, refname, link):</font>
<font color="red"> 222.         self.doc.writeln('.. _%s: %s' % (refname, link))</font>
<font color="black"> 223. </font>
<font color="green"> 224.     def sphinx_reference_label(self, label, text=None):</font>
<font color="red"> 225.         if text is None:</font>
<font color="red"> 226.             text = label</font>
<font color="red"> 227.         if self.doc.target == 'html':</font>
<font color="red"> 228.             self.doc.write(':ref:`%s &lt;%s&gt;`' % (text, label))</font>
<font color="black"> 229.         else:</font>
<font color="red"> 230.             self.doc.write(text)</font>
<font color="black"> 231. </font>
<font color="green"> 232.     def end_a(self):</font>
<font color="red"> 233.         self.doc.do_translation = False</font>
<font color="red"> 234.         if self.a_href:</font>
<font color="red"> 235.             last_write = self.doc.pop_write()</font>
<font color="red"> 236.             last_write = last_write.rstrip(' ')</font>
<font color="red"> 237.             if last_write and last_write != '`':</font>
<font color="red"> 238.                 if ':' in last_write:</font>
<font color="red"> 239.                     last_write = last_write.replace(':', r'\:')</font>
<font color="red"> 240.                 self.doc.push_write(last_write)</font>
<font color="red"> 241.                 self.doc.push_write(' &lt;%s&gt;`__' % self.a_href)</font>
<font color="red"> 242.             elif last_write == '`':</font>
<font color="black"> 243.                 # Look at start_a().  It will do a self.doc.write('`')</font>
<font color="black"> 244.                 # which is the start of the link title.  If that is the</font>
<font color="black"> 245.                 # case then there was no link text.  We should just</font>
<font color="black"> 246.                 # use an inline link.  The syntax of this is</font>
<font color="black"> 247.                 # `&lt;http://url&gt;`_</font>
<font color="red"> 248.                 self.doc.push_write('`&lt;%s&gt;`__' % self.a_href)</font>
<font color="black"> 249.             else:</font>
<font color="red"> 250.                 self.doc.push_write(self.a_href)</font>
<font color="red"> 251.                 self.doc.hrefs[self.a_href] = self.a_href</font>
<font color="red"> 252.                 self.doc.write('`__')</font>
<font color="red"> 253.             self.a_href = None</font>
<font color="red"> 254.         self.doc.write(' ')</font>
<font color="black"> 255. </font>
<font color="green"> 256.     def start_i(self, attrs=None):</font>
<font color="red"> 257.         self.doc.do_translation = True</font>
<font color="red"> 258.         self.start_italics()</font>
<font color="black"> 259. </font>
<font color="green"> 260.     def end_i(self):</font>
<font color="red"> 261.         self.doc.do_translation = False</font>
<font color="red"> 262.         self.end_italics()</font>
<font color="black"> 263. </font>
<font color="green"> 264.     def start_li(self, attrs=None):</font>
<font color="red"> 265.         self.new_line()</font>
<font color="red"> 266.         self.do_p = False</font>
<font color="red"> 267.         self.doc.write('* ')</font>
<font color="black"> 268. </font>
<font color="green"> 269.     def end_li(self):</font>
<font color="red"> 270.         self.do_p = True</font>
<font color="red"> 271.         self.new_line()</font>
<font color="black"> 272. </font>
<font color="green"> 273.     def li(self, s):</font>
<font color="red"> 274.         if s:</font>
<font color="red"> 275.             self.start_li()</font>
<font color="red"> 276.             self.doc.writeln(s)</font>
<font color="red"> 277.             self.end_li()</font>
<font color="black"> 278. </font>
<font color="green"> 279.     def start_ul(self, attrs=None):</font>
<font color="red"> 280.         if self.list_depth != 0:</font>
<font color="red"> 281.             self.indent()</font>
<font color="red"> 282.         self.list_depth += 1</font>
<font color="red"> 283.         self.new_paragraph()</font>
<font color="black"> 284. </font>
<font color="green"> 285.     def end_ul(self):</font>
<font color="red"> 286.         self.list_depth -= 1</font>
<font color="red"> 287.         if self.list_depth != 0:</font>
<font color="red"> 288.             self.dedent()</font>
<font color="red"> 289.         self.new_paragraph()</font>
<font color="black"> 290. </font>
<font color="green"> 291.     def start_ol(self, attrs=None):</font>
<font color="black"> 292.         # TODO: Need to control the bullets used for LI items</font>
<font color="red"> 293.         if self.list_depth != 0:</font>
<font color="red"> 294.             self.indent()</font>
<font color="red"> 295.         self.list_depth += 1</font>
<font color="red"> 296.         self.new_paragraph()</font>
<font color="black"> 297. </font>
<font color="green"> 298.     def end_ol(self):</font>
<font color="red"> 299.         self.list_depth -= 1</font>
<font color="red"> 300.         if self.list_depth != 0:</font>
<font color="red"> 301.             self.dedent()</font>
<font color="red"> 302.         self.new_paragraph()</font>
<font color="black"> 303. </font>
<font color="green"> 304.     def start_examples(self, attrs=None):</font>
<font color="red"> 305.         self.doc.keep_data = False</font>
<font color="black"> 306. </font>
<font color="green"> 307.     def end_examples(self):</font>
<font color="red"> 308.         self.doc.keep_data = True</font>
<font color="black"> 309. </font>
<font color="green"> 310.     def start_fullname(self, attrs=None):</font>
<font color="red"> 311.         self.doc.keep_data = False</font>
<font color="black"> 312. </font>
<font color="green"> 313.     def end_fullname(self):</font>
<font color="red"> 314.         self.doc.keep_data = True</font>
<font color="black"> 315. </font>
<font color="green"> 316.     def start_codeblock(self, attrs=None):</font>
<font color="red"> 317.         self.doc.write('::')</font>
<font color="red"> 318.         self.indent()</font>
<font color="red"> 319.         self.new_paragraph()</font>
<font color="black"> 320. </font>
<font color="green"> 321.     def end_codeblock(self):</font>
<font color="red"> 322.         self.dedent()</font>
<font color="red"> 323.         self.new_paragraph()</font>
<font color="black"> 324. </font>
<font color="green"> 325.     def codeblock(self, code):</font>
<font color="black"> 326.         &quot;&quot;&quot;</font>
<font color="black"> 327.         Literal code blocks are introduced by ending a paragraph with</font>
<font color="black"> 328.         the special marker ::.  The literal block must be indented</font>
<font color="black"> 329.         (and, like all paragraphs, separated from the surrounding</font>
<font color="black"> 330.         ones by blank lines).</font>
<font color="black"> 331.         &quot;&quot;&quot;</font>
<font color="red"> 332.         self.start_codeblock()</font>
<font color="red"> 333.         self.doc.writeln(code)</font>
<font color="red"> 334.         self.end_codeblock()</font>
<font color="black"> 335. </font>
<font color="green"> 336.     def toctree(self):</font>
<font color="red"> 337.         if self.doc.target == 'html':</font>
<font color="red"> 338.             self.doc.write('\n.. toctree::\n')</font>
<font color="red"> 339.             self.doc.write('  :maxdepth: 1\n')</font>
<font color="red"> 340.             self.doc.write('  :titlesonly:\n\n')</font>
<font color="black"> 341.         else:</font>
<font color="red"> 342.             self.start_ul()</font>
<font color="black"> 343. </font>
<font color="green"> 344.     def tocitem(self, item, file_name=None):</font>
<font color="red"> 345.         if self.doc.target == 'man':</font>
<font color="red"> 346.             self.li(item)</font>
<font color="black"> 347.         else:</font>
<font color="red"> 348.             if file_name:</font>
<font color="red"> 349.                 self.doc.writeln('  %s' % file_name)</font>
<font color="black"> 350.             else:</font>
<font color="red"> 351.                 self.doc.writeln('  %s' % item)</font>
<font color="black"> 352. </font>
<font color="green"> 353.     def hidden_toctree(self):</font>
<font color="red"> 354.         if self.doc.target == 'html':</font>
<font color="red"> 355.             self.doc.write('\n.. toctree::\n')</font>
<font color="red"> 356.             self.doc.write('  :maxdepth: 1\n')</font>
<font color="red"> 357.             self.doc.write('  :hidden:\n\n')</font>
<font color="black"> 358. </font>
<font color="green"> 359.     def hidden_tocitem(self, item):</font>
<font color="red"> 360.         if self.doc.target == 'html':</font>
<font color="red"> 361.             self.tocitem(item)</font>
<font color="black"> 362. </font>
<font color="green"> 363.     def table_of_contents(self, title=None, depth=None):</font>
<font color="red"> 364.         self.doc.write('.. contents:: ')</font>
<font color="red"> 365.         if title is not None:</font>
<font color="red"> 366.             self.doc.writeln(title)</font>
<font color="red"> 367.         if depth is not None:</font>
<font color="red"> 368.             self.doc.writeln('   :depth: %s' % depth)</font>
<font color="black"> 369. </font>
<font color="green"> 370.     def start_sphinx_py_class(self, class_name):</font>
<font color="red"> 371.         self.new_paragraph()</font>
<font color="red"> 372.         self.doc.write('.. py:class:: %s' % class_name)</font>
<font color="red"> 373.         self.indent()</font>
<font color="red"> 374.         self.new_paragraph()</font>
<font color="black"> 375. </font>
<font color="green"> 376.     def end_sphinx_py_class(self):</font>
<font color="red"> 377.         self.dedent()</font>
<font color="red"> 378.         self.new_paragraph()</font>
<font color="black"> 379. </font>
<font color="green"> 380.     def start_sphinx_py_method(self, method_name, parameters=None):</font>
<font color="red"> 381.         self.new_paragraph()</font>
<font color="red"> 382.         content = '.. py:method:: %s' % method_name</font>
<font color="red"> 383.         if parameters is not None:</font>
<font color="red"> 384.             content += '(%s)' % parameters</font>
<font color="red"> 385.         self.doc.write(content)</font>
<font color="red"> 386.         self.indent()</font>
<font color="red"> 387.         self.new_paragraph()</font>
<font color="black"> 388. </font>
<font color="green"> 389.     def end_sphinx_py_method(self):</font>
<font color="red"> 390.         self.dedent()</font>
<font color="red"> 391.         self.new_paragraph()</font>
<font color="black"> 392. </font>
<font color="green"> 393.     def start_sphinx_py_attr(self, attr_name):</font>
<font color="red"> 394.         self.new_paragraph()</font>
<font color="red"> 395.         self.doc.write('.. py:attribute:: %s' % attr_name)</font>
<font color="red"> 396.         self.indent()</font>
<font color="red"> 397.         self.new_paragraph()</font>
<font color="black"> 398. </font>
<font color="green"> 399.     def end_sphinx_py_attr(self):</font>
<font color="red"> 400.         self.dedent()</font>
<font color="red"> 401.         self.new_paragraph()</font>
<font color="black"> 402. </font>
<font color="green"> 403.     def write_py_doc_string(self, docstring):</font>
<font color="red"> 404.         docstring_lines = docstring.splitlines()</font>
<font color="red"> 405.         for docstring_line in docstring_lines:</font>
<font color="red"> 406.             self.doc.writeln(docstring_line)</font>
<font color="black"> 407. </font>
<font color="green"> 408.     def external_link(self, title, link):</font>
<font color="red"> 409.         if self.doc.target == 'html':</font>
<font color="red"> 410.             self.doc.write('`%s &lt;%s&gt;`_' % (title, link))</font>
<font color="black"> 411.         else:</font>
<font color="red"> 412.             self.doc.write(title)</font>
<font color="black"> 413. </font>
<font color="green"> 414.     def internal_link(self, title, page):</font>
<font color="red"> 415.         if self.doc.target == 'html':</font>
<font color="red"> 416.             self.doc.write(':doc:`%s &lt;%s&gt;`' % (title, page))</font>
<font color="black"> 417.         else:</font>
<font color="red"> 418.             self.doc.write(title)</font>
</pre>

