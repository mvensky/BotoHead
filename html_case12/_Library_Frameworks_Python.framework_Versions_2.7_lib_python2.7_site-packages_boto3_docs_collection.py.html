source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/boto3/docs/collection.py</b><br>


file stats: <b>127 lines, 13 executed: 10.2% covered</b>
<pre>
<font color="black">   1. # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. from botocore import xform_name</font>
<font color="green">  14. from botocore.docs.method import get_instance_public_methods</font>
<font color="green">  15. from botocore.docs.utils import DocumentedShape</font>
<font color="black">  16. </font>
<font color="green">  17. from boto3.docs.base import BaseDocumenter</font>
<font color="green">  18. from boto3.docs.utils import get_resource_ignore_params</font>
<font color="green">  19. from boto3.docs.method import document_model_driven_resource_method</font>
<font color="green">  20. from boto3.docs.utils import add_resource_type_overview</font>
<font color="black">  21. </font>
<font color="black">  22. </font>
<font color="green">  23. class CollectionDocumenter(BaseDocumenter):</font>
<font color="green">  24.     def document_collections(self, section):</font>
<font color="red">  25.         collections = self._resource.meta.resource_model.collections</font>
<font color="red">  26.         collections_list = []</font>
<font color="red">  27.         add_resource_type_overview(</font>
<font color="red">  28.             section=section,</font>
<font color="red">  29.             resource_type='Collections',</font>
<font color="black">  30.             description=(</font>
<font color="red">  31.                 'Collections provide an interface to iterate over and '</font>
<font color="black">  32.                 'manipulate groups of resources. '),</font>
<font color="red">  33.             intro_link='guide_collections')</font>
<font color="red">  34.         self.member_map['collections'] = collections_list</font>
<font color="red">  35.         for collection in collections:</font>
<font color="red">  36.             collection_section = section.add_new_section(collection.name)</font>
<font color="red">  37.             collections_list.append(collection.name)</font>
<font color="red">  38.             self._document_collection(collection_section, collection)</font>
<font color="black">  39. </font>
<font color="green">  40.     def _document_collection(self, section, collection):</font>
<font color="red">  41.         methods = get_instance_public_methods(</font>
<font color="red">  42.             getattr(self._resource, collection.name))</font>
<font color="red">  43.         document_collection_object(section, collection)</font>
<font color="red">  44.         batch_actions = {}</font>
<font color="red">  45.         for batch_action in collection.batch_actions:</font>
<font color="red">  46.             batch_actions[batch_action.name] = batch_action</font>
<font color="black">  47. </font>
<font color="red">  48.         for method in sorted(methods):</font>
<font color="red">  49.             method_section = section.add_new_section(method)</font>
<font color="red">  50.             if method in batch_actions:</font>
<font color="red">  51.                 document_batch_action(</font>
<font color="red">  52.                     section=method_section,</font>
<font color="red">  53.                     resource_name=self._resource_name,</font>
<font color="red">  54.                     event_emitter=self._resource.meta.client.meta.events,</font>
<font color="red">  55.                     batch_action_model=batch_actions[method],</font>
<font color="red">  56.                     collection_model=collection,</font>
<font color="red">  57.                     service_model=self._resource.meta.client.meta.service_model</font>
<font color="black">  58.                 )</font>
<font color="black">  59.             else:</font>
<font color="red">  60.                 document_collection_method(</font>
<font color="red">  61.                     section=method_section,</font>
<font color="red">  62.                     resource_name=self._resource_name,</font>
<font color="red">  63.                     action_name=method,</font>
<font color="red">  64.                     event_emitter=self._resource.meta.client.meta.events,</font>
<font color="red">  65.                     collection_model=collection,</font>
<font color="red">  66.                     service_model=self._resource.meta.client.meta.service_model</font>
<font color="black">  67.                 )</font>
<font color="black">  68. </font>
<font color="black">  69. </font>
<font color="black">  70. def document_collection_object(section, collection_model,</font>
<font color="green">  71.                                include_signature=True):</font>
<font color="black">  72.     &quot;&quot;&quot;Documents a collection resource object</font>
<font color="black">  73. </font>
<font color="black">  74.     :param section: The section to write to</font>
<font color="black">  75. </font>
<font color="black">  76.     :param collection_model: The model of the collection</font>
<font color="black">  77. </font>
<font color="black">  78.     :param include_signature: Whether or not to include the signature.</font>
<font color="black">  79.         It is useful for generating docstrings.</font>
<font color="black">  80.     &quot;&quot;&quot;</font>
<font color="red">  81.     if include_signature:</font>
<font color="red">  82.         section.style.start_sphinx_py_attr(collection_model.name)</font>
<font color="red">  83.     section.include_doc_string(</font>
<font color="red">  84.         'A collection of %s resources' % collection_model.resource.type)</font>
<font color="black">  85. </font>
<font color="black">  86. </font>
<font color="black">  87. def document_batch_action(section, resource_name, event_emitter,</font>
<font color="black">  88.                           batch_action_model, service_model, collection_model,</font>
<font color="green">  89.                           include_signature=True):</font>
<font color="black">  90.     &quot;&quot;&quot;Documents a collection's batch action</font>
<font color="black">  91. </font>
<font color="black">  92.     :param section: The section to write to</font>
<font color="black">  93. </font>
<font color="black">  94.     :param resource_name: The name of the resource</font>
<font color="black">  95. </font>
<font color="black">  96.     :param action_name: The name of collection action. Currently only</font>
<font color="black">  97.         can be all, filter, limit, or page_size</font>
<font color="black">  98. </font>
<font color="black">  99.     :param event_emitter: The event emitter to use to emit events</font>
<font color="black"> 100. </font>
<font color="black"> 101.     :param batch_action_model: The model of the batch action</font>
<font color="black"> 102. </font>
<font color="black"> 103.     :param collection_model: The model of the collection</font>
<font color="black"> 104. </font>
<font color="black"> 105.     :param service_model: The model of the service</font>
<font color="black"> 106. </font>
<font color="black"> 107.     :param include_signature: Whether or not to include the signature.</font>
<font color="black"> 108.         It is useful for generating docstrings.</font>
<font color="black"> 109.     &quot;&quot;&quot;</font>
<font color="red"> 110.     operation_model = service_model.operation_model(</font>
<font color="red"> 111.         batch_action_model.request.operation)</font>
<font color="red"> 112.     ignore_params = get_resource_ignore_params(</font>
<font color="red"> 113.         batch_action_model.request.params)</font>
<font color="black"> 114. </font>
<font color="red"> 115.     example_return_value = 'response'</font>
<font color="red"> 116.     if batch_action_model.resource:</font>
<font color="red"> 117.         example_return_value = xform_name(batch_action_model.resource.type)</font>
<font color="black"> 118. </font>
<font color="red"> 119.     example_resource_name = xform_name(resource_name)</font>
<font color="red"> 120.     if service_model.service_name == resource_name:</font>
<font color="red"> 121.         example_resource_name = resource_name</font>
<font color="red"> 122.     example_prefix = '%s = %s.%s.%s' % (</font>
<font color="red"> 123.         example_return_value, example_resource_name,</font>
<font color="red"> 124.         collection_model.name, batch_action_model.name</font>
<font color="black"> 125.     )</font>
<font color="red"> 126.     document_model_driven_resource_method(</font>
<font color="red"> 127.         section=section, method_name=batch_action_model.name,</font>
<font color="red"> 128.         operation_model=operation_model,</font>
<font color="red"> 129.         event_emitter=event_emitter,</font>
<font color="red"> 130.         method_description=operation_model.documentation,</font>
<font color="red"> 131.         example_prefix=example_prefix,</font>
<font color="red"> 132.         exclude_input=ignore_params,</font>
<font color="red"> 133.         resource_action_model=batch_action_model,</font>
<font color="red"> 134.         include_signature=include_signature</font>
<font color="black"> 135.     )</font>
<font color="black"> 136. </font>
<font color="black"> 137. </font>
<font color="black"> 138. def document_collection_method(section, resource_name, action_name,</font>
<font color="black"> 139.                                event_emitter, collection_model, service_model,</font>
<font color="green"> 140.                                include_signature=True):</font>
<font color="black"> 141.     &quot;&quot;&quot;Documents a collection method</font>
<font color="black"> 142. </font>
<font color="black"> 143.     :param section: The section to write to</font>
<font color="black"> 144. </font>
<font color="black"> 145.     :param resource_name: The name of the resource</font>
<font color="black"> 146. </font>
<font color="black"> 147.     :param action_name: The name of collection action. Currently only</font>
<font color="black"> 148.         can be all, filter, limit, or page_size</font>
<font color="black"> 149. </font>
<font color="black"> 150.     :param event_emitter: The event emitter to use to emit events</font>
<font color="black"> 151. </font>
<font color="black"> 152.     :param collection_model: The model of the collection</font>
<font color="black"> 153. </font>
<font color="black"> 154.     :param service_model: The model of the service</font>
<font color="black"> 155. </font>
<font color="black"> 156.     :param include_signature: Whether or not to include the signature.</font>
<font color="black"> 157.         It is useful for generating docstrings.</font>
<font color="black"> 158.     &quot;&quot;&quot;</font>
<font color="red"> 159.     operation_model = service_model.operation_model(</font>
<font color="red"> 160.         collection_model.request.operation)</font>
<font color="black"> 161. </font>
<font color="red"> 162.     underlying_operation_members = []</font>
<font color="red"> 163.     if operation_model.input_shape:</font>
<font color="red"> 164.         underlying_operation_members = operation_model.input_shape.members</font>
<font color="black"> 165. </font>
<font color="red"> 166.     example_resource_name = xform_name(resource_name)</font>
<font color="red"> 167.     if service_model.service_name == resource_name:</font>
<font color="red"> 168.         example_resource_name = resource_name</font>
<font color="black"> 169. </font>
<font color="red"> 170.     custom_action_info_dict = {</font>
<font color="red"> 171.         'all': {</font>
<font color="black"> 172.             'method_description': (</font>
<font color="red"> 173.                 'Creates an iterable of all %s resources '</font>
<font color="red"> 174.                 'in the collection.' % collection_model.resource.type),</font>
<font color="red"> 175.             'example_prefix': '%s_iterator = %s.%s.all' % (</font>
<font color="red"> 176.                 xform_name(collection_model.resource.type),</font>
<font color="red"> 177.                 example_resource_name, collection_model.name),</font>
<font color="red"> 178.             'exclude_input': underlying_operation_members</font>
<font color="black"> 179.         },</font>
<font color="red"> 180.         'filter': {</font>
<font color="black"> 181.             'method_description': (</font>
<font color="red"> 182.                 'Creates an iterable of all %s resources '</font>
<font color="black"> 183.                 'in the collection filtered by kwargs passed to '</font>
<font color="red"> 184.                 'method.' % collection_model.resource.type),</font>
<font color="red"> 185.             'example_prefix': '%s_iterator = %s.%s.filter' % (</font>
<font color="red"> 186.                 xform_name(collection_model.resource.type),</font>
<font color="red"> 187.                 example_resource_name, collection_model.name),</font>
<font color="red"> 188.             'exclude_input': get_resource_ignore_params(</font>
<font color="red"> 189.                 collection_model.request.params)</font>
<font color="black"> 190.         },</font>
<font color="red"> 191.         'limit': {</font>
<font color="black"> 192.             'method_description': (</font>
<font color="red"> 193.                 'Creates an iterable up to a specified amount of '</font>
<font color="black"> 194.                 '%s resources in the collection.' %</font>
<font color="red"> 195.                 collection_model.resource.type),</font>
<font color="red"> 196.             'example_prefix': '%s_iterator = %s.%s.limit' % (</font>
<font color="red"> 197.                 xform_name(collection_model.resource.type),</font>
<font color="red"> 198.                 example_resource_name, collection_model.name),</font>
<font color="black"> 199.             'include_input': [</font>
<font color="red"> 200.                 DocumentedShape(</font>
<font color="red"> 201.                     name='count', type_name='integer',</font>
<font color="black"> 202.                     documentation=(</font>
<font color="red"> 203.                         'The limit to the number of resources '</font>
<font color="black"> 204.                         'in the iterable.'))],</font>
<font color="red"> 205.             'exclude_input': underlying_operation_members</font>
<font color="black"> 206.         },</font>
<font color="red"> 207.         'page_size': {</font>
<font color="black"> 208.             'method_description': (</font>
<font color="red"> 209.                 'Creates an iterable of all %s resources '</font>
<font color="black"> 210.                 'in the collection, but limits the number of '</font>
<font color="black"> 211.                 'items returned by each service call by the specified '</font>
<font color="red"> 212.                 'amount.' % collection_model.resource.type),</font>
<font color="red"> 213.             'example_prefix': '%s_iterator = %s.%s.page_size' % (</font>
<font color="red"> 214.                 xform_name(collection_model.resource.type),</font>
<font color="red"> 215.                 example_resource_name, collection_model.name),</font>
<font color="black"> 216.             'include_input': [</font>
<font color="red"> 217.                 DocumentedShape(</font>
<font color="red"> 218.                     name='count', type_name='integer',</font>
<font color="black"> 219.                     documentation=(</font>
<font color="red"> 220.                         'The number of items returned by each '</font>
<font color="black"> 221.                         'service call'))],</font>
<font color="red"> 222.             'exclude_input': underlying_operation_members</font>
<font color="black"> 223.         }</font>
<font color="black"> 224.     }</font>
<font color="red"> 225.     if action_name in custom_action_info_dict:</font>
<font color="red"> 226.         action_info = custom_action_info_dict[action_name]</font>
<font color="red"> 227.         document_model_driven_resource_method(</font>
<font color="red"> 228.             section=section, method_name=action_name,</font>
<font color="red"> 229.             operation_model=operation_model,</font>
<font color="red"> 230.             event_emitter=event_emitter,</font>
<font color="red"> 231.             resource_action_model=collection_model,</font>
<font color="red"> 232.             include_signature=include_signature,</font>
<font color="red"> 233.             **action_info</font>
<font color="black"> 234.         )</font>
</pre>

