source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/botocore/docs/docstring.py</b><br>


file stats: <b>42 lines, 25 executed: 59.5% covered</b>
<pre>
<font color="black">   1. # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. from botocore.docs.method import document_model_driven_method</font>
<font color="green">  14. from botocore.docs.waiter import document_wait_method</font>
<font color="green">  15. from botocore.docs.paginator import document_paginate_method</font>
<font color="green">  16. from botocore.docs.bcdoc.restdoc import DocumentStructure</font>
<font color="black">  17. </font>
<font color="black">  18. </font>
<font color="green">  19. class LazyLoadedDocstring(str):</font>
<font color="black">  20.     &quot;&quot;&quot;Used for lazily loading docstrings</font>
<font color="black">  21. </font>
<font color="black">  22.     You can instantiate this class and assign it to a __doc__ value.</font>
<font color="black">  23.     The docstring will not be generated till accessed via __doc__ or</font>
<font color="black">  24.     help(). Note that all docstring classes **must** subclass from</font>
<font color="black">  25.     this class. It cannot be used directly as a docstring.</font>
<font color="green">  26.     &quot;&quot;&quot;</font>
<font color="green">  27.     def __init__(self, *args, **kwargs):</font>
<font color="black">  28.         &quot;&quot;&quot;</font>
<font color="black">  29.         The args and kwargs are the same as the underlying document</font>
<font color="black">  30.         generation function. These just get proxied to the underlying</font>
<font color="black">  31.         function.</font>
<font color="black">  32.         &quot;&quot;&quot;</font>
<font color="green">  33.         super(LazyLoadedDocstring, self).__init__()</font>
<font color="green">  34.         self._gen_args = args</font>
<font color="green">  35.         self._gen_kwargs = kwargs</font>
<font color="green">  36.         self._docstring = None</font>
<font color="black">  37. </font>
<font color="green">  38.     def __new__(cls, *args, **kwargs):</font>
<font color="black">  39.         # Needed in order to sub class from str with args and kwargs</font>
<font color="green">  40.         return super(LazyLoadedDocstring, cls).__new__(cls)</font>
<font color="black">  41. </font>
<font color="green">  42.     def _write_docstring(self, *args, **kwargs):</font>
<font color="red">  43.         raise NotImplementedError(</font>
<font color="red">  44.             '_write_docstring is not implemented. Please subclass from '</font>
<font color="black">  45.             'this class and provide your own _write_docstring method'</font>
<font color="black">  46.         )</font>
<font color="black">  47. </font>
<font color="green">  48.     def expandtabs(self, tabsize=8):</font>
<font color="black">  49.         &quot;&quot;&quot;Expands tabs to spaces</font>
<font color="black">  50. </font>
<font color="black">  51.         So this is a big hack in order to get lazy loaded docstring work</font>
<font color="black">  52.         for the ``help()``. In the ``help()`` function, ``pydoc`` and</font>
<font color="black">  53.         ``inspect`` are used. At some point the ``inspect.cleandoc``</font>
<font color="black">  54.         method is called. To clean the docs ``expandtabs`` is called</font>
<font color="black">  55.         and that is where we override the method to generate and return the</font>
<font color="black">  56.         docstrings.</font>
<font color="black">  57.         &quot;&quot;&quot;</font>
<font color="red">  58.         if self._docstring is None:</font>
<font color="red">  59.             self._generate()</font>
<font color="red">  60.         return self._docstring.expandtabs(tabsize)</font>
<font color="black">  61. </font>
<font color="green">  62.     def __str__(self):</font>
<font color="red">  63.         return self._generate()</font>
<font color="black">  64. </font>
<font color="black">  65.     # __doc__ of target will use either __repr__ or __str__ of this class.</font>
<font color="green">  66.     __repr__ = __str__</font>
<font color="black">  67. </font>
<font color="green">  68.     def _generate(self):</font>
<font color="black">  69.         # Generate the docstring if it is not already cached.</font>
<font color="red">  70.         if self._docstring is None:</font>
<font color="red">  71.             self._docstring = self._create_docstring()</font>
<font color="red">  72.         return self._docstring</font>
<font color="black">  73. </font>
<font color="green">  74.     def _create_docstring(self):</font>
<font color="red">  75.         docstring_structure = DocumentStructure('docstring', target='html')</font>
<font color="black">  76.         # Call the document method function with the args and kwargs</font>
<font color="black">  77.         # passed to the class.</font>
<font color="red">  78.         self._write_docstring(</font>
<font color="red">  79.             docstring_structure, *self._gen_args,</font>
<font color="red">  80.             **self._gen_kwargs)</font>
<font color="red">  81.         return docstring_structure.flush_structure().decode('utf-8')</font>
<font color="black">  82. </font>
<font color="black">  83. </font>
<font color="green">  84. class ClientMethodDocstring(LazyLoadedDocstring):</font>
<font color="green">  85.     def _write_docstring(self, *args, **kwargs):</font>
<font color="red">  86.         document_model_driven_method(*args, **kwargs)</font>
<font color="black">  87. </font>
<font color="black">  88. </font>
<font color="green">  89. class WaiterDocstring(LazyLoadedDocstring):</font>
<font color="green">  90.     def _write_docstring(self, *args, **kwargs):</font>
<font color="red">  91.         document_wait_method(*args, **kwargs)</font>
<font color="black">  92. </font>
<font color="black">  93. </font>
<font color="green">  94. class PaginatorDocstring(LazyLoadedDocstring):</font>
<font color="green">  95.     def _write_docstring(self, *args, **kwargs):</font>
<font color="red">  96.         document_paginate_method(*args, **kwargs)</font>
</pre>

