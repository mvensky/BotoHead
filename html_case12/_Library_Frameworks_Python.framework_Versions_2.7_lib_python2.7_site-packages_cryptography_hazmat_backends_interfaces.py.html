source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/cryptography/hazmat/backends/interfaces.py</b><br>


file stats: <b>83 lines, 83 executed: 100.0% covered</b>
<pre>
<font color="black">   1. # This file is dual licensed under the terms of the Apache License, Version</font>
<font color="black">   2. # 2.0, and the BSD License. See the LICENSE file in the root of this repository</font>
<font color="black">   3. # for complete details.</font>
<font color="black">   4. </font>
<font color="green">   5. from __future__ import absolute_import, division, print_function</font>
<font color="black">   6. </font>
<font color="green">   7. import abc</font>
<font color="black">   8. </font>
<font color="green">   9. import six</font>
<font color="black">  10. </font>
<font color="black">  11. </font>
<font color="green">  12. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green">  13. class CipherBackend(object):</font>
<font color="green">  14.     @abc.abstractmethod</font>
<font color="black">  15.     def cipher_supported(self, cipher, mode):</font>
<font color="black">  16.         &quot;&quot;&quot;</font>
<font color="black">  17.         Return True if the given cipher and mode are supported.</font>
<font color="black">  18.         &quot;&quot;&quot;</font>
<font color="black">  19. </font>
<font color="green">  20.     @abc.abstractmethod</font>
<font color="black">  21.     def create_symmetric_encryption_ctx(self, cipher, mode):</font>
<font color="black">  22.         &quot;&quot;&quot;</font>
<font color="black">  23.         Get a CipherContext that can be used for encryption.</font>
<font color="black">  24.         &quot;&quot;&quot;</font>
<font color="black">  25. </font>
<font color="green">  26.     @abc.abstractmethod</font>
<font color="black">  27.     def create_symmetric_decryption_ctx(self, cipher, mode):</font>
<font color="black">  28.         &quot;&quot;&quot;</font>
<font color="black">  29.         Get a CipherContext that can be used for decryption.</font>
<font color="black">  30.         &quot;&quot;&quot;</font>
<font color="black">  31. </font>
<font color="black">  32. </font>
<font color="green">  33. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green">  34. class HashBackend(object):</font>
<font color="green">  35.     @abc.abstractmethod</font>
<font color="black">  36.     def hash_supported(self, algorithm):</font>
<font color="black">  37.         &quot;&quot;&quot;</font>
<font color="black">  38.         Return True if the hash algorithm is supported by this backend.</font>
<font color="black">  39.         &quot;&quot;&quot;</font>
<font color="black">  40. </font>
<font color="green">  41.     @abc.abstractmethod</font>
<font color="black">  42.     def create_hash_ctx(self, algorithm):</font>
<font color="black">  43.         &quot;&quot;&quot;</font>
<font color="black">  44.         Create a HashContext for calculating a message digest.</font>
<font color="black">  45.         &quot;&quot;&quot;</font>
<font color="black">  46. </font>
<font color="black">  47. </font>
<font color="green">  48. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green">  49. class HMACBackend(object):</font>
<font color="green">  50.     @abc.abstractmethod</font>
<font color="black">  51.     def hmac_supported(self, algorithm):</font>
<font color="black">  52.         &quot;&quot;&quot;</font>
<font color="black">  53.         Return True if the hash algorithm is supported for HMAC by this</font>
<font color="black">  54.         backend.</font>
<font color="black">  55.         &quot;&quot;&quot;</font>
<font color="black">  56. </font>
<font color="green">  57.     @abc.abstractmethod</font>
<font color="black">  58.     def create_hmac_ctx(self, key, algorithm):</font>
<font color="black">  59.         &quot;&quot;&quot;</font>
<font color="black">  60.         Create a MACContext for calculating a message authentication code.</font>
<font color="black">  61.         &quot;&quot;&quot;</font>
<font color="black">  62. </font>
<font color="black">  63. </font>
<font color="green">  64. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green">  65. class CMACBackend(object):</font>
<font color="green">  66.     @abc.abstractmethod</font>
<font color="black">  67.     def cmac_algorithm_supported(self, algorithm):</font>
<font color="black">  68.         &quot;&quot;&quot;</font>
<font color="black">  69.         Returns True if the block cipher is supported for CMAC by this backend</font>
<font color="black">  70.         &quot;&quot;&quot;</font>
<font color="black">  71. </font>
<font color="green">  72.     @abc.abstractmethod</font>
<font color="black">  73.     def create_cmac_ctx(self, algorithm):</font>
<font color="black">  74.         &quot;&quot;&quot;</font>
<font color="black">  75.         Create a MACContext for calculating a message authentication code.</font>
<font color="black">  76.         &quot;&quot;&quot;</font>
<font color="black">  77. </font>
<font color="black">  78. </font>
<font color="green">  79. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green">  80. class PBKDF2HMACBackend(object):</font>
<font color="green">  81.     @abc.abstractmethod</font>
<font color="black">  82.     def pbkdf2_hmac_supported(self, algorithm):</font>
<font color="black">  83.         &quot;&quot;&quot;</font>
<font color="black">  84.         Return True if the hash algorithm is supported for PBKDF2 by this</font>
<font color="black">  85.         backend.</font>
<font color="black">  86.         &quot;&quot;&quot;</font>
<font color="black">  87. </font>
<font color="green">  88.     @abc.abstractmethod</font>
<font color="black">  89.     def derive_pbkdf2_hmac(self, algorithm, length, salt, iterations,</font>
<font color="black">  90.                            key_material):</font>
<font color="black">  91.         &quot;&quot;&quot;</font>
<font color="black">  92.         Return length bytes derived from provided PBKDF2 parameters.</font>
<font color="black">  93.         &quot;&quot;&quot;</font>
<font color="black">  94. </font>
<font color="black">  95. </font>
<font color="green">  96. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green">  97. class RSABackend(object):</font>
<font color="green">  98.     @abc.abstractmethod</font>
<font color="black">  99.     def generate_rsa_private_key(self, public_exponent, key_size):</font>
<font color="black"> 100.         &quot;&quot;&quot;</font>
<font color="black"> 101.         Generate an RSAPrivateKey instance with public_exponent and a modulus</font>
<font color="black"> 102.         of key_size bits.</font>
<font color="black"> 103.         &quot;&quot;&quot;</font>
<font color="black"> 104. </font>
<font color="green"> 105.     @abc.abstractmethod</font>
<font color="black"> 106.     def rsa_padding_supported(self, padding):</font>
<font color="black"> 107.         &quot;&quot;&quot;</font>
<font color="black"> 108.         Returns True if the backend supports the given padding options.</font>
<font color="black"> 109.         &quot;&quot;&quot;</font>
<font color="black"> 110. </font>
<font color="green"> 111.     @abc.abstractmethod</font>
<font color="black"> 112.     def generate_rsa_parameters_supported(self, public_exponent, key_size):</font>
<font color="black"> 113.         &quot;&quot;&quot;</font>
<font color="black"> 114.         Returns True if the backend supports the given parameters for key</font>
<font color="black"> 115.         generation.</font>
<font color="black"> 116.         &quot;&quot;&quot;</font>
<font color="black"> 117. </font>
<font color="green"> 118.     @abc.abstractmethod</font>
<font color="black"> 119.     def load_rsa_private_numbers(self, numbers):</font>
<font color="black"> 120.         &quot;&quot;&quot;</font>
<font color="black"> 121.         Returns an RSAPrivateKey provider.</font>
<font color="black"> 122.         &quot;&quot;&quot;</font>
<font color="black"> 123. </font>
<font color="green"> 124.     @abc.abstractmethod</font>
<font color="black"> 125.     def load_rsa_public_numbers(self, numbers):</font>
<font color="black"> 126.         &quot;&quot;&quot;</font>
<font color="black"> 127.         Returns an RSAPublicKey provider.</font>
<font color="black"> 128.         &quot;&quot;&quot;</font>
<font color="black"> 129. </font>
<font color="black"> 130. </font>
<font color="green"> 131. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green"> 132. class DSABackend(object):</font>
<font color="green"> 133.     @abc.abstractmethod</font>
<font color="black"> 134.     def generate_dsa_parameters(self, key_size):</font>
<font color="black"> 135.         &quot;&quot;&quot;</font>
<font color="black"> 136.         Generate a DSAParameters instance with a modulus of key_size bits.</font>
<font color="black"> 137.         &quot;&quot;&quot;</font>
<font color="black"> 138. </font>
<font color="green"> 139.     @abc.abstractmethod</font>
<font color="black"> 140.     def generate_dsa_private_key(self, parameters):</font>
<font color="black"> 141.         &quot;&quot;&quot;</font>
<font color="black"> 142.         Generate a DSAPrivateKey instance with parameters as a DSAParameters</font>
<font color="black"> 143.         object.</font>
<font color="black"> 144.         &quot;&quot;&quot;</font>
<font color="black"> 145. </font>
<font color="green"> 146.     @abc.abstractmethod</font>
<font color="black"> 147.     def generate_dsa_private_key_and_parameters(self, key_size):</font>
<font color="black"> 148.         &quot;&quot;&quot;</font>
<font color="black"> 149.         Generate a DSAPrivateKey instance using key size only.</font>
<font color="black"> 150.         &quot;&quot;&quot;</font>
<font color="black"> 151. </font>
<font color="green"> 152.     @abc.abstractmethod</font>
<font color="black"> 153.     def dsa_hash_supported(self, algorithm):</font>
<font color="black"> 154.         &quot;&quot;&quot;</font>
<font color="black"> 155.         Return True if the hash algorithm is supported by the backend for DSA.</font>
<font color="black"> 156.         &quot;&quot;&quot;</font>
<font color="black"> 157. </font>
<font color="green"> 158.     @abc.abstractmethod</font>
<font color="black"> 159.     def dsa_parameters_supported(self, p, q, g):</font>
<font color="black"> 160.         &quot;&quot;&quot;</font>
<font color="black"> 161.         Return True if the parameters are supported by the backend for DSA.</font>
<font color="black"> 162.         &quot;&quot;&quot;</font>
<font color="black"> 163. </font>
<font color="green"> 164.     @abc.abstractmethod</font>
<font color="black"> 165.     def load_dsa_private_numbers(self, numbers):</font>
<font color="black"> 166.         &quot;&quot;&quot;</font>
<font color="black"> 167.         Returns a DSAPrivateKey provider.</font>
<font color="black"> 168.         &quot;&quot;&quot;</font>
<font color="black"> 169. </font>
<font color="green"> 170.     @abc.abstractmethod</font>
<font color="black"> 171.     def load_dsa_public_numbers(self, numbers):</font>
<font color="black"> 172.         &quot;&quot;&quot;</font>
<font color="black"> 173.         Returns a DSAPublicKey provider.</font>
<font color="black"> 174.         &quot;&quot;&quot;</font>
<font color="black"> 175. </font>
<font color="green"> 176.     @abc.abstractmethod</font>
<font color="black"> 177.     def load_dsa_parameter_numbers(self, numbers):</font>
<font color="black"> 178.         &quot;&quot;&quot;</font>
<font color="black"> 179.         Returns a DSAParameters provider.</font>
<font color="black"> 180.         &quot;&quot;&quot;</font>
<font color="black"> 181. </font>
<font color="black"> 182. </font>
<font color="green"> 183. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green"> 184. class EllipticCurveBackend(object):</font>
<font color="green"> 185.     @abc.abstractmethod</font>
<font color="black"> 186.     def elliptic_curve_signature_algorithm_supported(</font>
<font color="black"> 187.         self, signature_algorithm, curve</font>
<font color="black"> 188.     ):</font>
<font color="black"> 189.         &quot;&quot;&quot;</font>
<font color="black"> 190.         Returns True if the backend supports the named elliptic curve with the</font>
<font color="black"> 191.         specified signature algorithm.</font>
<font color="black"> 192.         &quot;&quot;&quot;</font>
<font color="black"> 193. </font>
<font color="green"> 194.     @abc.abstractmethod</font>
<font color="black"> 195.     def elliptic_curve_supported(self, curve):</font>
<font color="black"> 196.         &quot;&quot;&quot;</font>
<font color="black"> 197.         Returns True if the backend supports the named elliptic curve.</font>
<font color="black"> 198.         &quot;&quot;&quot;</font>
<font color="black"> 199. </font>
<font color="green"> 200.     @abc.abstractmethod</font>
<font color="black"> 201.     def generate_elliptic_curve_private_key(self, curve):</font>
<font color="black"> 202.         &quot;&quot;&quot;</font>
<font color="black"> 203.         Return an object conforming to the EllipticCurvePrivateKey interface.</font>
<font color="black"> 204.         &quot;&quot;&quot;</font>
<font color="black"> 205. </font>
<font color="green"> 206.     @abc.abstractmethod</font>
<font color="black"> 207.     def load_elliptic_curve_public_numbers(self, numbers):</font>
<font color="black"> 208.         &quot;&quot;&quot;</font>
<font color="black"> 209.         Return an EllipticCurvePublicKey provider using the given numbers.</font>
<font color="black"> 210.         &quot;&quot;&quot;</font>
<font color="black"> 211. </font>
<font color="green"> 212.     @abc.abstractmethod</font>
<font color="black"> 213.     def load_elliptic_curve_private_numbers(self, numbers):</font>
<font color="black"> 214.         &quot;&quot;&quot;</font>
<font color="black"> 215.         Return an EllipticCurvePrivateKey provider using the given numbers.</font>
<font color="black"> 216.         &quot;&quot;&quot;</font>
<font color="black"> 217. </font>
<font color="green"> 218.     @abc.abstractmethod</font>
<font color="black"> 219.     def elliptic_curve_exchange_algorithm_supported(self, algorithm, curve):</font>
<font color="black"> 220.         &quot;&quot;&quot;</font>
<font color="black"> 221.         Returns whether the exchange algorithm is supported by this backend.</font>
<font color="black"> 222.         &quot;&quot;&quot;</font>
<font color="black"> 223. </font>
<font color="green"> 224.     @abc.abstractmethod</font>
<font color="black"> 225.     def derive_elliptic_curve_private_key(self, private_value, curve):</font>
<font color="black"> 226.         &quot;&quot;&quot;</font>
<font color="black"> 227.         Compute the private key given the private value and curve.</font>
<font color="black"> 228.         &quot;&quot;&quot;</font>
<font color="black"> 229. </font>
<font color="black"> 230. </font>
<font color="green"> 231. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green"> 232. class PEMSerializationBackend(object):</font>
<font color="green"> 233.     @abc.abstractmethod</font>
<font color="black"> 234.     def load_pem_private_key(self, data, password):</font>
<font color="black"> 235.         &quot;&quot;&quot;</font>
<font color="black"> 236.         Loads a private key from PEM encoded data, using the provided password</font>
<font color="black"> 237.         if the data is encrypted.</font>
<font color="black"> 238.         &quot;&quot;&quot;</font>
<font color="black"> 239. </font>
<font color="green"> 240.     @abc.abstractmethod</font>
<font color="black"> 241.     def load_pem_public_key(self, data):</font>
<font color="black"> 242.         &quot;&quot;&quot;</font>
<font color="black"> 243.         Loads a public key from PEM encoded data.</font>
<font color="black"> 244.         &quot;&quot;&quot;</font>
<font color="black"> 245. </font>
<font color="black"> 246. </font>
<font color="green"> 247. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green"> 248. class DERSerializationBackend(object):</font>
<font color="green"> 249.     @abc.abstractmethod</font>
<font color="black"> 250.     def load_der_private_key(self, data, password):</font>
<font color="black"> 251.         &quot;&quot;&quot;</font>
<font color="black"> 252.         Loads a private key from DER encoded data. Uses the provided password</font>
<font color="black"> 253.         if the data is encrypted.</font>
<font color="black"> 254.         &quot;&quot;&quot;</font>
<font color="black"> 255. </font>
<font color="green"> 256.     @abc.abstractmethod</font>
<font color="black"> 257.     def load_der_public_key(self, data):</font>
<font color="black"> 258.         &quot;&quot;&quot;</font>
<font color="black"> 259.         Loads a public key from DER encoded data.</font>
<font color="black"> 260.         &quot;&quot;&quot;</font>
<font color="black"> 261. </font>
<font color="black"> 262. </font>
<font color="green"> 263. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green"> 264. class X509Backend(object):</font>
<font color="green"> 265.     @abc.abstractmethod</font>
<font color="black"> 266.     def load_pem_x509_certificate(self, data):</font>
<font color="black"> 267.         &quot;&quot;&quot;</font>
<font color="black"> 268.         Load an X.509 certificate from PEM encoded data.</font>
<font color="black"> 269.         &quot;&quot;&quot;</font>
<font color="black"> 270. </font>
<font color="green"> 271.     @abc.abstractmethod</font>
<font color="black"> 272.     def load_der_x509_certificate(self, data):</font>
<font color="black"> 273.         &quot;&quot;&quot;</font>
<font color="black"> 274.         Load an X.509 certificate from DER encoded data.</font>
<font color="black"> 275.         &quot;&quot;&quot;</font>
<font color="black"> 276. </font>
<font color="green"> 277.     @abc.abstractmethod</font>
<font color="black"> 278.     def load_der_x509_csr(self, data):</font>
<font color="black"> 279.         &quot;&quot;&quot;</font>
<font color="black"> 280.         Load an X.509 CSR from DER encoded data.</font>
<font color="black"> 281.         &quot;&quot;&quot;</font>
<font color="black"> 282. </font>
<font color="green"> 283.     @abc.abstractmethod</font>
<font color="black"> 284.     def load_pem_x509_csr(self, data):</font>
<font color="black"> 285.         &quot;&quot;&quot;</font>
<font color="black"> 286.         Load an X.509 CSR from PEM encoded data.</font>
<font color="black"> 287.         &quot;&quot;&quot;</font>
<font color="black"> 288. </font>
<font color="green"> 289.     @abc.abstractmethod</font>
<font color="black"> 290.     def create_x509_csr(self, builder, private_key, algorithm):</font>
<font color="black"> 291.         &quot;&quot;&quot;</font>
<font color="black"> 292.         Create and sign an X.509 CSR from a CSR builder object.</font>
<font color="black"> 293.         &quot;&quot;&quot;</font>
<font color="black"> 294. </font>
<font color="green"> 295.     @abc.abstractmethod</font>
<font color="black"> 296.     def create_x509_certificate(self, builder, private_key, algorithm):</font>
<font color="black"> 297.         &quot;&quot;&quot;</font>
<font color="black"> 298.         Create and sign an X.509 certificate from a CertificateBuilder object.</font>
<font color="black"> 299.         &quot;&quot;&quot;</font>
<font color="black"> 300. </font>
<font color="green"> 301.     @abc.abstractmethod</font>
<font color="black"> 302.     def create_x509_crl(self, builder, private_key, algorithm):</font>
<font color="black"> 303.         &quot;&quot;&quot;</font>
<font color="black"> 304.         Create and sign an X.509 CertificateRevocationList from a</font>
<font color="black"> 305.         CertificateRevocationListBuilder object.</font>
<font color="black"> 306.         &quot;&quot;&quot;</font>
<font color="black"> 307. </font>
<font color="green"> 308.     @abc.abstractmethod</font>
<font color="black"> 309.     def create_x509_revoked_certificate(self, builder):</font>
<font color="black"> 310.         &quot;&quot;&quot;</font>
<font color="black"> 311.         Create a RevokedCertificate object from a RevokedCertificateBuilder</font>
<font color="black"> 312.         object.</font>
<font color="black"> 313.         &quot;&quot;&quot;</font>
<font color="black"> 314. </font>
<font color="green"> 315.     @abc.abstractmethod</font>
<font color="black"> 316.     def x509_name_bytes(self, name):</font>
<font color="black"> 317.         &quot;&quot;&quot;</font>
<font color="black"> 318.         Compute the DER encoded bytes of an X509 Name object.</font>
<font color="black"> 319.         &quot;&quot;&quot;</font>
<font color="black"> 320. </font>
<font color="black"> 321. </font>
<font color="green"> 322. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green"> 323. class DHBackend(object):</font>
<font color="green"> 324.     @abc.abstractmethod</font>
<font color="black"> 325.     def generate_dh_parameters(self, generator, key_size):</font>
<font color="black"> 326.         &quot;&quot;&quot;</font>
<font color="black"> 327.         Generate a DHParameters instance with a modulus of key_size bits.</font>
<font color="black"> 328.         Using the given generator. Often 2 or 5.</font>
<font color="black"> 329.         &quot;&quot;&quot;</font>
<font color="black"> 330. </font>
<font color="green"> 331.     @abc.abstractmethod</font>
<font color="black"> 332.     def generate_dh_private_key(self, parameters):</font>
<font color="black"> 333.         &quot;&quot;&quot;</font>
<font color="black"> 334.         Generate a DHPrivateKey instance with parameters as a DHParameters</font>
<font color="black"> 335.         object.</font>
<font color="black"> 336.         &quot;&quot;&quot;</font>
<font color="black"> 337. </font>
<font color="green"> 338.     @abc.abstractmethod</font>
<font color="black"> 339.     def generate_dh_private_key_and_parameters(self, generator, key_size):</font>
<font color="black"> 340.         &quot;&quot;&quot;</font>
<font color="black"> 341.         Generate a DHPrivateKey instance using key size only.</font>
<font color="black"> 342.         Using the given generator. Often 2 or 5.</font>
<font color="black"> 343.         &quot;&quot;&quot;</font>
<font color="black"> 344. </font>
<font color="green"> 345.     @abc.abstractmethod</font>
<font color="black"> 346.     def load_dh_private_numbers(self, numbers):</font>
<font color="black"> 347.         &quot;&quot;&quot;</font>
<font color="black"> 348.         Load a DHPrivateKey from DHPrivateNumbers</font>
<font color="black"> 349.         &quot;&quot;&quot;</font>
<font color="black"> 350. </font>
<font color="green"> 351.     @abc.abstractmethod</font>
<font color="black"> 352.     def load_dh_public_numbers(self, numbers):</font>
<font color="black"> 353.         &quot;&quot;&quot;</font>
<font color="black"> 354.         Load a DHPublicKey from DHPublicNumbers.</font>
<font color="black"> 355.         &quot;&quot;&quot;</font>
<font color="black"> 356. </font>
<font color="green"> 357.     @abc.abstractmethod</font>
<font color="black"> 358.     def load_dh_parameter_numbers(self, numbers):</font>
<font color="black"> 359.         &quot;&quot;&quot;</font>
<font color="black"> 360.         Load DHParameters from DHParameterNumbers.</font>
<font color="black"> 361.         &quot;&quot;&quot;</font>
<font color="black"> 362. </font>
<font color="green"> 363.     @abc.abstractmethod</font>
<font color="green"> 364.     def dh_parameters_supported(self, p, g, q=None):</font>
<font color="black"> 365.         &quot;&quot;&quot;</font>
<font color="black"> 366.         Returns whether the backend supports DH with these parameter values.</font>
<font color="black"> 367.         &quot;&quot;&quot;</font>
<font color="black"> 368. </font>
<font color="green"> 369.     @abc.abstractmethod</font>
<font color="black"> 370.     def dh_x942_serialization_supported(self):</font>
<font color="black"> 371.         &quot;&quot;&quot;</font>
<font color="black"> 372.         Returns True if the backend supports the serialization of DH objects</font>
<font color="black"> 373.         with subgroup order (q).</font>
<font color="black"> 374.         &quot;&quot;&quot;</font>
<font color="black"> 375. </font>
<font color="black"> 376. </font>
<font color="green"> 377. @six.add_metaclass(abc.ABCMeta)</font>
<font color="green"> 378. class ScryptBackend(object):</font>
<font color="green"> 379.     @abc.abstractmethod</font>
<font color="black"> 380.     def derive_scrypt(self, key_material, salt, length, n, r, p):</font>
<font color="black"> 381.         &quot;&quot;&quot;</font>
<font color="black"> 382.         Return bytes derived from provided Scrypt parameters.</font>
<font color="black"> 383.         &quot;&quot;&quot;</font>
</pre>

