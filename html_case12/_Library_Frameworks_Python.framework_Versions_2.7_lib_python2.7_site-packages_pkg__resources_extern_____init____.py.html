source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pkg_resources/extern/__init__.py</b><br>


file stats: <b>38 lines, 3 executed: 7.9% covered</b>
<pre>
<font color="red">   1. import sys</font>
<font color="black">   2. </font>
<font color="black">   3. </font>
<font color="red">   4. class VendorImporter:</font>
<font color="black">   5.     &quot;&quot;&quot;</font>
<font color="black">   6.     A PEP 302 meta path importer for finding optionally-vendored</font>
<font color="black">   7.     or otherwise naturally-installed packages from root_name.</font>
<font color="red">   8.     &quot;&quot;&quot;</font>
<font color="black">   9. </font>
<font color="red">  10.     def __init__(self, root_name, vendored_names=(), vendor_pkg=None):</font>
<font color="red">  11.         self.root_name = root_name</font>
<font color="red">  12.         self.vendored_names = set(vendored_names)</font>
<font color="red">  13.         self.vendor_pkg = vendor_pkg or root_name.replace('extern', '_vendor')</font>
<font color="black">  14. </font>
<font color="red">  15.     @property</font>
<font color="black">  16.     def search_path(self):</font>
<font color="black">  17.         &quot;&quot;&quot;</font>
<font color="black">  18.         Search first the vendor package then as a natural package.</font>
<font color="black">  19.         &quot;&quot;&quot;</font>
<font color="red">  20.         yield self.vendor_pkg + '.'</font>
<font color="red">  21.         yield ''</font>
<font color="black">  22. </font>
<font color="red">  23.     def find_module(self, fullname, path=None):</font>
<font color="black">  24.         &quot;&quot;&quot;</font>
<font color="black">  25.         Return self when fullname starts with root_name and the</font>
<font color="black">  26.         target module is one vendored through this importer.</font>
<font color="black">  27.         &quot;&quot;&quot;</font>
<font color="green">  28.         root, base, target = fullname.partition(self.root_name + '.')</font>
<font color="green">  29.         if root:</font>
<font color="green">  30.             return</font>
<font color="red">  31.         if not any(map(target.startswith, self.vendored_names)):</font>
<font color="red">  32.             return</font>
<font color="red">  33.         return self</font>
<font color="black">  34. </font>
<font color="red">  35.     def load_module(self, fullname):</font>
<font color="black">  36.         &quot;&quot;&quot;</font>
<font color="black">  37.         Iterate over the search path to locate and load fullname.</font>
<font color="black">  38.         &quot;&quot;&quot;</font>
<font color="red">  39.         root, base, target = fullname.partition(self.root_name + '.')</font>
<font color="red">  40.         for prefix in self.search_path:</font>
<font color="red">  41.             try:</font>
<font color="red">  42.                 extant = prefix + target</font>
<font color="red">  43.                 __import__(extant)</font>
<font color="red">  44.                 mod = sys.modules[extant]</font>
<font color="red">  45.                 sys.modules[fullname] = mod</font>
<font color="black">  46.                 # mysterious hack:</font>
<font color="black">  47.                 # Remove the reference to the extant package/module</font>
<font color="black">  48.                 # on later Python versions to cause relative imports</font>
<font color="black">  49.                 # in the vendor package to resolve the same modules</font>
<font color="black">  50.                 # as those going through this importer.</font>
<font color="red">  51.                 if sys.version_info &gt; (3, 3):</font>
<font color="red">  52.                     del sys.modules[extant]</font>
<font color="red">  53.                 return mod</font>
<font color="red">  54.             except ImportError:</font>
<font color="red">  55.                 pass</font>
<font color="black">  56.         else:</font>
<font color="red">  57.             raise ImportError(</font>
<font color="red">  58.                 &quot;The '{target}' package is required; &quot;</font>
<font color="black">  59.                 &quot;normally this is bundled with this package so if you get &quot;</font>
<font color="black">  60.                 &quot;this warning, consult the packager of your &quot;</font>
<font color="red">  61.                 &quot;distribution.&quot;.format(**locals())</font>
<font color="black">  62.             )</font>
<font color="black">  63. </font>
<font color="red">  64.     def install(self):</font>
<font color="black">  65.         &quot;&quot;&quot;</font>
<font color="black">  66.         Install this importer into sys.meta_path if not already present.</font>
<font color="black">  67.         &quot;&quot;&quot;</font>
<font color="red">  68.         if self not in sys.meta_path:</font>
<font color="red">  69.             sys.meta_path.append(self)</font>
<font color="black">  70. </font>
<font color="black">  71. </font>
<font color="red">  72. names = 'packaging', 'pyparsing', 'six', 'appdirs'</font>
<font color="red">  73. VendorImporter(__name__, names).install()</font>
</pre>

