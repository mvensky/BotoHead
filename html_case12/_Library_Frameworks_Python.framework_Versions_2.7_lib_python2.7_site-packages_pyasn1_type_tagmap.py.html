source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pyasn1/type/tagmap.py</b><br>


file stats: <b>57 lines, 12 executed: 21.1% covered</b>
<pre>
<font color="black">   1. #</font>
<font color="black">   2. # This file is part of pyasn1 software.</font>
<font color="black">   3. #</font>
<font color="black">   4. # Copyright (c) 2005-2017, Ilya Etingof &lt;etingof@gmail.com&gt;</font>
<font color="black">   5. # License: http://pyasn1.sf.net/license.html</font>
<font color="black">   6. #</font>
<font color="green">   7. from pyasn1 import error</font>
<font color="black">   8. </font>
<font color="green">   9. __all__ = ['TagMap']</font>
<font color="black">  10. </font>
<font color="black">  11. </font>
<font color="green">  12. class TagMap(object):</font>
<font color="black">  13.     # noinspection PyDefaultArgument</font>
<font color="green">  14.     def __init__(self, posMap={}, negMap={}, defType=None):</font>
<font color="red">  15.         self.__posMap = posMap.copy()</font>
<font color="red">  16.         self.__negMap = negMap.copy()</font>
<font color="red">  17.         self.__defType = defType</font>
<font color="black">  18. </font>
<font color="green">  19.     def __contains__(self, tagSet):</font>
<font color="red">  20.         return tagSet in self.__posMap or \</font>
<font color="red">  21.                self.__defType is not None and tagSet not in self.__negMap</font>
<font color="black">  22. </font>
<font color="green">  23.     def __getitem__(self, tagSet):</font>
<font color="red">  24.         if tagSet in self.__posMap:</font>
<font color="red">  25.             return self.__posMap[tagSet]</font>
<font color="red">  26.         elif tagSet in self.__negMap:</font>
<font color="red">  27.             raise error.PyAsn1Error('Key in negative map')</font>
<font color="red">  28.         elif self.__defType is not None:</font>
<font color="red">  29.             return self.__defType</font>
<font color="black">  30.         else:</font>
<font color="red">  31.             raise KeyError()</font>
<font color="black">  32. </font>
<font color="green">  33.     def __repr__(self):</font>
<font color="red">  34.         s = self.__class__.__name__ + '('</font>
<font color="red">  35.         if self.__posMap:</font>
<font color="red">  36.             s += 'posMap=%r, ' % (self.__posMap,)</font>
<font color="red">  37.         if self.__negMap:</font>
<font color="red">  38.             s += 'negMap=%r, ' % (self.__negMap,)</font>
<font color="red">  39.         if self.__defType is not None:</font>
<font color="red">  40.             s += 'defType=%r' % (self.__defType,)</font>
<font color="red">  41.         return s + ')'</font>
<font color="black">  42. </font>
<font color="green">  43.     def __str__(self):</font>
<font color="red">  44.         s = self.__class__.__name__ + ':\n'</font>
<font color="red">  45.         if self.__posMap:</font>
<font color="red">  46.             s += 'posMap:\n%s, ' % ',\n '.join([x.prettyPrintType() for x in self.__posMap.values()])</font>
<font color="red">  47.         if self.__negMap:</font>
<font color="red">  48.             s += 'negMap:\n%s, ' % ',\n '.join([x.prettyPrintType() for x in self.__negMap.values()])</font>
<font color="red">  49.         if self.__defType is not None:</font>
<font color="red">  50.             s += 'defType:\n%s, ' % self.__defType.prettyPrintType()</font>
<font color="red">  51.         return s</font>
<font color="black">  52. </font>
<font color="green">  53.     def clone(self, parentType, tagMap, uniq=False):</font>
<font color="red">  54.         if self.__defType is not None and tagMap.getDef() is not None:</font>
<font color="red">  55.             raise error.PyAsn1Error('Duplicate default value at %s' % (self,))</font>
<font color="red">  56.         if tagMap.getDef() is not None:</font>
<font color="red">  57.             defType = tagMap.getDef()</font>
<font color="black">  58.         else:</font>
<font color="red">  59.             defType = self.__defType</font>
<font color="black">  60. </font>
<font color="red">  61.         posMap = self.__posMap.copy()</font>
<font color="red">  62.         for k in tagMap.getPosMap():</font>
<font color="red">  63.             if uniq and k in posMap:</font>
<font color="red">  64.                 raise error.PyAsn1Error('Duplicate positive key %s' % (k,))</font>
<font color="red">  65.             posMap[k] = parentType</font>
<font color="black">  66. </font>
<font color="red">  67.         negMap = self.__negMap.copy()</font>
<font color="red">  68.         negMap.update(tagMap.getNegMap())</font>
<font color="black">  69. </font>
<font color="red">  70.         return self.__class__(</font>
<font color="red">  71.             posMap, negMap, defType,</font>
<font color="black">  72.         )</font>
<font color="black">  73. </font>
<font color="green">  74.     def getPosMap(self):</font>
<font color="red">  75.         return self.__posMap.copy()</font>
<font color="black">  76. </font>
<font color="green">  77.     def getNegMap(self):</font>
<font color="red">  78.         return self.__negMap.copy()</font>
<font color="black">  79. </font>
<font color="green">  80.     def getDef(self):</font>
<font color="red">  81.         return self.__defType</font>
</pre>

