source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/boto3/s3/inject.py</b><br>


file stats: <b>153 lines, 43 executed: 28.1% covered</b>
<pre>
<font color="black">   1. # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. from botocore.exceptions import ClientError</font>
<font color="black">  14. </font>
<font color="green">  15. from boto3.s3.transfer import create_transfer_manager</font>
<font color="green">  16. from boto3.s3.transfer import TransferConfig, S3Transfer</font>
<font color="green">  17. from boto3.s3.transfer import ProgressCallbackInvoker</font>
<font color="green">  18. from boto3 import utils</font>
<font color="black">  19. </font>
<font color="black">  20. </font>
<font color="green">  21. def inject_s3_transfer_methods(class_attributes, **kwargs):</font>
<font color="green">  22.     utils.inject_attribute(class_attributes, 'upload_file', upload_file)</font>
<font color="green">  23.     utils.inject_attribute(class_attributes, 'download_file', download_file)</font>
<font color="green">  24.     utils.inject_attribute(class_attributes, 'copy', copy)</font>
<font color="green">  25.     utils.inject_attribute(class_attributes, 'upload_fileobj', upload_fileobj)</font>
<font color="green">  26.     utils.inject_attribute(</font>
<font color="green">  27.         class_attributes, 'download_fileobj', download_fileobj)</font>
<font color="black">  28. </font>
<font color="black">  29. </font>
<font color="green">  30. def inject_bucket_methods(class_attributes, **kwargs):</font>
<font color="red">  31.     utils.inject_attribute(class_attributes, 'load', bucket_load)</font>
<font color="red">  32.     utils.inject_attribute(class_attributes, 'upload_file', bucket_upload_file)</font>
<font color="red">  33.     utils.inject_attribute(</font>
<font color="red">  34.         class_attributes, 'download_file', bucket_download_file)</font>
<font color="red">  35.     utils.inject_attribute(class_attributes, 'copy', bucket_copy)</font>
<font color="red">  36.     utils.inject_attribute(</font>
<font color="red">  37.         class_attributes, 'upload_fileobj', bucket_upload_fileobj)</font>
<font color="red">  38.     utils.inject_attribute(</font>
<font color="red">  39.         class_attributes, 'download_fileobj', bucket_download_fileobj)</font>
<font color="black">  40. </font>
<font color="black">  41. </font>
<font color="green">  42. def inject_object_methods(class_attributes, **kwargs):</font>
<font color="red">  43.     utils.inject_attribute(class_attributes, 'upload_file', object_upload_file)</font>
<font color="red">  44.     utils.inject_attribute(</font>
<font color="red">  45.         class_attributes, 'download_file', object_download_file)</font>
<font color="red">  46.     utils.inject_attribute(class_attributes, 'copy', object_copy)</font>
<font color="red">  47.     utils.inject_attribute(</font>
<font color="red">  48.         class_attributes, 'upload_fileobj', object_upload_fileobj)</font>
<font color="red">  49.     utils.inject_attribute(</font>
<font color="red">  50.         class_attributes, 'download_fileobj', object_download_fileobj)</font>
<font color="black">  51. </font>
<font color="black">  52. </font>
<font color="green">  53. def inject_object_summary_methods(class_attributes, **kwargs):</font>
<font color="red">  54.     utils.inject_attribute(class_attributes, 'load', object_summary_load)</font>
<font color="black">  55. </font>
<font color="black">  56. </font>
<font color="green">  57. def bucket_load(self, *args, **kwargs):</font>
<font color="black">  58.     &quot;&quot;&quot;</font>
<font color="black">  59.     Calls s3.Client.list_buckets() to update the attributes of the Bucket</font>
<font color="black">  60.     resource.</font>
<font color="black">  61.     &quot;&quot;&quot;</font>
<font color="black">  62.     # The docstring above is phrased this way to match what the autogenerated</font>
<font color="black">  63.     # docs produce.</font>
<font color="black">  64. </font>
<font color="black">  65.     # We can't actually get the bucket's attributes from a HeadBucket,</font>
<font color="black">  66.     # so we need to use a ListBuckets and search for our bucket.</font>
<font color="black">  67.     # However, we may fail if we lack permissions to ListBuckets</font>
<font color="black">  68.     # or the bucket is in another account. In which case, creation_date</font>
<font color="black">  69.     # will be None.</font>
<font color="red">  70.     self.meta.data = {}</font>
<font color="red">  71.     try:</font>
<font color="red">  72.         response = self.meta.client.list_buckets()</font>
<font color="red">  73.         for bucket_data in response['Buckets']:</font>
<font color="red">  74.             if bucket_data['Name'] == self.name:</font>
<font color="red">  75.                 self.meta.data = bucket_data</font>
<font color="red">  76.                 break</font>
<font color="red">  77.     except ClientError as e:</font>
<font color="red">  78.         if not e.response.get('Error', {}).get('Code') == 'AccessDenied':</font>
<font color="red">  79.             raise</font>
<font color="black">  80. </font>
<font color="green">  81. def object_summary_load(self, *args, **kwargs):</font>
<font color="black">  82.     &quot;&quot;&quot;</font>
<font color="black">  83.     Calls s3.Client.head_object to update the attributes of the ObjectSummary</font>
<font color="black">  84.     resource.</font>
<font color="black">  85.     &quot;&quot;&quot;</font>
<font color="red">  86.     response = self.meta.client.head_object(</font>
<font color="red">  87.         Bucket=self.bucket_name, Key=self.key)</font>
<font color="red">  88.     if 'ContentLength' in response:</font>
<font color="red">  89.         response['Size'] = response.pop('ContentLength')</font>
<font color="red">  90.     self.meta.data = response</font>
<font color="black">  91. </font>
<font color="black">  92. </font>
<font color="green">  93. def upload_file(self, Filename, Bucket, Key, ExtraArgs=None,</font>
<font color="green">  94.                 Callback=None, Config=None):</font>
<font color="black">  95.     &quot;&quot;&quot;Upload a file to an S3 object.</font>
<font color="black">  96. </font>
<font color="black">  97.     Usage::</font>
<font color="black">  98. </font>
<font color="black">  99.         import boto3</font>
<font color="black"> 100.         s3 = boto3.resource('s3')</font>
<font color="black"> 101.         s3.meta.client.upload_file('/tmp/hello.txt', 'mybucket', 'hello.txt')</font>
<font color="black"> 102. </font>
<font color="black"> 103.     Similar behavior as S3Transfer's upload_file() method,</font>
<font color="black"> 104.     except that parameters are capitalized. Detailed examples can be found at</font>
<font color="black"> 105.     :ref:`S3Transfer's Usage &lt;ref_s3transfer_usage&gt;`.</font>
<font color="black"> 106. </font>
<font color="black"> 107.     :type Filename: str</font>
<font color="black"> 108.     :param Filename: The path to the file to upload.</font>
<font color="black"> 109. </font>
<font color="black"> 110.     :type Bucket: str</font>
<font color="black"> 111.     :param Bucket: The name of the bucket to upload to.</font>
<font color="black"> 112. </font>
<font color="black"> 113.     :type Key: str</font>
<font color="black"> 114.     :param Key: The name of the key to upload to.</font>
<font color="black"> 115. </font>
<font color="black"> 116.     :type ExtraArgs: dict</font>
<font color="black"> 117.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 118.         client operation.</font>
<font color="black"> 119. </font>
<font color="black"> 120.     :type Callback: function</font>
<font color="black"> 121.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 122.         be periodically called during the upload.</font>
<font color="black"> 123. </font>
<font color="black"> 124.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 125.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 126.         transfer.</font>
<font color="black"> 127.     &quot;&quot;&quot;</font>
<font color="red"> 128.     with S3Transfer(self, Config) as transfer:</font>
<font color="red"> 129.         return transfer.upload_file(</font>
<font color="red"> 130.             filename=Filename, bucket=Bucket, key=Key,</font>
<font color="red"> 131.             extra_args=ExtraArgs, callback=Callback)</font>
<font color="black"> 132. </font>
<font color="black"> 133. </font>
<font color="green"> 134. def download_file(self, Bucket, Key, Filename, ExtraArgs=None,</font>
<font color="green"> 135.                   Callback=None, Config=None):</font>
<font color="black"> 136.     &quot;&quot;&quot;Download an S3 object to a file.</font>
<font color="black"> 137. </font>
<font color="black"> 138.     Usage::</font>
<font color="black"> 139. </font>
<font color="black"> 140.         import boto3</font>
<font color="black"> 141.         s3 = boto3.resource('s3')</font>
<font color="black"> 142.         s3.meta.client.download_file('mybucket', 'hello.txt', '/tmp/hello.txt')</font>
<font color="black"> 143. </font>
<font color="black"> 144.     Similar behavior as S3Transfer's download_file() method,</font>
<font color="black"> 145.     except that parameters are capitalized. Detailed examples can be found at</font>
<font color="black"> 146.     :ref:`S3Transfer's Usage &lt;ref_s3transfer_usage&gt;`.</font>
<font color="black"> 147. </font>
<font color="black"> 148.     :type Filename: str</font>
<font color="black"> 149.     :param Filename: The path to the file to download to.</font>
<font color="black"> 150. </font>
<font color="black"> 151.     :type Bucket: str</font>
<font color="black"> 152.     :param Bucket: The name of the bucket to download from.</font>
<font color="black"> 153. </font>
<font color="black"> 154.     :type Key: str</font>
<font color="black"> 155.     :param Key: The name of the key to download from.</font>
<font color="black"> 156. </font>
<font color="black"> 157.     :type ExtraArgs: dict</font>
<font color="black"> 158.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 159.         client operation.</font>
<font color="black"> 160. </font>
<font color="black"> 161.     :type Callback: function</font>
<font color="black"> 162.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 163.         be periodically called during the download.</font>
<font color="black"> 164. </font>
<font color="black"> 165.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 166.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 167.         transfer.</font>
<font color="black"> 168.     &quot;&quot;&quot;</font>
<font color="red"> 169.     with S3Transfer(self, Config) as transfer:</font>
<font color="red"> 170.         return transfer.download_file(</font>
<font color="red"> 171.             bucket=Bucket, key=Key, filename=Filename,</font>
<font color="red"> 172.             extra_args=ExtraArgs, callback=Callback)</font>
<font color="black"> 173. </font>
<font color="black"> 174. </font>
<font color="black"> 175. def bucket_upload_file(self, Filename, Key,</font>
<font color="green"> 176.                        ExtraArgs=None, Callback=None, Config=None):</font>
<font color="black"> 177.     &quot;&quot;&quot;Upload a file to an S3 object.</font>
<font color="black"> 178. </font>
<font color="black"> 179.     Usage::</font>
<font color="black"> 180. </font>
<font color="black"> 181.         import boto3</font>
<font color="black"> 182.         s3 = boto3.resource('s3')</font>
<font color="black"> 183.         s3.Bucket('mybucket').upload_file('/tmp/hello.txt', 'hello.txt')</font>
<font color="black"> 184. </font>
<font color="black"> 185.     Similar behavior as S3Transfer's upload_file() method,</font>
<font color="black"> 186.     except that parameters are capitalized. Detailed examples can be found at</font>
<font color="black"> 187.     :ref:`S3Transfer's Usage &lt;ref_s3transfer_usage&gt;`.</font>
<font color="black"> 188. </font>
<font color="black"> 189.     :type Filename: str</font>
<font color="black"> 190.     :param Filename: The path to the file to upload.</font>
<font color="black"> 191. </font>
<font color="black"> 192.     :type Key: str</font>
<font color="black"> 193.     :param Key: The name of the key to upload to.</font>
<font color="black"> 194. </font>
<font color="black"> 195.     :type ExtraArgs: dict</font>
<font color="black"> 196.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 197.         client operation.</font>
<font color="black"> 198. </font>
<font color="black"> 199.     :type Callback: function</font>
<font color="black"> 200.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 201.         be periodically called during the upload.</font>
<font color="black"> 202. </font>
<font color="black"> 203.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 204.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 205.         transfer.</font>
<font color="black"> 206.     &quot;&quot;&quot;</font>
<font color="red"> 207.     return self.meta.client.upload_file(</font>
<font color="red"> 208.         Filename=Filename, Bucket=self.name, Key=Key,</font>
<font color="red"> 209.         ExtraArgs=ExtraArgs, Callback=Callback, Config=Config)</font>
<font color="black"> 210. </font>
<font color="black"> 211. </font>
<font color="black"> 212. def bucket_download_file(self, Key, Filename,</font>
<font color="green"> 213.                          ExtraArgs=None, Callback=None, Config=None):</font>
<font color="black"> 214.     &quot;&quot;&quot;Download an S3 object to a file.</font>
<font color="black"> 215. </font>
<font color="black"> 216.     Usage::</font>
<font color="black"> 217. </font>
<font color="black"> 218.         import boto3</font>
<font color="black"> 219.         s3 = boto3.resource('s3')</font>
<font color="black"> 220.         s3.Bucket('mybucket').download_file('hello.txt', '/tmp/hello.txt')</font>
<font color="black"> 221. </font>
<font color="black"> 222.     Similar behavior as S3Transfer's download_file() method,</font>
<font color="black"> 223.     except that parameters are capitalized. Detailed examples can be found at</font>
<font color="black"> 224.     :ref:`S3Transfer's Usage &lt;ref_s3transfer_usage&gt;`.</font>
<font color="black"> 225. </font>
<font color="black"> 226.     :type Filename: str</font>
<font color="black"> 227.     :param Filename: The path to the file to download to.</font>
<font color="black"> 228. </font>
<font color="black"> 229.     :type Key: str</font>
<font color="black"> 230.     :param Key: The name of the key to download from.</font>
<font color="black"> 231. </font>
<font color="black"> 232.     :type ExtraArgs: dict</font>
<font color="black"> 233.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 234.         client operation.</font>
<font color="black"> 235. </font>
<font color="black"> 236.     :type Callback: function</font>
<font color="black"> 237.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 238.         be periodically called during the download.</font>
<font color="black"> 239. </font>
<font color="black"> 240.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 241.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 242.         transfer.</font>
<font color="black"> 243.     &quot;&quot;&quot;</font>
<font color="red"> 244.     return self.meta.client.download_file(</font>
<font color="red"> 245.         Bucket=self.name, Key=Key, Filename=Filename,</font>
<font color="red"> 246.         ExtraArgs=ExtraArgs, Callback=Callback, Config=Config)</font>
<font color="black"> 247. </font>
<font color="black"> 248. </font>
<font color="black"> 249. def object_upload_file(self, Filename,</font>
<font color="green"> 250.                        ExtraArgs=None, Callback=None, Config=None):</font>
<font color="black"> 251.     &quot;&quot;&quot;Upload a file to an S3 object.</font>
<font color="black"> 252. </font>
<font color="black"> 253.     Usage::</font>
<font color="black"> 254. </font>
<font color="black"> 255.         import boto3</font>
<font color="black"> 256.         s3 = boto3.resource('s3')</font>
<font color="black"> 257.         s3.Object('mybucket', 'hello.txt').upload_file('/tmp/hello.txt')</font>
<font color="black"> 258. </font>
<font color="black"> 259.     Similar behavior as S3Transfer's upload_file() method,</font>
<font color="black"> 260.     except that parameters are capitalized. Detailed examples can be found at</font>
<font color="black"> 261.     :ref:`S3Transfer's Usage &lt;ref_s3transfer_usage&gt;`.</font>
<font color="black"> 262. </font>
<font color="black"> 263.     :type Filename: str</font>
<font color="black"> 264.     :param Filename: The path to the file to upload.</font>
<font color="black"> 265. </font>
<font color="black"> 266.     :type ExtraArgs: dict</font>
<font color="black"> 267.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 268.         client operation.</font>
<font color="black"> 269. </font>
<font color="black"> 270.     :type Callback: function</font>
<font color="black"> 271.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 272.         be periodically called during the upload.</font>
<font color="black"> 273. </font>
<font color="black"> 274.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 275.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 276.         transfer.</font>
<font color="black"> 277.     &quot;&quot;&quot;</font>
<font color="red"> 278.     return self.meta.client.upload_file(</font>
<font color="red"> 279.         Filename=Filename, Bucket=self.bucket_name, Key=self.key,</font>
<font color="red"> 280.         ExtraArgs=ExtraArgs, Callback=Callback, Config=Config)</font>
<font color="black"> 281. </font>
<font color="black"> 282. </font>
<font color="black"> 283. def object_download_file(self, Filename,</font>
<font color="green"> 284.                          ExtraArgs=None, Callback=None, Config=None):</font>
<font color="black"> 285.     &quot;&quot;&quot;Download an S3 object to a file.</font>
<font color="black"> 286. </font>
<font color="black"> 287.     Usage::</font>
<font color="black"> 288. </font>
<font color="black"> 289.         import boto3</font>
<font color="black"> 290.         s3 = boto3.resource('s3')</font>
<font color="black"> 291.         s3.Object('mybucket', 'hello.txt').download_file('/tmp/hello.txt')</font>
<font color="black"> 292. </font>
<font color="black"> 293.     Similar behavior as S3Transfer's download_file() method,</font>
<font color="black"> 294.     except that parameters are capitalized. Detailed examples can be found at</font>
<font color="black"> 295.     :ref:`S3Transfer's Usage &lt;ref_s3transfer_usage&gt;`.</font>
<font color="black"> 296. </font>
<font color="black"> 297.     :type Filename: str</font>
<font color="black"> 298.     :param Filename: The path to the file to download to.</font>
<font color="black"> 299. </font>
<font color="black"> 300.     :type ExtraArgs: dict</font>
<font color="black"> 301.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 302.         client operation.</font>
<font color="black"> 303. </font>
<font color="black"> 304.     :type Callback: function</font>
<font color="black"> 305.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 306.         be periodically called during the download.</font>
<font color="black"> 307. </font>
<font color="black"> 308.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 309.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 310.         transfer.</font>
<font color="black"> 311.     &quot;&quot;&quot;</font>
<font color="red"> 312.     return self.meta.client.download_file(</font>
<font color="red"> 313.         Bucket=self.bucket_name, Key=self.key, Filename=Filename,</font>
<font color="red"> 314.         ExtraArgs=ExtraArgs, Callback=Callback, Config=Config)</font>
<font color="black"> 315. </font>
<font color="black"> 316. </font>
<font color="green"> 317. def copy(self, CopySource, Bucket, Key, ExtraArgs=None, Callback=None,</font>
<font color="green"> 318.          SourceClient=None, Config=None):</font>
<font color="black"> 319.     &quot;&quot;&quot;Copy an object from one S3 location to another.</font>
<font color="black"> 320. </font>
<font color="black"> 321.     This is a managed transfer which will perform a multipart copy in</font>
<font color="black"> 322.     multiple threads if necessary.</font>
<font color="black"> 323. </font>
<font color="black"> 324.     Usage::</font>
<font color="black"> 325. </font>
<font color="black"> 326.         import boto3</font>
<font color="black"> 327.         s3 = boto3.resource('s3')</font>
<font color="black"> 328.         copy_source = {</font>
<font color="black"> 329.             'Bucket': 'mybucket',</font>
<font color="black"> 330.             'Key': 'mykey'</font>
<font color="black"> 331.         }</font>
<font color="black"> 332.         s3.meta.client.copy(copy_source, 'otherbucket', 'otherkey')</font>
<font color="black"> 333. </font>
<font color="black"> 334.     :type CopySource: dict</font>
<font color="black"> 335.     :param CopySource: The name of the source bucket, key name of the</font>
<font color="black"> 336.         source object, and optional version ID of the source object. The</font>
<font color="black"> 337.         dictionary format is:</font>
<font color="black"> 338.         ``{'Bucket': 'bucket', 'Key': 'key', 'VersionId': 'id'}``. Note</font>
<font color="black"> 339.         that the ``VersionId`` key is optional and may be omitted.</font>
<font color="black"> 340. </font>
<font color="black"> 341.     :type Bucket: str</font>
<font color="black"> 342.     :param Bucket: The name of the bucket to copy to</font>
<font color="black"> 343. </font>
<font color="black"> 344.     :type Key: str</font>
<font color="black"> 345.     :param Key: The name of the key to copy to</font>
<font color="black"> 346. </font>
<font color="black"> 347.     :type ExtraArgs: dict</font>
<font color="black"> 348.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 349.         client operation</font>
<font color="black"> 350. </font>
<font color="black"> 351.     :type Callback: function</font>
<font color="black"> 352.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 353.         be periodically called during the copy.</font>
<font color="black"> 354. </font>
<font color="black"> 355.     :type SourceClient: botocore or boto3 Client</font>
<font color="black"> 356.     :param SourceClient: The client to be used for operation that</font>
<font color="black"> 357.         may happen at the source object. For example, this client is</font>
<font color="black"> 358.         used for the head_object that determines the size of the copy.</font>
<font color="black"> 359.         If no client is provided, the current client is used as the client</font>
<font color="black"> 360.         for the source object.</font>
<font color="black"> 361. </font>
<font color="black"> 362.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 363.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 364.         copy.</font>
<font color="black"> 365.     &quot;&quot;&quot;</font>
<font color="red"> 366.     subscribers = None</font>
<font color="red"> 367.     if Callback is not None:</font>
<font color="red"> 368.         subscribers = [ProgressCallbackInvoker(Callback)]</font>
<font color="black"> 369. </font>
<font color="red"> 370.     config = Config</font>
<font color="red"> 371.     if config is None:</font>
<font color="red"> 372.         config = TransferConfig()</font>
<font color="black"> 373. </font>
<font color="red"> 374.     with create_transfer_manager(self, config) as manager:</font>
<font color="red"> 375.         future = manager.copy(</font>
<font color="red"> 376.             copy_source=CopySource, bucket=Bucket, key=Key,</font>
<font color="red"> 377.             extra_args=ExtraArgs, subscribers=subscribers,</font>
<font color="red"> 378.             source_client=SourceClient)</font>
<font color="red"> 379.         return future.result()</font>
<font color="black"> 380. </font>
<font color="black"> 381. </font>
<font color="green"> 382. def bucket_copy(self, CopySource, Key, ExtraArgs=None, Callback=None,</font>
<font color="green"> 383.                 SourceClient=None, Config=None):</font>
<font color="black"> 384.     &quot;&quot;&quot;Copy an object from one S3 location to an object in this bucket.</font>
<font color="black"> 385. </font>
<font color="black"> 386.     This is a managed transfer which will perform a multipart copy in</font>
<font color="black"> 387.     multiple threads if necessary.</font>
<font color="black"> 388. </font>
<font color="black"> 389.     Usage::</font>
<font color="black"> 390. </font>
<font color="black"> 391.         import boto3</font>
<font color="black"> 392.         s3 = boto3.resource('s3')</font>
<font color="black"> 393.         copy_source = {</font>
<font color="black"> 394.             'Bucket': 'mybucket',</font>
<font color="black"> 395.             'Key': 'mykey'</font>
<font color="black"> 396.         }</font>
<font color="black"> 397.         bucket = s3.Bucket('otherbucket')</font>
<font color="black"> 398.         bucket.copy(copy_source, 'otherkey')</font>
<font color="black"> 399. </font>
<font color="black"> 400.     :type CopySource: dict</font>
<font color="black"> 401.     :param CopySource: The name of the source bucket, key name of the</font>
<font color="black"> 402.         source object, and optional version ID of the source object. The</font>
<font color="black"> 403.         dictionary format is:</font>
<font color="black"> 404.         ``{'Bucket': 'bucket', 'Key': 'key', 'VersionId': 'id'}``. Note</font>
<font color="black"> 405.         that the ``VersionId`` key is optional and may be omitted.</font>
<font color="black"> 406. </font>
<font color="black"> 407.     :type Key: str</font>
<font color="black"> 408.     :param Key: The name of the key to copy to</font>
<font color="black"> 409. </font>
<font color="black"> 410.     :type ExtraArgs: dict</font>
<font color="black"> 411.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 412.         client operation</font>
<font color="black"> 413. </font>
<font color="black"> 414.     :type Callback: function</font>
<font color="black"> 415.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 416.         be periodically called during the copy.</font>
<font color="black"> 417. </font>
<font color="black"> 418.     :type SourceClient: botocore or boto3 Client</font>
<font color="black"> 419.     :param SourceClient: The client to be used for operation that</font>
<font color="black"> 420.         may happen at the source object. For example, this client is</font>
<font color="black"> 421.         used for the head_object that determines the size of the copy.</font>
<font color="black"> 422.         If no client is provided, the current client is used as the client</font>
<font color="black"> 423.         for the source object.</font>
<font color="black"> 424. </font>
<font color="black"> 425.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 426.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 427.         copy.</font>
<font color="black"> 428.     &quot;&quot;&quot;</font>
<font color="red"> 429.     return self.meta.client.copy(</font>
<font color="red"> 430.         CopySource=CopySource, Bucket=self.name, Key=Key, ExtraArgs=ExtraArgs,</font>
<font color="red"> 431.         Callback=Callback, SourceClient=SourceClient, Config=Config)</font>
<font color="black"> 432. </font>
<font color="black"> 433. </font>
<font color="green"> 434. def object_copy(self, CopySource, ExtraArgs=None, Callback=None,</font>
<font color="green"> 435.                 SourceClient=None, Config=None):</font>
<font color="black"> 436.     &quot;&quot;&quot;Copy an object from one S3 location to this object.</font>
<font color="black"> 437. </font>
<font color="black"> 438.     This is a managed transfer which will perform a multipart copy in</font>
<font color="black"> 439.     multiple threads if necessary.</font>
<font color="black"> 440. </font>
<font color="black"> 441.     Usage::</font>
<font color="black"> 442. </font>
<font color="black"> 443.         import boto3</font>
<font color="black"> 444.         s3 = boto3.resource('s3')</font>
<font color="black"> 445.         copy_source = {</font>
<font color="black"> 446.             'Bucket': 'mybucket',</font>
<font color="black"> 447.             'Key': 'mykey'</font>
<font color="black"> 448.         }</font>
<font color="black"> 449.         bucket = s3.Bucket('otherbucket')</font>
<font color="black"> 450.         obj = bucket.Object('otherkey')</font>
<font color="black"> 451.         obj.copy(copy_source)</font>
<font color="black"> 452. </font>
<font color="black"> 453.     :type CopySource: dict</font>
<font color="black"> 454.     :param CopySource: The name of the source bucket, key name of the</font>
<font color="black"> 455.         source object, and optional version ID of the source object. The</font>
<font color="black"> 456.         dictionary format is:</font>
<font color="black"> 457.         ``{'Bucket': 'bucket', 'Key': 'key', 'VersionId': 'id'}``. Note</font>
<font color="black"> 458.         that the ``VersionId`` key is optional and may be omitted.</font>
<font color="black"> 459. </font>
<font color="black"> 460.     :type ExtraArgs: dict</font>
<font color="black"> 461.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 462.         client operation</font>
<font color="black"> 463. </font>
<font color="black"> 464.     :type Callback: function</font>
<font color="black"> 465.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 466.         be periodically called during the copy.</font>
<font color="black"> 467. </font>
<font color="black"> 468.     :type SourceClient: botocore or boto3 Client</font>
<font color="black"> 469.     :param SourceClient: The client to be used for operation that</font>
<font color="black"> 470.         may happen at the source object. For example, this client is</font>
<font color="black"> 471.         used for the head_object that determines the size of the copy.</font>
<font color="black"> 472.         If no client is provided, the current client is used as the client</font>
<font color="black"> 473.         for the source object.</font>
<font color="black"> 474. </font>
<font color="black"> 475.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 476.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 477.         copy.</font>
<font color="black"> 478.     &quot;&quot;&quot;</font>
<font color="red"> 479.     return self.meta.client.copy(</font>
<font color="red"> 480.         CopySource=CopySource, Bucket=self.bucket_name, Key=self.key,</font>
<font color="red"> 481.         ExtraArgs=ExtraArgs, Callback=Callback, SourceClient=SourceClient,</font>
<font color="red"> 482.         Config=Config)</font>
<font color="black"> 483. </font>
<font color="black"> 484. </font>
<font color="green"> 485. def upload_fileobj(self, Fileobj, Bucket, Key, ExtraArgs=None,</font>
<font color="green"> 486.                    Callback=None, Config=None):</font>
<font color="black"> 487.     &quot;&quot;&quot;Upload a file-like object to S3.</font>
<font color="black"> 488. </font>
<font color="black"> 489.     The file-like object must be in binary mode.</font>
<font color="black"> 490. </font>
<font color="black"> 491.     This is a managed transfer which will perform a multipart upload in</font>
<font color="black"> 492.     multiple threads if necessary.</font>
<font color="black"> 493. </font>
<font color="black"> 494.     Usage::</font>
<font color="black"> 495. </font>
<font color="black"> 496.         import boto3</font>
<font color="black"> 497.         s3 = boto3.client('s3')</font>
<font color="black"> 498. </font>
<font color="black"> 499.         with open('filename', 'rb') as data:</font>
<font color="black"> 500.             s3.upload_fileobj(data, 'mybucket', 'mykey')</font>
<font color="black"> 501. </font>
<font color="black"> 502.     :type Fileobj: a file-like object</font>
<font color="black"> 503.     :param Fileobj: A file-like object to upload. At a minimum, it must</font>
<font color="black"> 504.         implement the `read` method, and must return bytes.</font>
<font color="black"> 505. </font>
<font color="black"> 506.     :type Bucket: str</font>
<font color="black"> 507.     :param Bucket: The name of the bucket to upload to.</font>
<font color="black"> 508. </font>
<font color="black"> 509.     :type Key: str</font>
<font color="black"> 510.     :param Key: The name of the key to upload to.</font>
<font color="black"> 511. </font>
<font color="black"> 512.     :type ExtraArgs: dict</font>
<font color="black"> 513.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 514.         client operation.</font>
<font color="black"> 515. </font>
<font color="black"> 516.     :type Callback: function</font>
<font color="black"> 517.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 518.         be periodically called during the upload.</font>
<font color="black"> 519. </font>
<font color="black"> 520.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 521.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 522.         upload.</font>
<font color="black"> 523.     &quot;&quot;&quot;</font>
<font color="red"> 524.     if not hasattr(Fileobj, 'read'):</font>
<font color="red"> 525.         raise ValueError('Fileobj must implement read')</font>
<font color="black"> 526. </font>
<font color="red"> 527.     subscribers = None</font>
<font color="red"> 528.     if Callback is not None:</font>
<font color="red"> 529.         subscribers = [ProgressCallbackInvoker(Callback)]</font>
<font color="black"> 530. </font>
<font color="red"> 531.     config = Config</font>
<font color="red"> 532.     if config is None:</font>
<font color="red"> 533.         config = TransferConfig()</font>
<font color="black"> 534. </font>
<font color="red"> 535.     with create_transfer_manager(self, config) as manager:</font>
<font color="red"> 536.         future = manager.upload(</font>
<font color="red"> 537.             fileobj=Fileobj, bucket=Bucket, key=Key,</font>
<font color="red"> 538.             extra_args=ExtraArgs, subscribers=subscribers)</font>
<font color="red"> 539.         return future.result()</font>
<font color="black"> 540. </font>
<font color="black"> 541. </font>
<font color="green"> 542. def bucket_upload_fileobj(self, Fileobj, Key, ExtraArgs=None,</font>
<font color="green"> 543.                           Callback=None, Config=None):</font>
<font color="black"> 544.     &quot;&quot;&quot;Upload a file-like object to this bucket.</font>
<font color="black"> 545. </font>
<font color="black"> 546.     The file-like object must be in binary mode.</font>
<font color="black"> 547. </font>
<font color="black"> 548.     This is a managed transfer which will perform a multipart upload in</font>
<font color="black"> 549.     multiple threads if necessary.</font>
<font color="black"> 550. </font>
<font color="black"> 551.     Usage::</font>
<font color="black"> 552. </font>
<font color="black"> 553.         import boto3</font>
<font color="black"> 554.         s3 = boto3.resource('s3')</font>
<font color="black"> 555.         bucket = s3.Bucket('mybucket')</font>
<font color="black"> 556. </font>
<font color="black"> 557.         with open('filename', 'rb') as data:</font>
<font color="black"> 558.             bucket.upload_fileobj(data, 'mykey')</font>
<font color="black"> 559. </font>
<font color="black"> 560.     :type Fileobj: a file-like object</font>
<font color="black"> 561.     :param Fileobj: A file-like object to upload. At a minimum, it must</font>
<font color="black"> 562.         implement the `read` method, and must return bytes.</font>
<font color="black"> 563. </font>
<font color="black"> 564.     :type Key: str</font>
<font color="black"> 565.     :param Key: The name of the key to upload to.</font>
<font color="black"> 566. </font>
<font color="black"> 567.     :type ExtraArgs: dict</font>
<font color="black"> 568.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 569.         client operation.</font>
<font color="black"> 570. </font>
<font color="black"> 571.     :type Callback: function</font>
<font color="black"> 572.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 573.         be periodically called during the upload.</font>
<font color="black"> 574. </font>
<font color="black"> 575.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 576.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 577.         upload.</font>
<font color="black"> 578.     &quot;&quot;&quot;</font>
<font color="red"> 579.     return self.meta.client.upload_fileobj(</font>
<font color="red"> 580.         Fileobj=Fileobj, Bucket=self.name, Key=Key, ExtraArgs=ExtraArgs,</font>
<font color="red"> 581.         Callback=Callback, Config=Config)</font>
<font color="black"> 582. </font>
<font color="black"> 583. </font>
<font color="green"> 584. def object_upload_fileobj(self, Fileobj, ExtraArgs=None, Callback=None,</font>
<font color="green"> 585.                           Config=None):</font>
<font color="black"> 586.     &quot;&quot;&quot;Upload a file-like object to this object.</font>
<font color="black"> 587. </font>
<font color="black"> 588.     The file-like object must be in binary mode.</font>
<font color="black"> 589. </font>
<font color="black"> 590.     This is a managed transfer which will perform a multipart upload in</font>
<font color="black"> 591.     multiple threads if necessary.</font>
<font color="black"> 592. </font>
<font color="black"> 593.     Usage::</font>
<font color="black"> 594. </font>
<font color="black"> 595.         import boto3</font>
<font color="black"> 596.         s3 = boto3.resource('s3')</font>
<font color="black"> 597.         bucket = s3.Bucket('mybucket')</font>
<font color="black"> 598.         obj = bucket.Object('mykey')</font>
<font color="black"> 599. </font>
<font color="black"> 600.         with open('filename', 'rb') as data:</font>
<font color="black"> 601.             obj.upload_fileobj(data)</font>
<font color="black"> 602. </font>
<font color="black"> 603.     :type Fileobj: a file-like object</font>
<font color="black"> 604.     :param Fileobj: A file-like object to upload. At a minimum, it must</font>
<font color="black"> 605.         implement the `read` method, and must return bytes.</font>
<font color="black"> 606. </font>
<font color="black"> 607.     :type ExtraArgs: dict</font>
<font color="black"> 608.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 609.         client operation.</font>
<font color="black"> 610. </font>
<font color="black"> 611.     :type Callback: function</font>
<font color="black"> 612.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 613.         be periodically called during the upload.</font>
<font color="black"> 614. </font>
<font color="black"> 615.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 616.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 617.         upload.</font>
<font color="black"> 618.     &quot;&quot;&quot;</font>
<font color="red"> 619.     return self.meta.client.upload_fileobj(</font>
<font color="red"> 620.         Fileobj=Fileobj, Bucket=self.bucket_name, Key=self.key,</font>
<font color="red"> 621.         ExtraArgs=ExtraArgs, Callback=Callback, Config=Config)</font>
<font color="black"> 622. </font>
<font color="black"> 623. </font>
<font color="green"> 624. def download_fileobj(self, Bucket, Key, Fileobj, ExtraArgs=None,</font>
<font color="green"> 625.                      Callback=None, Config=None):</font>
<font color="black"> 626.     &quot;&quot;&quot;Download an object from S3 to a file-like object.</font>
<font color="black"> 627. </font>
<font color="black"> 628.     The file-like object must be in binary mode.</font>
<font color="black"> 629. </font>
<font color="black"> 630.     This is a managed transfer which will perform a multipart download in</font>
<font color="black"> 631.     multiple threads if necessary.</font>
<font color="black"> 632. </font>
<font color="black"> 633.     Usage::</font>
<font color="black"> 634. </font>
<font color="black"> 635.         import boto3</font>
<font color="black"> 636.         s3 = boto3.client('s3')</font>
<font color="black"> 637. </font>
<font color="black"> 638.         with open('filename', 'wb') as data:</font>
<font color="black"> 639.             s3.download_fileobj('mybucket', 'mykey', data)</font>
<font color="black"> 640. </font>
<font color="black"> 641.     :type Fileobj: a file-like object</font>
<font color="black"> 642.     :param Fileobj: A file-like object to download into. At a minimum, it must</font>
<font color="black"> 643.         implement the `write` method and must accept bytes.</font>
<font color="black"> 644. </font>
<font color="black"> 645.     :type Bucket: str</font>
<font color="black"> 646.     :param Bucket: The name of the bucket to download from.</font>
<font color="black"> 647. </font>
<font color="black"> 648.     :type Key: str</font>
<font color="black"> 649.     :param Key: The name of the key to download from.</font>
<font color="black"> 650. </font>
<font color="black"> 651.     :type ExtraArgs: dict</font>
<font color="black"> 652.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 653.         client operation.</font>
<font color="black"> 654. </font>
<font color="black"> 655.     :type Callback: function</font>
<font color="black"> 656.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 657.         be periodically called during the download.</font>
<font color="black"> 658. </font>
<font color="black"> 659.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 660.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 661.         download.</font>
<font color="black"> 662.     &quot;&quot;&quot;</font>
<font color="red"> 663.     if not hasattr(Fileobj, 'write'):</font>
<font color="red"> 664.         raise ValueError('Fileobj must implement write')</font>
<font color="black"> 665. </font>
<font color="red"> 666.     subscribers = None</font>
<font color="red"> 667.     if Callback is not None:</font>
<font color="red"> 668.         subscribers = [ProgressCallbackInvoker(Callback)]</font>
<font color="black"> 669. </font>
<font color="red"> 670.     config = Config</font>
<font color="red"> 671.     if config is None:</font>
<font color="red"> 672.         config = TransferConfig()</font>
<font color="black"> 673. </font>
<font color="red"> 674.     with create_transfer_manager(self, config) as manager:</font>
<font color="red"> 675.         future = manager.download(</font>
<font color="red"> 676.             bucket=Bucket, key=Key, fileobj=Fileobj,</font>
<font color="red"> 677.             extra_args=ExtraArgs, subscribers=subscribers)</font>
<font color="red"> 678.         return future.result()</font>
<font color="black"> 679. </font>
<font color="black"> 680. </font>
<font color="green"> 681. def bucket_download_fileobj(self, Key, Fileobj, ExtraArgs=None,</font>
<font color="green"> 682.                             Callback=None, Config=None):</font>
<font color="black"> 683.     &quot;&quot;&quot;Download an object from this bucket to a file-like-object.</font>
<font color="black"> 684. </font>
<font color="black"> 685.     The file-like object must be in binary mode.</font>
<font color="black"> 686. </font>
<font color="black"> 687.     This is a managed transfer which will perform a multipart download in</font>
<font color="black"> 688.     multiple threads if necessary.</font>
<font color="black"> 689. </font>
<font color="black"> 690.     Usage::</font>
<font color="black"> 691. </font>
<font color="black"> 692.         import boto3</font>
<font color="black"> 693.         s3 = boto3.resource('s3')</font>
<font color="black"> 694.         bucket = s3.Bucket('mybucket')</font>
<font color="black"> 695. </font>
<font color="black"> 696.         with open('filename', 'wb') as data:</font>
<font color="black"> 697.             bucket.download_fileobj('mykey', data)</font>
<font color="black"> 698. </font>
<font color="black"> 699.     :type Fileobj: a file-like object</font>
<font color="black"> 700.     :param Fileobj: A file-like object to download into. At a minimum, it must</font>
<font color="black"> 701.         implement the `write` method and must accept bytes.</font>
<font color="black"> 702. </font>
<font color="black"> 703.     :type Key: str</font>
<font color="black"> 704.     :param Key: The name of the key to download from.</font>
<font color="black"> 705. </font>
<font color="black"> 706.     :type ExtraArgs: dict</font>
<font color="black"> 707.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 708.         client operation.</font>
<font color="black"> 709. </font>
<font color="black"> 710.     :type Callback: function</font>
<font color="black"> 711.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 712.         be periodically called during the download.</font>
<font color="black"> 713. </font>
<font color="black"> 714.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 715.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 716.         download.</font>
<font color="black"> 717.     &quot;&quot;&quot;</font>
<font color="red"> 718.     return self.meta.client.download_fileobj(</font>
<font color="red"> 719.         Bucket=self.name, Key=Key, Fileobj=Fileobj, ExtraArgs=ExtraArgs,</font>
<font color="red"> 720.         Callback=Callback, Config=Config)</font>
<font color="black"> 721. </font>
<font color="black"> 722. </font>
<font color="green"> 723. def object_download_fileobj(self, Fileobj, ExtraArgs=None, Callback=None,</font>
<font color="green"> 724.                             Config=None):</font>
<font color="black"> 725.     &quot;&quot;&quot;Download this object from S3 to a file-like object.</font>
<font color="black"> 726. </font>
<font color="black"> 727.     The file-like object must be in binary mode.</font>
<font color="black"> 728. </font>
<font color="black"> 729.     This is a managed transfer which will perform a multipart download in</font>
<font color="black"> 730.     multiple threads if necessary.</font>
<font color="black"> 731. </font>
<font color="black"> 732.     Usage::</font>
<font color="black"> 733. </font>
<font color="black"> 734.         import boto3</font>
<font color="black"> 735.         s3 = boto3.resource('s3')</font>
<font color="black"> 736.         bucket = s3.Bucket('mybucket')</font>
<font color="black"> 737.         obj = bucket.Object('mykey')</font>
<font color="black"> 738. </font>
<font color="black"> 739.         with open('filename', 'wb') as data:</font>
<font color="black"> 740.             obj.download_fileobj(data)</font>
<font color="black"> 741. </font>
<font color="black"> 742.     :type Fileobj: a file-like object</font>
<font color="black"> 743.     :param Fileobj: A file-like object to download into. At a minimum, it must</font>
<font color="black"> 744.         implement the `write` method and must accept bytes.</font>
<font color="black"> 745. </font>
<font color="black"> 746.     :type ExtraArgs: dict</font>
<font color="black"> 747.     :param ExtraArgs: Extra arguments that may be passed to the</font>
<font color="black"> 748.         client operation.</font>
<font color="black"> 749. </font>
<font color="black"> 750.     :type Callback: function</font>
<font color="black"> 751.     :param Callback: A method which takes a number of bytes transferred to</font>
<font color="black"> 752.         be periodically called during the download.</font>
<font color="black"> 753. </font>
<font color="black"> 754.     :type Config: boto3.s3.transfer.TransferConfig</font>
<font color="black"> 755.     :param Config: The transfer configuration to be used when performing the</font>
<font color="black"> 756.         download.</font>
<font color="black"> 757.     &quot;&quot;&quot;</font>
<font color="red"> 758.     return self.meta.client.download_fileobj(</font>
<font color="red"> 759.         Bucket=self.bucket_name, Key=self.key, Fileobj=Fileobj,</font>
<font color="red"> 760.         ExtraArgs=ExtraArgs, Callback=Callback, Config=Config)</font>
<font color="black"> 761. </font>
</pre>

