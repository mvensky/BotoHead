source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pyasn1/type/char.py</b><br>


file stats: <b>140 lines, 82 executed: 58.6% covered</b>
<pre>
<font color="black">   1. #</font>
<font color="black">   2. # This file is part of pyasn1 software.</font>
<font color="black">   3. #</font>
<font color="black">   4. # Copyright (c) 2005-2017, Ilya Etingof &lt;etingof@gmail.com&gt;</font>
<font color="black">   5. # License: http://pyasn1.sf.net/license.html</font>
<font color="black">   6. #</font>
<font color="green">   7. import sys</font>
<font color="green">   8. from pyasn1.type import univ, tag</font>
<font color="green">   9. from pyasn1 import error</font>
<font color="black">  10. </font>
<font color="black">  11. </font>
<font color="green">  12. __all__ = ['NumericString', 'PrintableString', 'TeletexString', 'T61String', 'VideotexString',</font>
<font color="green">  13.            'IA5String', 'GraphicString', 'VisibleString', 'ISO646String',</font>
<font color="green">  14.            'GeneralString', 'UniversalString', 'BMPString', 'UTF8String']</font>
<font color="black">  15. </font>
<font color="green">  16. NoValue = univ.NoValue</font>
<font color="green">  17. noValue = univ.noValue</font>
<font color="black">  18. </font>
<font color="black">  19. </font>
<font color="green">  20. class AbstractCharacterString(univ.OctetString):</font>
<font color="black">  21.     &quot;&quot;&quot;Creates |ASN.1| type or object.</font>
<font color="black">  22. </font>
<font color="black">  23.     |ASN.1| objects are immutable and duck-type Python 2 :class:`unicode` or Python 3 :class:`str`.</font>
<font color="black">  24.     When used in octet-stream context, |ASN.1| type assumes &quot;|encoding|&quot; encoding.</font>
<font color="black">  25. </font>
<font color="black">  26.     Parameters</font>
<font color="black">  27.     ----------</font>
<font color="black">  28.     value: :class:`unicode`, :class:`str`, :class:`bytes` or |ASN.1| object</font>
<font color="black">  29.         unicode object (Python 2) or string (Python 3), alternatively string</font>
<font color="black">  30.         (Python 2) or bytes (Python 3) representing octet-stream of serialized</font>
<font color="black">  31.         unicode string (note `encoding` parameter) or |ASN.1| class instance.</font>
<font color="black">  32. </font>
<font color="black">  33.     tagSet: :py:class:`~pyasn1.type.tag.TagSet`</font>
<font color="black">  34.         Object representing non-default ASN.1 tag(s)</font>
<font color="black">  35. </font>
<font color="black">  36.     subtypeSpec: :py:class:`~pyasn1.type.constraint.ConstraintsIntersection`</font>
<font color="black">  37.         Object representing non-default ASN.1 subtype constraint(s)</font>
<font color="black">  38. </font>
<font color="black">  39.     encoding: :py:class:`str`</font>
<font color="black">  40.         Unicode codec ID to encode/decode :class:`unicode` (Python 2) or</font>
<font color="black">  41.         :class:`str` (Python 3) the payload when |ASN.1| object is used</font>
<font color="black">  42.         in octet-stream context.</font>
<font color="black">  43. </font>
<font color="black">  44.     Raises</font>
<font color="black">  45.     ------</font>
<font color="black">  46.     : :py:class:`pyasn1.error.PyAsn1Error`</font>
<font color="black">  47.         On constraint violation or bad initializer.</font>
<font color="green">  48.     &quot;&quot;&quot;</font>
<font color="black">  49. </font>
<font color="green">  50.     if sys.version_info[0] &lt;= 2:</font>
<font color="green">  51.         def __str__(self):</font>
<font color="red">  52.             try:</font>
<font color="red">  53.                 return self._value.encode(self._encoding)</font>
<font color="red">  54.             except UnicodeEncodeError:</font>
<font color="red">  55.                 raise error.PyAsn1Error(</font>
<font color="red">  56.                     'Can\'t encode string \'%s\' with \'%s\' codec' % (self._value, self._encoding)</font>
<font color="black">  57.                 )</font>
<font color="black">  58. </font>
<font color="green">  59.         def __unicode__(self):</font>
<font color="red">  60.             return unicode(self._value)</font>
<font color="black">  61. </font>
<font color="green">  62.         def prettyIn(self, value):</font>
<font color="red">  63.             if isinstance(value, unicode):</font>
<font color="red">  64.                 return value</font>
<font color="red">  65.             elif isinstance(value, str):</font>
<font color="red">  66.                 try:</font>
<font color="red">  67.                     return value.decode(self._encoding)</font>
<font color="red">  68.                 except (LookupError, UnicodeDecodeError):</font>
<font color="red">  69.                     raise error.PyAsn1Error(</font>
<font color="red">  70.                         'Can\'t decode string \'%s\' with \'%s\' codec' % (value, self._encoding)</font>
<font color="black">  71.                     )</font>
<font color="red">  72.             elif isinstance(value, (tuple, list)):</font>
<font color="red">  73.                 try:</font>
<font color="red">  74.                     return self.prettyIn(''.join([chr(x) for x in value]))</font>
<font color="red">  75.                 except ValueError:</font>
<font color="red">  76.                     raise error.PyAsn1Error(</font>
<font color="red">  77.                         'Bad %s initializer \'%s\'' % (self.__class__.__name__, value)</font>
<font color="black">  78.                     )</font>
<font color="black">  79.             else:</font>
<font color="red">  80.                 try:</font>
<font color="red">  81.                     return unicode(value)</font>
<font color="red">  82.                 except UnicodeDecodeError:</font>
<font color="red">  83.                     raise error.PyAsn1Error(</font>
<font color="red">  84.                         'Can\'t turn object \'%s\' into unicode' % (value,)</font>
<font color="black">  85.                     )</font>
<font color="black">  86. </font>
<font color="green">  87.         def asOctets(self, padding=True):</font>
<font color="red">  88.             return str(self)</font>
<font color="black">  89. </font>
<font color="green">  90.         def asNumbers(self, padding=True):</font>
<font color="red">  91.             return tuple([ord(x) for x in str(self)])</font>
<font color="black">  92. </font>
<font color="black">  93.     else:</font>
<font color="red">  94.         def __str__(self):</font>
<font color="red">  95.             return str(self._value)</font>
<font color="black">  96. </font>
<font color="red">  97.         def __bytes__(self):</font>
<font color="red">  98.             try:</font>
<font color="red">  99.                 return self._value.encode(self._encoding)</font>
<font color="red"> 100.             except UnicodeEncodeError:</font>
<font color="red"> 101.                 raise error.PyAsn1Error(</font>
<font color="red"> 102.                     'Can\'t encode string \'%s\' with \'%s\' codec' % (self._value, self._encoding)</font>
<font color="black"> 103.                 )</font>
<font color="black"> 104. </font>
<font color="red"> 105.         def prettyIn(self, value):</font>
<font color="red"> 106.             if isinstance(value, str):</font>
<font color="red"> 107.                 return value</font>
<font color="red"> 108.             elif isinstance(value, bytes):</font>
<font color="red"> 109.                 try:</font>
<font color="red"> 110.                     return value.decode(self._encoding)</font>
<font color="red"> 111.                 except UnicodeDecodeError:</font>
<font color="red"> 112.                     raise error.PyAsn1Error(</font>
<font color="red"> 113.                         'Can\'t decode string \'%s\' with \'%s\' codec' % (value, self._encoding)</font>
<font color="black"> 114.                     )</font>
<font color="red"> 115.             elif isinstance(value, (tuple, list)):</font>
<font color="red"> 116.                 return self.prettyIn(bytes(value))</font>
<font color="black"> 117.             else:</font>
<font color="red"> 118.                 try:</font>
<font color="red"> 119.                     return str(value)</font>
<font color="red"> 120.                 except (UnicodeDecodeError, ValueError):</font>
<font color="red"> 121.                     raise error.PyAsn1Error(</font>
<font color="red"> 122.                         'Can\'t turn object \'%s\' into unicode' % (value,)</font>
<font color="black"> 123.                     )</font>
<font color="black"> 124. </font>
<font color="red"> 125.         def asOctets(self, padding=True):</font>
<font color="red"> 126.             return bytes(self)</font>
<font color="black"> 127. </font>
<font color="red"> 128.         def asNumbers(self, padding=True):</font>
<font color="red"> 129.             return tuple(bytes(self))</font>
<font color="black"> 130. </font>
<font color="green"> 131.     def prettyOut(self, value):</font>
<font color="red"> 132.         return value</font>
<font color="black"> 133. </font>
<font color="green"> 134.     def __reversed__(self):</font>
<font color="red"> 135.         return reversed(self._value)</font>
<font color="black"> 136. </font>
<font color="green"> 137.     def clone(self, value=noValue, tagSet=None, subtypeSpec=None,</font>
<font color="green"> 138.               encoding=None, binValue=noValue, hexValue=noValue):</font>
<font color="black"> 139.         &quot;&quot;&quot;Creates a copy of a |ASN.1| type or object.</font>
<font color="black"> 140. </font>
<font color="black"> 141.         Any parameters to the *clone()* method will replace corresponding</font>
<font color="black"> 142.         properties of the |ASN.1| object.</font>
<font color="black"> 143. </font>
<font color="black"> 144.         Parameters</font>
<font color="black"> 145.         ----------</font>
<font color="black"> 146.         value: :class:`unicode`, :class:`str`, :class:`bytes` or |ASN.1| object</font>
<font color="black"> 147.             unicode object (Python 2) or string (Python 3), alternatively string</font>
<font color="black"> 148.             (Python 2) or bytes (Python 3) representing octet-stream of serialized</font>
<font color="black"> 149.             unicode string (note `encoding` parameter) or |ASN.1| class instance.</font>
<font color="black"> 150. </font>
<font color="black"> 151.         tagSet: :py:class:`~pyasn1.type.tag.TagSet`</font>
<font color="black"> 152.             Object representing non-default ASN.1 tag(s)</font>
<font color="black"> 153. </font>
<font color="black"> 154.         subtypeSpec: :py:class:`~pyasn1.type.constraint.ConstraintsIntersection`</font>
<font color="black"> 155.             Object representing non-default ASN.1 subtype constraint(s)</font>
<font color="black"> 156. </font>
<font color="black"> 157.         encoding: :py:class:`str`</font>
<font color="black"> 158.             Unicode codec ID to encode/decode :py:class:`unicode` (Python 2) or</font>
<font color="black"> 159.             :py:class:`str` (Python 3) the payload when |ASN.1| object is used</font>
<font color="black"> 160.             in octet-stream context.</font>
<font color="black"> 161. </font>
<font color="black"> 162.         Returns</font>
<font color="black"> 163.         -------</font>
<font color="black"> 164.         :</font>
<font color="black"> 165.             new instance of |ASN.1| type/value</font>
<font color="black"> 166. </font>
<font color="black"> 167.         &quot;&quot;&quot;</font>
<font color="red"> 168.         return univ.OctetString.clone(self, value, tagSet, subtypeSpec, encoding, binValue, hexValue)</font>
<font color="black"> 169. </font>
<font color="green"> 170.     def subtype(self, value=noValue, implicitTag=None, explicitTag=None,</font>
<font color="green"> 171.                 subtypeSpec=None, encoding=None, binValue=noValue, hexValue=noValue):</font>
<font color="black"> 172.         &quot;&quot;&quot;Creates a copy of a |ASN.1| type or object.</font>
<font color="black"> 173. </font>
<font color="black"> 174.         Any parameters to the *subtype()* method will be added to the corresponding</font>
<font color="black"> 175.         properties of the |ASN.1| object.</font>
<font color="black"> 176. </font>
<font color="black"> 177.         Parameters</font>
<font color="black"> 178.         ----------</font>
<font color="black"> 179.         value: :class:`unicode`, :class:`str`, :class:`bytes` or |ASN.1| object</font>
<font color="black"> 180.             unicode object (Python 2) or string (Python 3), alternatively string</font>
<font color="black"> 181.             (Python 2) or bytes (Python 3) representing octet-stream of serialized</font>
<font color="black"> 182.             unicode string (note `encoding` parameter) or |ASN.1| class instance.</font>
<font color="black"> 183. </font>
<font color="black"> 184.         implicitTag: :py:class:`~pyasn1.type.tag.Tag`</font>
<font color="black"> 185.             Implicitly apply given ASN.1 tag object to caller's</font>
<font color="black"> 186.             :py:class:`~pyasn1.type.tag.TagSet`, then use the result as</font>
<font color="black"> 187.             new object's ASN.1 tag(s).</font>
<font color="black"> 188. </font>
<font color="black"> 189.         explicitTag: :py:class:`~pyasn1.type.tag.Tag`</font>
<font color="black"> 190.             Explicitly apply given ASN.1 tag object to caller's</font>
<font color="black"> 191.             :py:class:`~pyasn1.type.tag.TagSet`, then use the result as</font>
<font color="black"> 192.             new object's ASN.1 tag(s).</font>
<font color="black"> 193. </font>
<font color="black"> 194.         subtypeSpec: :py:class:`~pyasn1.type.constraint.ConstraintsIntersection`</font>
<font color="black"> 195.             Object representing non-default ASN.1 subtype constraint(s)</font>
<font color="black"> 196. </font>
<font color="black"> 197.         encoding: :py:class:`str`</font>
<font color="black"> 198.             Unicode codec ID to encode/decode :py:class:`unicode` (Python 2) or</font>
<font color="black"> 199.             :py:class:`str` (Python 3) the payload when |ASN.1| object is used</font>
<font color="black"> 200.             in octet-stream context.</font>
<font color="black"> 201. </font>
<font color="black"> 202.         Returns</font>
<font color="black"> 203.         -------</font>
<font color="black"> 204.         :</font>
<font color="black"> 205.             new instance of |ASN.1| type/value</font>
<font color="black"> 206. </font>
<font color="black"> 207.         &quot;&quot;&quot;</font>
<font color="green"> 208.         return univ.OctetString.subtype(self, value, implicitTag, explicitTag, subtypeSpec, encoding, binValue, hexValue)</font>
<font color="black"> 209. </font>
<font color="black"> 210. </font>
<font color="green"> 211. class NumericString(AbstractCharacterString):</font>
<font color="green"> 212.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 213. </font>
<font color="black"> 214.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 215.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 216.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 18)</font>
<font color="black"> 217.     )</font>
<font color="green"> 218.     encoding = 'us-ascii'</font>
<font color="black"> 219. </font>
<font color="black"> 220. </font>
<font color="green"> 221. class PrintableString(AbstractCharacterString):</font>
<font color="green"> 222.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 223. </font>
<font color="black"> 224.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 225.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 226.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 19)</font>
<font color="black"> 227.     )</font>
<font color="green"> 228.     encoding = 'us-ascii'</font>
<font color="black"> 229. </font>
<font color="black"> 230. </font>
<font color="green"> 231. class TeletexString(AbstractCharacterString):</font>
<font color="green"> 232.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 233. </font>
<font color="black"> 234.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 235.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 236.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 20)</font>
<font color="black"> 237.     )</font>
<font color="green"> 238.     encoding = 'iso-8859-1'</font>
<font color="black"> 239. </font>
<font color="black"> 240. </font>
<font color="green"> 241. class T61String(TeletexString):</font>
<font color="green"> 242.     __doc__ = TeletexString.__doc__</font>
<font color="black"> 243. </font>
<font color="black"> 244. </font>
<font color="green"> 245. class VideotexString(AbstractCharacterString):</font>
<font color="green"> 246.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 247. </font>
<font color="black"> 248.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 249.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 250.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 21)</font>
<font color="black"> 251.     )</font>
<font color="green"> 252.     encoding = 'iso-8859-1'</font>
<font color="black"> 253. </font>
<font color="black"> 254. </font>
<font color="green"> 255. class IA5String(AbstractCharacterString):</font>
<font color="green"> 256.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 257. </font>
<font color="black"> 258.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 259.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 260.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 22)</font>
<font color="black"> 261.     )</font>
<font color="green"> 262.     encoding = 'us-ascii'</font>
<font color="black"> 263. </font>
<font color="black"> 264. </font>
<font color="green"> 265. class GraphicString(AbstractCharacterString):</font>
<font color="green"> 266.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 267. </font>
<font color="black"> 268.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 269.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 270.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 25)</font>
<font color="black"> 271.     )</font>
<font color="green"> 272.     encoding = 'iso-8859-1'</font>
<font color="black"> 273. </font>
<font color="black"> 274. </font>
<font color="green"> 275. class VisibleString(AbstractCharacterString):</font>
<font color="green"> 276.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 277. </font>
<font color="black"> 278.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 279.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 280.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 26)</font>
<font color="black"> 281.     )</font>
<font color="green"> 282.     encoding = 'us-ascii'</font>
<font color="black"> 283. </font>
<font color="black"> 284. </font>
<font color="green"> 285. class ISO646String(VisibleString):</font>
<font color="green"> 286.     __doc__ = VisibleString.__doc__</font>
<font color="black"> 287. </font>
<font color="black"> 288. </font>
<font color="green"> 289. class GeneralString(AbstractCharacterString):</font>
<font color="green"> 290.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 291. </font>
<font color="black"> 292.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 293.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 294.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 27)</font>
<font color="black"> 295.     )</font>
<font color="green"> 296.     encoding = 'iso-8859-1'</font>
<font color="black"> 297. </font>
<font color="black"> 298. </font>
<font color="green"> 299. class UniversalString(AbstractCharacterString):</font>
<font color="green"> 300.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 301. </font>
<font color="black"> 302.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 303.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 304.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 28)</font>
<font color="black"> 305.     )</font>
<font color="green"> 306.     encoding = &quot;utf-32-be&quot;</font>
<font color="black"> 307. </font>
<font color="black"> 308. </font>
<font color="green"> 309. class BMPString(AbstractCharacterString):</font>
<font color="green"> 310.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 311. </font>
<font color="black"> 312.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 313.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 314.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 30)</font>
<font color="black"> 315.     )</font>
<font color="green"> 316.     encoding = &quot;utf-16-be&quot;</font>
<font color="black"> 317. </font>
<font color="black"> 318. </font>
<font color="green"> 319. class UTF8String(AbstractCharacterString):</font>
<font color="green"> 320.     __doc__ = AbstractCharacterString.__doc__</font>
<font color="black"> 321. </font>
<font color="black"> 322.     #: Default :py:class:`~pyasn1.type.tag.TagSet` object for |ASN.1| objects</font>
<font color="green"> 323.     tagSet = AbstractCharacterString.tagSet.tagImplicitly(</font>
<font color="green"> 324.         tag.Tag(tag.tagClassUniversal, tag.tagFormatSimple, 12)</font>
<font color="black"> 325.     )</font>
<font color="green"> 326.     encoding = &quot;utf-8&quot;</font>
</pre>

