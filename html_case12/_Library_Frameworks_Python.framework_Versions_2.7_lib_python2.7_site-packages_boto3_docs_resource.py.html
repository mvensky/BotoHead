source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/boto3/docs/resource.py</b><br>


file stats: <b>202 lines, 35 executed: 17.3% covered</b>
<pre>
<font color="black">   1. # Copyright 2015 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. from botocore import xform_name</font>
<font color="green">  14. from botocore.docs.utils import get_official_service_name</font>
<font color="black">  15. </font>
<font color="green">  16. from boto3.docs.base import BaseDocumenter</font>
<font color="green">  17. from boto3.docs.action import ActionDocumenter</font>
<font color="green">  18. from boto3.docs.waiter import WaiterResourceDocumenter</font>
<font color="green">  19. from boto3.docs.collection import CollectionDocumenter</font>
<font color="green">  20. from boto3.docs.subresource import SubResourceDocumenter</font>
<font color="green">  21. from boto3.docs.attr import document_attribute</font>
<font color="green">  22. from boto3.docs.attr import document_identifier</font>
<font color="green">  23. from boto3.docs.attr import document_reference</font>
<font color="green">  24. from boto3.docs.utils import get_identifier_args_for_signature</font>
<font color="green">  25. from boto3.docs.utils import get_identifier_values_for_example</font>
<font color="green">  26. from boto3.docs.utils import get_identifier_description</font>
<font color="green">  27. from boto3.docs.utils import add_resource_type_overview</font>
<font color="black">  28. </font>
<font color="black">  29. </font>
<font color="green">  30. class ResourceDocumenter(BaseDocumenter):</font>
<font color="green">  31.     def __init__(self, resource, botocore_session):</font>
<font color="red">  32.         super(ResourceDocumenter, self).__init__(resource)</font>
<font color="red">  33.         self._botocore_session = botocore_session</font>
<font color="black">  34. </font>
<font color="green">  35.     def document_resource(self, section):</font>
<font color="red">  36.         self._add_title(section)</font>
<font color="red">  37.         self._add_intro(section)</font>
<font color="red">  38.         overview_section = section.add_new_section('member-overview')</font>
<font color="red">  39.         self._add_identifiers(section)</font>
<font color="red">  40.         self._add_attributes(section)</font>
<font color="red">  41.         self._add_references(section)</font>
<font color="red">  42.         self._add_actions(section)</font>
<font color="red">  43.         self._add_sub_resources(section)</font>
<font color="red">  44.         self._add_collections(section)</font>
<font color="red">  45.         self._add_waiters(section)</font>
<font color="red">  46.         self._add_overview_of_members(overview_section)</font>
<font color="black">  47. </font>
<font color="green">  48.     def _add_title(self, section):</font>
<font color="red">  49.         section.style.h2(self._resource_name)</font>
<font color="black">  50. </font>
<font color="green">  51.     def _add_intro(self, section):</font>
<font color="red">  52.         identifier_names = []</font>
<font color="red">  53.         if self._resource_model.identifiers:</font>
<font color="red">  54.             for identifier in self._resource_model.identifiers:</font>
<font color="red">  55.                 identifier_names.append(identifier.name)</font>
<font color="black">  56. </font>
<font color="black">  57.         # Write out the class signature.</font>
<font color="red">  58.         class_args = get_identifier_args_for_signature(identifier_names)</font>
<font color="red">  59.         section.style.start_sphinx_py_class(</font>
<font color="red">  60.             class_name='%s(%s)' % (self.class_name, class_args))</font>
<font color="black">  61. </font>
<font color="black">  62.         # Add as short description about the resource</font>
<font color="red">  63.         description_section = section.add_new_section('description')</font>
<font color="red">  64.         self._add_description(description_section)</font>
<font color="black">  65. </font>
<font color="black">  66.         # Add an example of how to instantiate the resource</font>
<font color="red">  67.         example_section = section.add_new_section('example')</font>
<font color="red">  68.         self._add_example(example_section, identifier_names)</font>
<font color="black">  69. </font>
<font color="black">  70.         # Add the description for the parameters to instantiate the</font>
<font color="black">  71.         # resource.</font>
<font color="red">  72.         param_section = section.add_new_section('params')</font>
<font color="red">  73.         self._add_params_description(param_section, identifier_names)</font>
<font color="black">  74. </font>
<font color="green">  75.     def _add_description(self, section):</font>
<font color="red">  76.         official_service_name = get_official_service_name(</font>
<font color="red">  77.             self._service_model)</font>
<font color="red">  78.         section.write(</font>
<font color="red">  79.             'A resource representing an %s %s' % (</font>
<font color="red">  80.                 official_service_name, self._resource_name))</font>
<font color="black">  81. </font>
<font color="green">  82.     def _add_example(self, section, identifier_names):</font>
<font color="red">  83.         section.style.start_codeblock()</font>
<font color="red">  84.         section.style.new_line()</font>
<font color="red">  85.         section.write('import boto3')</font>
<font color="red">  86.         section.style.new_line()</font>
<font color="red">  87.         section.style.new_line()</font>
<font color="red">  88.         section.write(</font>
<font color="red">  89.             '%s = boto3.resource(\'%s\')' % (</font>
<font color="red">  90.                 self._service_name, self._service_name)</font>
<font color="black">  91.         )</font>
<font color="red">  92.         section.style.new_line()</font>
<font color="red">  93.         example_values = get_identifier_values_for_example(identifier_names)</font>
<font color="red">  94.         section.write(</font>
<font color="red">  95.             '%s = %s.%s(%s)' % (</font>
<font color="red">  96.                 xform_name(self._resource_name), self._service_name,</font>
<font color="red">  97.                 self._resource_name, example_values))</font>
<font color="red">  98.         section.style.end_codeblock()</font>
<font color="black">  99. </font>
<font color="green"> 100.     def _add_params_description(self, section, identifier_names):</font>
<font color="red"> 101.         for identifier_name in identifier_names:</font>
<font color="red"> 102.             description = get_identifier_description(</font>
<font color="red"> 103.                 self._resource_name, identifier_name)</font>
<font color="red"> 104.             section.write(':type %s: string' % identifier_name)</font>
<font color="red"> 105.             section.style.new_line()</font>
<font color="red"> 106.             section.write(':param %s: %s' % (</font>
<font color="red"> 107.                 identifier_name, description))</font>
<font color="red"> 108.             section.style.new_line()</font>
<font color="black"> 109. </font>
<font color="green"> 110.     def _add_overview_of_members(self, section):</font>
<font color="red"> 111.         for resource_member_type in self.member_map:</font>
<font color="red"> 112.             section.style.new_line()</font>
<font color="red"> 113.             section.write('These are the resource\'s available %s:' % (</font>
<font color="red"> 114.                 resource_member_type))</font>
<font color="red"> 115.             section.style.new_line()</font>
<font color="red"> 116.             for member in self.member_map[resource_member_type]:</font>
<font color="red"> 117.                 if resource_member_type in ['identifiers', 'attributes',</font>
<font color="red"> 118.                                             'references', 'collections']:</font>
<font color="red"> 119.                     section.style.li(':py:attr:`%s`' % member)</font>
<font color="black"> 120.                 else:</font>
<font color="red"> 121.                     section.style.li(':py:meth:`%s()`' % member)</font>
<font color="black"> 122. </font>
<font color="green"> 123.     def _add_identifiers(self, section):</font>
<font color="red"> 124.         identifiers = self._resource.meta.resource_model.identifiers</font>
<font color="red"> 125.         section = section.add_new_section('identifiers')</font>
<font color="red"> 126.         member_list = []</font>
<font color="red"> 127.         if identifiers:</font>
<font color="red"> 128.             self.member_map['identifiers'] = member_list</font>
<font color="red"> 129.             add_resource_type_overview(</font>
<font color="red"> 130.                 section=section,</font>
<font color="red"> 131.                 resource_type='Identifiers',</font>
<font color="black"> 132.                 description=(</font>
<font color="red"> 133.                     'Identifiers are properties of a resource that are '</font>
<font color="black"> 134.                     'set upon instantation of the resource.'),</font>
<font color="red"> 135.                 intro_link='identifiers_attributes_intro')</font>
<font color="red"> 136.         for identifier in identifiers:</font>
<font color="red"> 137.             identifier_section = section.add_new_section(identifier.name)</font>
<font color="red"> 138.             member_list.append(identifier.name)</font>
<font color="red"> 139.             document_identifier(</font>
<font color="red"> 140.                 section=identifier_section,</font>
<font color="red"> 141.                 resource_name=self._resource_name,</font>
<font color="red"> 142.                 identifier_model=identifier</font>
<font color="black"> 143.             )</font>
<font color="black"> 144. </font>
<font color="green"> 145.     def _add_attributes(self, section):</font>
<font color="red"> 146.         service_model = self._resource.meta.client.meta.service_model</font>
<font color="red"> 147.         attributes = {}</font>
<font color="red"> 148.         if self._resource.meta.resource_model.shape:</font>
<font color="red"> 149.             shape = service_model.shape_for(</font>
<font color="red"> 150.                 self._resource.meta.resource_model.shape)</font>
<font color="red"> 151.             attributes = self._resource.meta.resource_model.get_attributes(</font>
<font color="red"> 152.                 shape)</font>
<font color="red"> 153.         section = section.add_new_section('attributes')</font>
<font color="red"> 154.         attribute_list = []</font>
<font color="red"> 155.         if attributes:</font>
<font color="red"> 156.             add_resource_type_overview(</font>
<font color="red"> 157.                 section=section,</font>
<font color="red"> 158.                 resource_type='Attributes',</font>
<font color="black"> 159.                 description=(</font>
<font color="red"> 160.                     'Attributes provide access'</font>
<font color="black"> 161.                     ' to the properties of a resource. Attributes are lazy-'</font>
<font color="black"> 162.                     'loaded the first time one is accessed via the'</font>
<font color="black"> 163.                     ' :py:meth:`load` method.'),</font>
<font color="red"> 164.                 intro_link='identifiers_attributes_intro')</font>
<font color="red"> 165.             self.member_map['attributes'] = attribute_list</font>
<font color="red"> 166.         for attr_name in sorted(attributes):</font>
<font color="red"> 167.             _, attr_shape = attributes[attr_name]</font>
<font color="red"> 168.             attribute_section = section.add_new_section(attr_name)</font>
<font color="red"> 169.             attribute_list.append(attr_name)</font>
<font color="red"> 170.             document_attribute(</font>
<font color="red"> 171.                 section=attribute_section,</font>
<font color="red"> 172.                 service_name=self._service_name,</font>
<font color="red"> 173.                 resource_name=self._resource_name,</font>
<font color="red"> 174.                 attr_name=attr_name,</font>
<font color="red"> 175.                 event_emitter=self._resource.meta.client.meta.events,</font>
<font color="red"> 176.                 attr_model=attr_shape</font>
<font color="black"> 177.             )</font>
<font color="black"> 178. </font>
<font color="green"> 179.     def _add_references(self, section):</font>
<font color="red"> 180.         section = section.add_new_section('references')</font>
<font color="red"> 181.         references = self._resource.meta.resource_model.references</font>
<font color="red"> 182.         reference_list = []</font>
<font color="red"> 183.         if references:</font>
<font color="red"> 184.             add_resource_type_overview(</font>
<font color="red"> 185.                 section=section,</font>
<font color="red"> 186.                 resource_type='References',</font>
<font color="black"> 187.                 description=(</font>
<font color="red"> 188.                     'References are related resource instances that have '</font>
<font color="black"> 189.                     'a belongs-to relationship.'),</font>
<font color="red"> 190.                 intro_link='references_intro')</font>
<font color="red"> 191.             self.member_map['references'] = reference_list</font>
<font color="red"> 192.         for reference in references:</font>
<font color="red"> 193.             reference_section = section.add_new_section(reference.name)</font>
<font color="red"> 194.             reference_list.append(reference.name)</font>
<font color="red"> 195.             document_reference(</font>
<font color="red"> 196.                 section=reference_section,</font>
<font color="red"> 197.                 reference_model=reference</font>
<font color="black"> 198.             )</font>
<font color="black"> 199. </font>
<font color="green"> 200.     def _add_actions(self, section):</font>
<font color="red"> 201.         section = section.add_new_section('actions')</font>
<font color="red"> 202.         actions = self._resource.meta.resource_model.actions</font>
<font color="red"> 203.         if actions:</font>
<font color="red"> 204.             documenter = ActionDocumenter(self._resource)</font>
<font color="red"> 205.             documenter.member_map = self.member_map</font>
<font color="red"> 206.             documenter.document_actions(section)</font>
<font color="black"> 207. </font>
<font color="green"> 208.     def _add_sub_resources(self, section):</font>
<font color="red"> 209.         section = section.add_new_section('sub-resources')</font>
<font color="red"> 210.         sub_resources = self._resource.meta.resource_model.subresources</font>
<font color="red"> 211.         if sub_resources:</font>
<font color="red"> 212.             documenter = SubResourceDocumenter(self._resource)</font>
<font color="red"> 213.             documenter.member_map = self.member_map</font>
<font color="red"> 214.             documenter.document_sub_resources(section)</font>
<font color="black"> 215. </font>
<font color="green"> 216.     def _add_collections(self, section):</font>
<font color="red"> 217.         section = section.add_new_section('collections')</font>
<font color="red"> 218.         collections = self._resource.meta.resource_model.collections</font>
<font color="red"> 219.         if collections:</font>
<font color="red"> 220.             documenter = CollectionDocumenter(self._resource)</font>
<font color="red"> 221.             documenter.member_map = self.member_map</font>
<font color="red"> 222.             documenter.document_collections(section)</font>
<font color="black"> 223. </font>
<font color="green"> 224.     def _add_waiters(self, section):</font>
<font color="red"> 225.         section = section.add_new_section('waiters')</font>
<font color="red"> 226.         waiters = self._resource.meta.resource_model.waiters</font>
<font color="red"> 227.         if waiters:</font>
<font color="red"> 228.             service_waiter_model = self._botocore_session.get_waiter_model(</font>
<font color="red"> 229.                 self._service_name)</font>
<font color="red"> 230.             documenter = WaiterResourceDocumenter(</font>
<font color="red"> 231.                 self._resource, service_waiter_model)</font>
<font color="red"> 232.             documenter.member_map = self.member_map</font>
<font color="red"> 233.             documenter.document_resource_waiters(section)</font>
<font color="black"> 234. </font>
<font color="black"> 235. </font>
<font color="green"> 236. class ServiceResourceDocumenter(ResourceDocumenter):</font>
<font color="green"> 237.     @property</font>
<font color="black"> 238.     def class_name(self):</font>
<font color="red"> 239.         return '%s.ServiceResource' % self._service_docs_name</font>
<font color="black"> 240. </font>
<font color="green"> 241.     def _add_title(self, section):</font>
<font color="red"> 242.         section.style.h2('Service Resource')</font>
<font color="black"> 243. </font>
<font color="green"> 244.     def _add_description(self, section):</font>
<font color="red"> 245.         official_service_name = get_official_service_name(</font>
<font color="red"> 246.             self._service_model)</font>
<font color="red"> 247.         section.write(</font>
<font color="red"> 248.             'A resource representing %s' % official_service_name)</font>
<font color="black"> 249. </font>
<font color="green"> 250.     def _add_example(self, section, identifier_names):</font>
<font color="red"> 251.         section.style.start_codeblock()</font>
<font color="red"> 252.         section.style.new_line()</font>
<font color="red"> 253.         section.write('import boto3')</font>
<font color="red"> 254.         section.style.new_line()</font>
<font color="red"> 255.         section.style.new_line()</font>
<font color="red"> 256.         section.write(</font>
<font color="red"> 257.             '%s = boto3.resource(\'%s\')' % (</font>
<font color="red"> 258.                 self._service_name, self._service_name))</font>
<font color="red"> 259.         section.style.end_codeblock()</font>
</pre>

