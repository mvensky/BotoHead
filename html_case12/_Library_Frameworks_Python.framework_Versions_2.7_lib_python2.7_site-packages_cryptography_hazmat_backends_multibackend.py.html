source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/cryptography/hazmat/backends/multibackend.py</b><br>


file stats: <b>365 lines, 76 executed: 20.8% covered</b>
<pre>
<font color="black">   1. # This file is dual licensed under the terms of the Apache License, Version</font>
<font color="black">   2. # 2.0, and the BSD License. See the LICENSE file in the root of this repository</font>
<font color="black">   3. # for complete details.</font>
<font color="black">   4. </font>
<font color="green">   5. from __future__ import absolute_import, division, print_function</font>
<font color="black">   6. </font>
<font color="green">   7. from cryptography import utils</font>
<font color="green">   8. from cryptography.exceptions import UnsupportedAlgorithm, _Reasons</font>
<font color="green">   9. from cryptography.hazmat.backends.interfaces import (</font>
<font color="black">  10.     CMACBackend, CipherBackend, DERSerializationBackend, DHBackend,</font>
<font color="black">  11.     DSABackend, EllipticCurveBackend, HMACBackend, HashBackend,</font>
<font color="black">  12.     PBKDF2HMACBackend, PEMSerializationBackend, RSABackend, ScryptBackend,</font>
<font color="black">  13.     X509Backend</font>
<font color="black">  14. )</font>
<font color="black">  15. </font>
<font color="black">  16. </font>
<font color="green">  17. @utils.register_interface(CMACBackend)</font>
<font color="green">  18. @utils.register_interface(CipherBackend)</font>
<font color="green">  19. @utils.register_interface(DERSerializationBackend)</font>
<font color="green">  20. @utils.register_interface(HashBackend)</font>
<font color="green">  21. @utils.register_interface(HMACBackend)</font>
<font color="green">  22. @utils.register_interface(PBKDF2HMACBackend)</font>
<font color="green">  23. @utils.register_interface(RSABackend)</font>
<font color="green">  24. @utils.register_interface(DSABackend)</font>
<font color="green">  25. @utils.register_interface(EllipticCurveBackend)</font>
<font color="green">  26. @utils.register_interface(PEMSerializationBackend)</font>
<font color="green">  27. @utils.register_interface(X509Backend)</font>
<font color="green">  28. @utils.register_interface(DHBackend)</font>
<font color="green">  29. @utils.register_interface(ScryptBackend)</font>
<font color="green">  30. class MultiBackend(object):</font>
<font color="green">  31.     name = &quot;multibackend&quot;</font>
<font color="black">  32. </font>
<font color="green">  33.     def __init__(self, backends):</font>
<font color="red">  34.         if len(backends) == 0:</font>
<font color="red">  35.             raise ValueError(</font>
<font color="red">  36.                 &quot;Multibackend cannot be initialized with no backends. If you &quot;</font>
<font color="black">  37.                 &quot;are seeing this error when trying to use default_backend() &quot;</font>
<font color="black">  38.                 &quot;please try uninstalling and reinstalling cryptography.&quot;</font>
<font color="black">  39.             )</font>
<font color="black">  40. </font>
<font color="red">  41.         self._backends = backends</font>
<font color="black">  42. </font>
<font color="green">  43.     def _filtered_backends(self, interface):</font>
<font color="red">  44.         for b in self._backends:</font>
<font color="red">  45.             if isinstance(b, interface):</font>
<font color="red">  46.                 yield b</font>
<font color="black">  47. </font>
<font color="green">  48.     def cipher_supported(self, cipher, mode):</font>
<font color="red">  49.         return any(</font>
<font color="red">  50.             b.cipher_supported(cipher, mode)</font>
<font color="red">  51.             for b in self._filtered_backends(CipherBackend)</font>
<font color="black">  52.         )</font>
<font color="black">  53. </font>
<font color="green">  54.     def create_symmetric_encryption_ctx(self, cipher, mode):</font>
<font color="red">  55.         for b in self._filtered_backends(CipherBackend):</font>
<font color="red">  56.             try:</font>
<font color="red">  57.                 return b.create_symmetric_encryption_ctx(cipher, mode)</font>
<font color="red">  58.             except UnsupportedAlgorithm:</font>
<font color="red">  59.                 pass</font>
<font color="red">  60.         raise UnsupportedAlgorithm(</font>
<font color="red">  61.             &quot;cipher {0} in {1} mode is not supported by this backend.&quot;.format(</font>
<font color="red">  62.                 cipher.name, mode.name if mode else mode),</font>
<font color="red">  63.             _Reasons.UNSUPPORTED_CIPHER</font>
<font color="black">  64.         )</font>
<font color="black">  65. </font>
<font color="green">  66.     def create_symmetric_decryption_ctx(self, cipher, mode):</font>
<font color="red">  67.         for b in self._filtered_backends(CipherBackend):</font>
<font color="red">  68.             try:</font>
<font color="red">  69.                 return b.create_symmetric_decryption_ctx(cipher, mode)</font>
<font color="red">  70.             except UnsupportedAlgorithm:</font>
<font color="red">  71.                 pass</font>
<font color="red">  72.         raise UnsupportedAlgorithm(</font>
<font color="red">  73.             &quot;cipher {0} in {1} mode is not supported by this backend.&quot;.format(</font>
<font color="red">  74.                 cipher.name, mode.name if mode else mode),</font>
<font color="red">  75.             _Reasons.UNSUPPORTED_CIPHER</font>
<font color="black">  76.         )</font>
<font color="black">  77. </font>
<font color="green">  78.     def hash_supported(self, algorithm):</font>
<font color="red">  79.         return any(</font>
<font color="red">  80.             b.hash_supported(algorithm)</font>
<font color="red">  81.             for b in self._filtered_backends(HashBackend)</font>
<font color="black">  82.         )</font>
<font color="black">  83. </font>
<font color="green">  84.     def create_hash_ctx(self, algorithm):</font>
<font color="red">  85.         for b in self._filtered_backends(HashBackend):</font>
<font color="red">  86.             try:</font>
<font color="red">  87.                 return b.create_hash_ctx(algorithm)</font>
<font color="red">  88.             except UnsupportedAlgorithm:</font>
<font color="red">  89.                 pass</font>
<font color="red">  90.         raise UnsupportedAlgorithm(</font>
<font color="red">  91.             &quot;{0} is not a supported hash on this backend.&quot;.format(</font>
<font color="red">  92.                 algorithm.name),</font>
<font color="red">  93.             _Reasons.UNSUPPORTED_HASH</font>
<font color="black">  94.         )</font>
<font color="black">  95. </font>
<font color="green">  96.     def hmac_supported(self, algorithm):</font>
<font color="red">  97.         return any(</font>
<font color="red">  98.             b.hmac_supported(algorithm)</font>
<font color="red">  99.             for b in self._filtered_backends(HMACBackend)</font>
<font color="black"> 100.         )</font>
<font color="black"> 101. </font>
<font color="green"> 102.     def create_hmac_ctx(self, key, algorithm):</font>
<font color="red"> 103.         for b in self._filtered_backends(HMACBackend):</font>
<font color="red"> 104.             try:</font>
<font color="red"> 105.                 return b.create_hmac_ctx(key, algorithm)</font>
<font color="red"> 106.             except UnsupportedAlgorithm:</font>
<font color="red"> 107.                 pass</font>
<font color="red"> 108.         raise UnsupportedAlgorithm(</font>
<font color="red"> 109.             &quot;{0} is not a supported hash on this backend.&quot;.format(</font>
<font color="red"> 110.                 algorithm.name),</font>
<font color="red"> 111.             _Reasons.UNSUPPORTED_HASH</font>
<font color="black"> 112.         )</font>
<font color="black"> 113. </font>
<font color="green"> 114.     def pbkdf2_hmac_supported(self, algorithm):</font>
<font color="red"> 115.         return any(</font>
<font color="red"> 116.             b.pbkdf2_hmac_supported(algorithm)</font>
<font color="red"> 117.             for b in self._filtered_backends(PBKDF2HMACBackend)</font>
<font color="black"> 118.         )</font>
<font color="black"> 119. </font>
<font color="green"> 120.     def derive_pbkdf2_hmac(self, algorithm, length, salt, iterations,</font>
<font color="black"> 121.                            key_material):</font>
<font color="red"> 122.         for b in self._filtered_backends(PBKDF2HMACBackend):</font>
<font color="red"> 123.             try:</font>
<font color="red"> 124.                 return b.derive_pbkdf2_hmac(</font>
<font color="red"> 125.                     algorithm, length, salt, iterations, key_material</font>
<font color="black"> 126.                 )</font>
<font color="red"> 127.             except UnsupportedAlgorithm:</font>
<font color="red"> 128.                 pass</font>
<font color="red"> 129.         raise UnsupportedAlgorithm(</font>
<font color="red"> 130.             &quot;{0} is not a supported hash on this backend.&quot;.format(</font>
<font color="red"> 131.                 algorithm.name),</font>
<font color="red"> 132.             _Reasons.UNSUPPORTED_HASH</font>
<font color="black"> 133.         )</font>
<font color="black"> 134. </font>
<font color="green"> 135.     def generate_rsa_private_key(self, public_exponent, key_size):</font>
<font color="red"> 136.         for b in self._filtered_backends(RSABackend):</font>
<font color="red"> 137.             return b.generate_rsa_private_key(public_exponent, key_size)</font>
<font color="red"> 138.         raise UnsupportedAlgorithm(&quot;RSA is not supported by the backend.&quot;,</font>
<font color="red"> 139.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 140. </font>
<font color="green"> 141.     def generate_rsa_parameters_supported(self, public_exponent, key_size):</font>
<font color="red"> 142.         for b in self._filtered_backends(RSABackend):</font>
<font color="red"> 143.             return b.generate_rsa_parameters_supported(</font>
<font color="red"> 144.                 public_exponent, key_size</font>
<font color="black"> 145.             )</font>
<font color="red"> 146.         raise UnsupportedAlgorithm(&quot;RSA is not supported by the backend.&quot;,</font>
<font color="red"> 147.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 148. </font>
<font color="green"> 149.     def rsa_padding_supported(self, padding):</font>
<font color="red"> 150.         for b in self._filtered_backends(RSABackend):</font>
<font color="red"> 151.             return b.rsa_padding_supported(padding)</font>
<font color="red"> 152.         raise UnsupportedAlgorithm(&quot;RSA is not supported by the backend.&quot;,</font>
<font color="red"> 153.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 154. </font>
<font color="green"> 155.     def load_rsa_private_numbers(self, numbers):</font>
<font color="red"> 156.         for b in self._filtered_backends(RSABackend):</font>
<font color="red"> 157.             return b.load_rsa_private_numbers(numbers)</font>
<font color="black"> 158. </font>
<font color="red"> 159.         raise UnsupportedAlgorithm(&quot;RSA is not supported by the backend&quot;,</font>
<font color="red"> 160.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 161. </font>
<font color="green"> 162.     def load_rsa_public_numbers(self, numbers):</font>
<font color="red"> 163.         for b in self._filtered_backends(RSABackend):</font>
<font color="red"> 164.             return b.load_rsa_public_numbers(numbers)</font>
<font color="black"> 165. </font>
<font color="red"> 166.         raise UnsupportedAlgorithm(&quot;RSA is not supported by the backend&quot;,</font>
<font color="red"> 167.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 168. </font>
<font color="green"> 169.     def generate_dsa_parameters(self, key_size):</font>
<font color="red"> 170.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 171.             return b.generate_dsa_parameters(key_size)</font>
<font color="red"> 172.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 173.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 174. </font>
<font color="green"> 175.     def generate_dsa_private_key(self, parameters):</font>
<font color="red"> 176.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 177.             return b.generate_dsa_private_key(parameters)</font>
<font color="red"> 178.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 179.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 180. </font>
<font color="green"> 181.     def generate_dsa_private_key_and_parameters(self, key_size):</font>
<font color="red"> 182.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 183.             return b.generate_dsa_private_key_and_parameters(key_size)</font>
<font color="red"> 184.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 185.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 186. </font>
<font color="green"> 187.     def dsa_hash_supported(self, algorithm):</font>
<font color="red"> 188.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 189.             return b.dsa_hash_supported(algorithm)</font>
<font color="red"> 190.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 191.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 192. </font>
<font color="green"> 193.     def dsa_parameters_supported(self, p, q, g):</font>
<font color="red"> 194.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 195.             return b.dsa_parameters_supported(p, q, g)</font>
<font color="red"> 196.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 197.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 198. </font>
<font color="green"> 199.     def load_dsa_public_numbers(self, numbers):</font>
<font color="red"> 200.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 201.             return b.load_dsa_public_numbers(numbers)</font>
<font color="red"> 202.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 203.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 204. </font>
<font color="green"> 205.     def load_dsa_private_numbers(self, numbers):</font>
<font color="red"> 206.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 207.             return b.load_dsa_private_numbers(numbers)</font>
<font color="red"> 208.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 209.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 210. </font>
<font color="green"> 211.     def load_dsa_parameter_numbers(self, numbers):</font>
<font color="red"> 212.         for b in self._filtered_backends(DSABackend):</font>
<font color="red"> 213.             return b.load_dsa_parameter_numbers(numbers)</font>
<font color="red"> 214.         raise UnsupportedAlgorithm(&quot;DSA is not supported by the backend.&quot;,</font>
<font color="red"> 215.                                    _Reasons.UNSUPPORTED_PUBLIC_KEY_ALGORITHM)</font>
<font color="black"> 216. </font>
<font color="green"> 217.     def cmac_algorithm_supported(self, algorithm):</font>
<font color="red"> 218.         return any(</font>
<font color="red"> 219.             b.cmac_algorithm_supported(algorithm)</font>
<font color="red"> 220.             for b in self._filtered_backends(CMACBackend)</font>
<font color="black"> 221.         )</font>
<font color="black"> 222. </font>
<font color="green"> 223.     def create_cmac_ctx(self, algorithm):</font>
<font color="red"> 224.         for b in self._filtered_backends(CMACBackend):</font>
<font color="red"> 225.             try:</font>
<font color="red"> 226.                 return b.create_cmac_ctx(algorithm)</font>
<font color="red"> 227.             except UnsupportedAlgorithm:</font>
<font color="red"> 228.                 pass</font>
<font color="red"> 229.         raise UnsupportedAlgorithm(&quot;This backend does not support CMAC.&quot;,</font>
<font color="red"> 230.                                    _Reasons.UNSUPPORTED_CIPHER)</font>
<font color="black"> 231. </font>
<font color="green"> 232.     def elliptic_curve_supported(self, curve):</font>
<font color="red"> 233.         return any(</font>
<font color="red"> 234.             b.elliptic_curve_supported(curve)</font>
<font color="red"> 235.             for b in self._filtered_backends(EllipticCurveBackend)</font>
<font color="black"> 236.         )</font>
<font color="black"> 237. </font>
<font color="green"> 238.     def elliptic_curve_signature_algorithm_supported(</font>
<font color="black"> 239.         self, signature_algorithm, curve</font>
<font color="black"> 240.     ):</font>
<font color="red"> 241.         return any(</font>
<font color="red"> 242.             b.elliptic_curve_signature_algorithm_supported(</font>
<font color="black"> 243.                 signature_algorithm, curve</font>
<font color="black"> 244.             )</font>
<font color="red"> 245.             for b in self._filtered_backends(EllipticCurveBackend)</font>
<font color="black"> 246.         )</font>
<font color="black"> 247. </font>
<font color="green"> 248.     def generate_elliptic_curve_private_key(self, curve):</font>
<font color="red"> 249.         for b in self._filtered_backends(EllipticCurveBackend):</font>
<font color="red"> 250.             try:</font>
<font color="red"> 251.                 return b.generate_elliptic_curve_private_key(curve)</font>
<font color="red"> 252.             except UnsupportedAlgorithm:</font>
<font color="red"> 253.                 continue</font>
<font color="black"> 254. </font>
<font color="red"> 255.         raise UnsupportedAlgorithm(</font>
<font color="red"> 256.             &quot;This backend does not support this elliptic curve.&quot;,</font>
<font color="red"> 257.             _Reasons.UNSUPPORTED_ELLIPTIC_CURVE</font>
<font color="black"> 258.         )</font>
<font color="black"> 259. </font>
<font color="green"> 260.     def load_elliptic_curve_private_numbers(self, numbers):</font>
<font color="red"> 261.         for b in self._filtered_backends(EllipticCurveBackend):</font>
<font color="red"> 262.             try:</font>
<font color="red"> 263.                 return b.load_elliptic_curve_private_numbers(numbers)</font>
<font color="red"> 264.             except UnsupportedAlgorithm:</font>
<font color="red"> 265.                 continue</font>
<font color="black"> 266. </font>
<font color="red"> 267.         raise UnsupportedAlgorithm(</font>
<font color="red"> 268.             &quot;This backend does not support this elliptic curve.&quot;,</font>
<font color="red"> 269.             _Reasons.UNSUPPORTED_ELLIPTIC_CURVE</font>
<font color="black"> 270.         )</font>
<font color="black"> 271. </font>
<font color="green"> 272.     def load_elliptic_curve_public_numbers(self, numbers):</font>
<font color="red"> 273.         for b in self._filtered_backends(EllipticCurveBackend):</font>
<font color="red"> 274.             try:</font>
<font color="red"> 275.                 return b.load_elliptic_curve_public_numbers(numbers)</font>
<font color="red"> 276.             except UnsupportedAlgorithm:</font>
<font color="red"> 277.                 continue</font>
<font color="black"> 278. </font>
<font color="red"> 279.         raise UnsupportedAlgorithm(</font>
<font color="red"> 280.             &quot;This backend does not support this elliptic curve.&quot;,</font>
<font color="red"> 281.             _Reasons.UNSUPPORTED_ELLIPTIC_CURVE</font>
<font color="black"> 282.         )</font>
<font color="black"> 283. </font>
<font color="green"> 284.     def derive_elliptic_curve_private_key(self, private_value, curve):</font>
<font color="red"> 285.         for b in self._filtered_backends(EllipticCurveBackend):</font>
<font color="red"> 286.             try:</font>
<font color="red"> 287.                 return b.derive_elliptic_curve_private_key(private_value,</font>
<font color="red"> 288.                                                            curve)</font>
<font color="red"> 289.             except UnsupportedAlgorithm:</font>
<font color="red"> 290.                 continue</font>
<font color="black"> 291. </font>
<font color="red"> 292.         raise UnsupportedAlgorithm(</font>
<font color="red"> 293.             &quot;This backend does not support this elliptic curve.&quot;,</font>
<font color="red"> 294.             _Reasons.UNSUPPORTED_ELLIPTIC_CURVE</font>
<font color="black"> 295.         )</font>
<font color="black"> 296. </font>
<font color="green"> 297.     def elliptic_curve_exchange_algorithm_supported(self, algorithm, curve):</font>
<font color="red"> 298.         return any(</font>
<font color="red"> 299.             b.elliptic_curve_exchange_algorithm_supported(algorithm, curve)</font>
<font color="red"> 300.             for b in self._filtered_backends(EllipticCurveBackend)</font>
<font color="black"> 301.         )</font>
<font color="black"> 302. </font>
<font color="green"> 303.     def load_pem_private_key(self, data, password):</font>
<font color="red"> 304.         for b in self._filtered_backends(PEMSerializationBackend):</font>
<font color="red"> 305.             return b.load_pem_private_key(data, password)</font>
<font color="black"> 306. </font>
<font color="red"> 307.         raise UnsupportedAlgorithm(</font>
<font color="red"> 308.             &quot;This backend does not support this key serialization.&quot;,</font>
<font color="red"> 309.             _Reasons.UNSUPPORTED_SERIALIZATION</font>
<font color="black"> 310.         )</font>
<font color="black"> 311. </font>
<font color="green"> 312.     def load_pem_public_key(self, data):</font>
<font color="red"> 313.         for b in self._filtered_backends(PEMSerializationBackend):</font>
<font color="red"> 314.             return b.load_pem_public_key(data)</font>
<font color="black"> 315. </font>
<font color="red"> 316.         raise UnsupportedAlgorithm(</font>
<font color="red"> 317.             &quot;This backend does not support this key serialization.&quot;,</font>
<font color="red"> 318.             _Reasons.UNSUPPORTED_SERIALIZATION</font>
<font color="black"> 319.         )</font>
<font color="black"> 320. </font>
<font color="green"> 321.     def load_der_private_key(self, data, password):</font>
<font color="red"> 322.         for b in self._filtered_backends(DERSerializationBackend):</font>
<font color="red"> 323.             return b.load_der_private_key(data, password)</font>
<font color="black"> 324. </font>
<font color="red"> 325.         raise UnsupportedAlgorithm(</font>
<font color="red"> 326.             &quot;This backend does not support this key serialization.&quot;,</font>
<font color="red"> 327.             _Reasons.UNSUPPORTED_SERIALIZATION</font>
<font color="black"> 328.         )</font>
<font color="black"> 329. </font>
<font color="green"> 330.     def load_der_public_key(self, data):</font>
<font color="red"> 331.         for b in self._filtered_backends(DERSerializationBackend):</font>
<font color="red"> 332.             return b.load_der_public_key(data)</font>
<font color="black"> 333. </font>
<font color="red"> 334.         raise UnsupportedAlgorithm(</font>
<font color="red"> 335.             &quot;This backend does not support this key serialization.&quot;,</font>
<font color="red"> 336.             _Reasons.UNSUPPORTED_SERIALIZATION</font>
<font color="black"> 337.         )</font>
<font color="black"> 338. </font>
<font color="green"> 339.     def load_pem_x509_certificate(self, data):</font>
<font color="red"> 340.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 341.             return b.load_pem_x509_certificate(data)</font>
<font color="black"> 342. </font>
<font color="red"> 343.         raise UnsupportedAlgorithm(</font>
<font color="red"> 344.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 345.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 346.         )</font>
<font color="black"> 347. </font>
<font color="green"> 348.     def load_der_x509_certificate(self, data):</font>
<font color="red"> 349.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 350.             return b.load_der_x509_certificate(data)</font>
<font color="black"> 351. </font>
<font color="red"> 352.         raise UnsupportedAlgorithm(</font>
<font color="red"> 353.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 354.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 355.         )</font>
<font color="black"> 356. </font>
<font color="green"> 357.     def load_pem_x509_crl(self, data):</font>
<font color="red"> 358.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 359.             return b.load_pem_x509_crl(data)</font>
<font color="black"> 360. </font>
<font color="red"> 361.         raise UnsupportedAlgorithm(</font>
<font color="red"> 362.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 363.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 364.         )</font>
<font color="black"> 365. </font>
<font color="green"> 366.     def load_der_x509_crl(self, data):</font>
<font color="red"> 367.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 368.             return b.load_der_x509_crl(data)</font>
<font color="black"> 369. </font>
<font color="red"> 370.         raise UnsupportedAlgorithm(</font>
<font color="red"> 371.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 372.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 373.         )</font>
<font color="black"> 374. </font>
<font color="green"> 375.     def load_der_x509_csr(self, data):</font>
<font color="red"> 376.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 377.             return b.load_der_x509_csr(data)</font>
<font color="black"> 378. </font>
<font color="red"> 379.         raise UnsupportedAlgorithm(</font>
<font color="red"> 380.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 381.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 382.         )</font>
<font color="black"> 383. </font>
<font color="green"> 384.     def load_pem_x509_csr(self, data):</font>
<font color="red"> 385.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 386.             return b.load_pem_x509_csr(data)</font>
<font color="black"> 387. </font>
<font color="red"> 388.         raise UnsupportedAlgorithm(</font>
<font color="red"> 389.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 390.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 391.         )</font>
<font color="black"> 392. </font>
<font color="green"> 393.     def create_x509_csr(self, builder, private_key, algorithm):</font>
<font color="red"> 394.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 395.             return b.create_x509_csr(builder, private_key, algorithm)</font>
<font color="black"> 396. </font>
<font color="red"> 397.         raise UnsupportedAlgorithm(</font>
<font color="red"> 398.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 399.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 400.         )</font>
<font color="black"> 401. </font>
<font color="green"> 402.     def create_x509_certificate(self, builder, private_key, algorithm):</font>
<font color="red"> 403.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 404.             return b.create_x509_certificate(builder, private_key, algorithm)</font>
<font color="black"> 405. </font>
<font color="red"> 406.         raise UnsupportedAlgorithm(</font>
<font color="red"> 407.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 408.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 409.         )</font>
<font color="black"> 410. </font>
<font color="green"> 411.     def create_x509_crl(self, builder, private_key, algorithm):</font>
<font color="red"> 412.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 413.             return b.create_x509_crl(builder, private_key, algorithm)</font>
<font color="black"> 414. </font>
<font color="red"> 415.         raise UnsupportedAlgorithm(</font>
<font color="red"> 416.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 417.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 418.         )</font>
<font color="black"> 419. </font>
<font color="green"> 420.     def create_x509_revoked_certificate(self, builder):</font>
<font color="red"> 421.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 422.             return b.create_x509_revoked_certificate(builder)</font>
<font color="black"> 423. </font>
<font color="red"> 424.         raise UnsupportedAlgorithm(</font>
<font color="red"> 425.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 426.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 427.         )</font>
<font color="black"> 428. </font>
<font color="green"> 429.     def generate_dh_parameters(self, generator, key_size):</font>
<font color="red"> 430.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 431.             return b.generate_dh_parameters(generator, key_size)</font>
<font color="black"> 432. </font>
<font color="red"> 433.         raise UnsupportedAlgorithm(</font>
<font color="red"> 434.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 435.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 436.         )</font>
<font color="black"> 437. </font>
<font color="green"> 438.     def load_dh_parameter_numbers(self, numbers):</font>
<font color="red"> 439.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 440.             return b.load_dh_parameter_numbers(numbers)</font>
<font color="black"> 441. </font>
<font color="red"> 442.         raise UnsupportedAlgorithm(</font>
<font color="red"> 443.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 444.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 445.         )</font>
<font color="black"> 446. </font>
<font color="green"> 447.     def generate_dh_private_key(self, parameters):</font>
<font color="red"> 448.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 449.             return b.generate_dh_private_key(parameters)</font>
<font color="black"> 450. </font>
<font color="red"> 451.         raise UnsupportedAlgorithm(</font>
<font color="red"> 452.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 453.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 454.         )</font>
<font color="black"> 455. </font>
<font color="green"> 456.     def load_dh_private_numbers(self, numbers):</font>
<font color="red"> 457.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 458.             return b.load_dh_private_numbers(numbers)</font>
<font color="black"> 459. </font>
<font color="red"> 460.         raise UnsupportedAlgorithm(</font>
<font color="red"> 461.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 462.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 463.         )</font>
<font color="black"> 464. </font>
<font color="green"> 465.     def load_dh_public_numbers(self, numbers):</font>
<font color="red"> 466.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 467.             return b.load_dh_public_numbers(numbers)</font>
<font color="black"> 468. </font>
<font color="red"> 469.         raise UnsupportedAlgorithm(</font>
<font color="red"> 470.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 471.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 472.         )</font>
<font color="black"> 473. </font>
<font color="green"> 474.     def generate_dh_private_key_and_parameters(self, generator, key_size):</font>
<font color="red"> 475.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 476.             return b.generate_dh_private_key_and_parameters(generator,</font>
<font color="red"> 477.                                                             key_size)</font>
<font color="black"> 478. </font>
<font color="red"> 479.         raise UnsupportedAlgorithm(</font>
<font color="red"> 480.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 481.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 482.         )</font>
<font color="black"> 483. </font>
<font color="green"> 484.     def dh_parameters_supported(self, p, g, q=None):</font>
<font color="red"> 485.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 486.             return b.dh_parameters_supported(p, g, q)</font>
<font color="black"> 487. </font>
<font color="red"> 488.         raise UnsupportedAlgorithm(</font>
<font color="red"> 489.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 490.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 491.         )</font>
<font color="black"> 492. </font>
<font color="green"> 493.     def dh_x942_serialization_supported(self):</font>
<font color="red"> 494.         for b in self._filtered_backends(DHBackend):</font>
<font color="red"> 495.             return b.dh_x942_serialization_supported()</font>
<font color="black"> 496. </font>
<font color="red"> 497.         raise UnsupportedAlgorithm(</font>
<font color="red"> 498.             &quot;This backend does not support Diffie-Hellman&quot;,</font>
<font color="red"> 499.             _Reasons.UNSUPPORTED_DIFFIE_HELLMAN</font>
<font color="black"> 500.         )</font>
<font color="black"> 501. </font>
<font color="green"> 502.     def x509_name_bytes(self, name):</font>
<font color="red"> 503.         for b in self._filtered_backends(X509Backend):</font>
<font color="red"> 504.             return b.x509_name_bytes(name)</font>
<font color="black"> 505. </font>
<font color="red"> 506.         raise UnsupportedAlgorithm(</font>
<font color="red"> 507.             &quot;This backend does not support X.509.&quot;,</font>
<font color="red"> 508.             _Reasons.UNSUPPORTED_X509</font>
<font color="black"> 509.         )</font>
<font color="black"> 510. </font>
<font color="green"> 511.     def derive_scrypt(self, key_material, salt, length, n, r, p):</font>
<font color="red"> 512.         for b in self._filtered_backends(ScryptBackend):</font>
<font color="red"> 513.             return b.derive_scrypt(key_material, salt, length, n, r, p)</font>
<font color="red"> 514.         raise UnsupportedAlgorithm(&quot;This backend does not support scrypt.&quot;)</font>
</pre>

