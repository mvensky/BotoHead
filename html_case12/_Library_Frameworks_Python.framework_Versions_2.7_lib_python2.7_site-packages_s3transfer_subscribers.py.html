source file: <b>/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/s3transfer/subscribers.py</b><br>


file stats: <b>28 lines, 13 executed: 46.4% covered</b>
<pre>
<font color="black">   1. # Copyright 2016 Amazon.com, Inc. or its affiliates. All Rights Reserved.</font>
<font color="black">   2. #</font>
<font color="black">   3. # Licensed under the Apache License, Version 2.0 (the &quot;License&quot;). You</font>
<font color="black">   4. # may not use this file except in compliance with the License. A copy of</font>
<font color="black">   5. # the License is located at</font>
<font color="black">   6. #</font>
<font color="black">   7. # http://aws.amazon.com/apache2.0/</font>
<font color="black">   8. #</font>
<font color="black">   9. # or in the &quot;license&quot; file accompanying this file. This file is</font>
<font color="black">  10. # distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF</font>
<font color="black">  11. # ANY KIND, either express or implied. See the License for the specific</font>
<font color="black">  12. # language governing permissions and limitations under the License.</font>
<font color="green">  13. from botocore.compat import six</font>
<font color="black">  14. </font>
<font color="green">  15. from s3transfer.compat import accepts_kwargs</font>
<font color="green">  16. from s3transfer.exceptions import InvalidSubscriberMethodError</font>
<font color="black">  17. </font>
<font color="black">  18. </font>
<font color="green">  19. class BaseSubscriber(object):</font>
<font color="black">  20.     &quot;&quot;&quot;The base subscriber class</font>
<font color="black">  21. </font>
<font color="black">  22.     It is recommended that all subscriber implementations subclass and then</font>
<font color="black">  23.     override the subscription methods (i.e. on_{subsribe_type}() methods).</font>
<font color="green">  24.     &quot;&quot;&quot;</font>
<font color="black">  25.     VALID_SUBSCRIBER_TYPES = [</font>
<font color="green">  26.         'queued',</font>
<font color="green">  27.         'progress',</font>
<font color="green">  28.         'done'</font>
<font color="black">  29.     ]</font>
<font color="black">  30. </font>
<font color="green">  31.     def __new__(cls, *args, **kwargs):</font>
<font color="red">  32.         cls._validate_subscriber_methods()</font>
<font color="red">  33.         return super(BaseSubscriber, cls).__new__(cls)</font>
<font color="black">  34. </font>
<font color="green">  35.     @classmethod</font>
<font color="black">  36.     def _validate_subscriber_methods(cls):</font>
<font color="red">  37.         for subscriber_type in cls.VALID_SUBSCRIBER_TYPES:</font>
<font color="red">  38.             subscriber_method = getattr(cls, 'on_' + subscriber_type)</font>
<font color="red">  39.             if not six.callable(subscriber_method):</font>
<font color="red">  40.                 raise InvalidSubscriberMethodError(</font>
<font color="red">  41.                     'Subscriber method %s must be callable.' %</font>
<font color="red">  42.                     subscriber_method)</font>
<font color="black">  43. </font>
<font color="red">  44.             if not accepts_kwargs(subscriber_method):</font>
<font color="red">  45.                 raise InvalidSubscriberMethodError(</font>
<font color="red">  46.                     'Subscriber method %s must accept keyword '</font>
<font color="red">  47.                     'arguments (**kwargs)' % subscriber_method)</font>
<font color="black">  48. </font>
<font color="green">  49.     def on_queued(self, future, **kwargs):</font>
<font color="black">  50.         &quot;&quot;&quot;Callback to be invoked when transfer request gets queued</font>
<font color="black">  51. </font>
<font color="black">  52.         This callback can be useful for:</font>
<font color="black">  53. </font>
<font color="black">  54.             * Keeping track of how many transfers have been requested</font>
<font color="black">  55.             * Providing the expected transfer size through</font>
<font color="black">  56.               future.meta.provide_transfer_size() so a HeadObject would not</font>
<font color="black">  57.               need to be made for copies and downloads.</font>
<font color="black">  58. </font>
<font color="black">  59.         :type future: s3transfer.futures.TransferFuture</font>
<font color="black">  60.         :param future: The TransferFuture representing the requested transfer.</font>
<font color="black">  61.         &quot;&quot;&quot;</font>
<font color="red">  62.         pass</font>
<font color="black">  63. </font>
<font color="green">  64.     def on_progress(self, future, bytes_transferred, **kwargs):</font>
<font color="black">  65.         &quot;&quot;&quot;Callback to be invoked when progress is made on transfer</font>
<font color="black">  66. </font>
<font color="black">  67.         This callback can be useful for:</font>
<font color="black">  68. </font>
<font color="black">  69.             * Recording and displaying progress</font>
<font color="black">  70. </font>
<font color="black">  71.         :type future: s3transfer.futures.TransferFuture</font>
<font color="black">  72.         :param future: The TransferFuture representing the requested transfer.</font>
<font color="black">  73. </font>
<font color="black">  74.         :type bytes_transferred: int</font>
<font color="black">  75.         :param bytes_transferred: The number of bytes transferred for that</font>
<font color="black">  76.             invocation of the callback. Note that a negative amount can be</font>
<font color="black">  77.             provided, which usually indicates that an in-progress request</font>
<font color="black">  78.             needed to be retried and thus progress was rewound.</font>
<font color="black">  79.         &quot;&quot;&quot;</font>
<font color="red">  80.         pass</font>
<font color="black">  81. </font>
<font color="green">  82.     def on_done(self, future, **kwargs):</font>
<font color="black">  83.         &quot;&quot;&quot;Callback to be invoked once a transfer is done</font>
<font color="black">  84. </font>
<font color="black">  85.         This callback can be useful for:</font>
<font color="black">  86. </font>
<font color="black">  87.             * Recording and displaying whether the transfer succeeded or</font>
<font color="black">  88.               failed using future.result()</font>
<font color="black">  89.             * Running some task after the transfer completed like changing</font>
<font color="black">  90.               the last modified time of a downloaded file.</font>
<font color="black">  91. </font>
<font color="black">  92.         :type future: s3transfer.futures.TransferFuture</font>
<font color="black">  93.         :param future: The TransferFuture representing the requested transfer.</font>
<font color="black">  94.         &quot;&quot;&quot;</font>
<font color="red">  95.         pass</font>
</pre>

